\documentclass{report}

\usepackage[left=1in, right=1in, top=1in, bottom=1in]{geometry}
\usepackage[doublespacing]{setspace}
\usepackage{amsmath,amsthm,amssymb,mathrsfs}
\usepackage[hidelinks]{hyperref}
\hypersetup{colorlinks,%
	citecolor=blue,%
	filecolor=black,%
	linkcolor=black,%
	urlcolor=blue
}
\usepackage{enumitem}
%\usepackage{enumerate}
\usepackage{stmaryrd}
\usepackage{tikz-cd}

\title{Subset Decompositions: Factorization in Power Monoids}
\author{Austin A. Antoniou}
\date{\today}

%MathBB, Mathcal, Mathfrak shortcuts
\newcommand{\A}{\mathcal{A}}
\renewcommand{\aa}{\mathfrak{a}}
\newcommand{\bb}{\mathfrak{b}}
\newcommand{\C}{\mathcal{C}}
\newcommand{\E}{\mathcal{E}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\NN}{\mathbb{N}}
\renewcommand{\P}{\mathcal{P}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\Z}{\mathcal{Z}}


\newcommand{\gen}[1]{\langle #1 \rangle}
\newcommand{\llb}{\llbracket}
\newcommand{\rrb}{\rrbracket}

\newcommand{\fin}{\textrm{fin}}
\newcommand{\funt}{{\textrm{fin}, \times}}
\newcommand{\fun}{{\textrm{fin}, 1}}
\newcommand{\fon}{{\textrm{fin}, 0}}
\newcommand{\m}{{\mathsf{m}}}
\newcommand{\ord}{{\operatorname{ord}}}

\renewcommand{\:}{\text{:}}

\newcommand{\PN}{{\P_{\fin,0}(\NN)}}




\theoremstyle{definition}
\newtheorem{defn}{Definition}[section]
\newtheorem{prop}[defn]{Proposition}
\newtheorem{lemma}[defn]{Lemma}
\newtheorem{thm}[defn]{Theorem}
\newtheorem{cor}[defn]{Corollary}
\newtheorem{rk}[defn]{Remark}
\newtheorem{eg}[defn]{Example}
\newtheorem{conj}[defn]{Conjecture}

\begin{document}
\maketitle

\tableofcontents


%%%%%%
%%%%%%
\chapter{Introduction}
%%%%%%
%%%%%%

Factorization theory pursues a full understanding of how complex objects decompose into their simplest constituent parts.  
Depending on the algebraic structure in question, the difficulty of gaining such an understanding can vary wildly. 
Some objects can be broken down in exactly one way, while others exhibit more exotic behavior and are able to be broken down into many combinations of simpler parts.
Among our tasks are to test the bounds of this behavior, and to completely classify the circumstances under which it can occur.
In the present work, we bring our attention to a fairly new class of algebraic objects -- the titular ``power monoids" --  which possess many characteristics that make their study difficult, hence interesting.

%%%%%%
%%%%%%
\section{History and Motivation}
%%%%%%
%%%%%%

The most elementary setting in which we study factorizations is the set $\ZZ$ of integers.
It is well known (as the Fundamental Theorem of Arithmetic) that every integer (other than $-1$, $0$, and $1$) factors uniquely as a product of prime integers.
For instance, $12$ can be written as $2\cdot 2\cdot 3$.
Of course, 12 can also be written as either of the products $2\cdot 3\cdot 2$ or $(-3)\cdot 2\cdot (-2)$, but we consider these factorizations to be fundamentally the same.  
This tells us that, in addition to identifying the prime factors involved, there should also be an equivalence of factorizations in play.
Making these ideas rigorous is one of the challenges of extending this familiar example to a more general theory.


There are many settings other than the integers in which it is reasonable to decompose elements into atoms. 
However, most will not share the familiar unique factorization of the integers.  
Historically, one of the greatest examples comes from the ring of integers of an algebraic number field; namely, $\ZZ[\sqrt{-5}]$.
Consider $6$ as an element of this ring: $6=2\cdot3$, but we also have $6 = (1+\sqrt{-5})(1-\sqrt{-5})$.
It is not a hard exercise to show that these two factorizations are not equivalent (meaning that $2$ and $3$ are not associate to $1\pm\sqrt{-5}$), so $6$ has more than one type of factorization into irreducibles.

%For an example, one doesn't need to migrate too far from the integers: consider the subset of integers which can be obtained as a sum of any number of copies of $4$, $9$, or $11$.
%The list of such integers begins: $\{0, 4, 8, 9, 11, 12, 13, 15, 16, 17, ... \}$.
%Here, it is necessary to determine which integers will appear in the list (one can show that every integer after $15$ will appear), but we will be more interested in the questions of how many ways integers can be written just using $4$, $9$, and $11$.
%As an example, $22$ can be written as $11+11$ or as $9+9+4$; so $22$ can be decomposed into two atoms or into three.
%This is an instance of an element whose factorizations aren't unique, but a fairly tame one relative to the sort of phenomena that can arise within the study of non-unique factorizations.

Much of the field has taken place in the setting of monoids which are not only commutative (satisfying $ab = ba$) but also cancellative, meaning that $ab = ac$ implies $b = c$.
It is true that monoids of ideals in commutative rings and monoids of modules naturally give rise to examples of non-cancellative settings in which it is reasonable to study factorization properties. 
Our goal here is to explore a relatively new class of monoids which are non-cancellative, exhibit many rich properties, and yet are rooted in a simple and natural combinatorial construction.


%%%%%%
%%%%%%
\section{Plan and Main Results}
%%%%%%
%%%%%%
We will conclude this chapter by defining and recalling some preliminary notions which are necessary to move forward with our discussion, including the formal language we will use to encode the data of factorizations and some notions which capture the varying degrees of non-unique factorization.

Chapter \ref{ch:power monoids} will introduce the main object of this paper: the power monoid.  
In brief, for any monoid $H$, let $\P_\fin(H)$ be the collection of finite, nonempty subsets of $H$ with the operation of setwise multiplication given by $X\cdot Y = \{xy: x\in X, y\in Y\}$.  
This forms a monoid which can behave wildly.
However, the submonoid $\P_\fun(H)$ of subsets containing $1$ is more feasible for study, and yields some meaningful results which can be lifted back to the full monoid $\P_\fin(H)$.
We will see in Section \ref{sec:atomicity} when it is reasonable to study factorizations in $\P_\fun(H)$.
As it turns out, this monoid is atomic exactly when $H$ has no nontrivial idempotents or elements of order $2$ (Theorem \ref{th:atomicity}).
Moreover, $\P_\fun(H)$ has bounded factorization lengths if and only if $H$ is torsion-free (Theorem \ref{thm:BF-torsion}).

When $H$ is not torsion-free, the usual tools for measuring non-uniqueness of factorization in $\P_\fun(H)$ become degenerate.
To compensate for this, we introduce the notion of \textit{minimal factorizations} in a general monoid.
We then classify the circumstances under which $\P_\fun(H)$ satisfies minimal versions of the usual factorization properties (Factoriality, Half-Factoriality, FF-ness, BF-ness).  
Finally, we move to the specific case when $H = \ZZ/n\ZZ$ is a finite cyclic group to exercise this new notion of minimal factorization and recover analogues of some results which are known for $\PN$.
Namely, each interval $\llb 2,k \rrb$ for $k\le n-1$ occurs as a set of lengths in $\P_\fon(\ZZ/n\ZZ)$.

Chapter \ref{ch:partitions} focuses on the specific case of $\PN$.
In this setting we can leverage the linear ordering of $\NN$ to introduce the partition type of a given factorization.  
We consider the set of partition types of factorizations of a given element (by analogy with the more familiar set of lengths).
This is a new measure by which we can assess the degree to which an element fails to factor uniquely.  
In keeping with our previous findings, the intervals $\llb 0,n \rrb$ realizes all but $4$ possible partition types (Theorem \ref{thm:good types}), making them quantifiably the elements farthest from factoring uniquely.
Continuing to view $\PN$ through the lens of integer partitions, we also find another sharp bifurcation in factorization behavior between intervals and non-intervals: any non-interval $X$ satisfies $\max(\mathsf{L}_{\PN}(X) )\le \max(X)/2$.

Chapter \ref{ch:applications} first establishes an intimate connection between the arithmetic of $\PN$ and $\P_\fon(\NN^d)$, for $d>1$; namely, these monoids share essentially the same factorization behavior.  
While it is clear that all phenomena encountered in $\PN$ can be found in $\P_\fon(\NN^d)$, the reverse is true as well.  
This affords us the opportunity to use higher-dimensional geometric intuition to attack problems in $\PN$.
Ruminations in this vein bear the fruit of some new methods for understanding factorizations in $\P_\fon(\NN^d)$.
This line of thought also allows us to recover known results in $\PN$; namely, that, for any $n\ge 2$, $\{n\}$ and $\{2,n+1\}$ occur as sets of factorization lengths.
Furthermore, we can push these methods to obtain Theorem \ref{thm:int-point-construction}, which states that, for any $n\ge 2$ and $m\ge 1$, $\llb 2,m+2 \rrb \cup \{m+n+1\}$ occurs as a set of lengths.





%%%%%%
%%%%%%
\section{Preliminaries}
%%%%%%
%%%%%%
\subsection*{Notation and Conventions}

$\NN = \{0,1,2,3,\dots\}$, $\ZZ = \{0,\pm 1, \pm 2,\dots\}$, and $\RR$ denote the sets of natural numbers, integers, and real numbers, respectively.
In general, unless otherwise specified, lowercase letter will usually refer to elements of a monoid; ordinary uppercase letters to sets and subsets; script or calligraphic uppercase letters to collections of subsets.
Specifically, $i$, $j$, $k$, $\ell$, $m$, and $n$ will usually stand for non-negative integers.
For $a, b\in \RR\cup\{\infty\}$, $\llb a,b \rrb = \{ n\in \ZZ : a \le n \le b \}$ shall denote the (integer) interval from $a$ to $b$.

The \textit{free monoid} on some generating set $S$ will be denoted by $\F^*(S)$.  
This monoid should be thought of as the set of formal words whose letters belong to $S$.
Its operation, denoted by $*$ to avoid confusion where another multiplicationmis present, is meant to be interpreted as the concatenation of words.
The elements of $\F^*(S)$ will usually be represented by the fraktur letters $\aa$, $\bb$, and so on.  
The \textit{length} of a word $\mathfrak{s}= s_1 * \cdots * s_\ell  \in \F^*(S)$, where each $s_i\in S$ and $| \mathfrak{s} | := \ell$.
The empty word $\emptyset$ is said to have length zero.

If $S$ is a set and $\E$ is an equivalence relation on $S$, the equivalence class of some $x\in S$ shall be denoted by $[x]_\E$.
The subscript may be removed in situations where the implied equivalence is clear.

\subsection*{Fundamental Notions of Factorization Theory}
\begin{defn}
A monoid is a pair $(H,\cdot)$, where $H$ is a set and $\cdot $ is a binary operation (called multiplication in the absence of any other name) on $H$, satisfying
\begin{enumerate}
\item Associativity: for every $x,y,z \in H$, $(x\cdot y)\cdot z = x\cdot (y\cdot z)$
\item Identity: there is an element $1_H\in H$ such that $1\cdot x = x\cdot 1 = x$ for all $x\in H$
\end{enumerate}
Often, the operation will be omitted when no confusion can arise; it is standard practice to write $xy$ instead of $x \cdot y$.
Similarly, the identity $1_H$ will usually be written as $1$.

A map $\varphi: H \to K$ between monoids is a \textbf{homomorphism} if $\varphi(1_H) = 1_K$ and $\varphi(xy) = \varphi(x)\varphi(y)$.
\end{defn}



\begin{defn}
Let $H$ be a monoid.
\begin{enumerate}
\item $u\in H$ is a \textbf{unit} if there is $v\in H$ with $uv = vu = 1$.  
The set of units of $H$ is denoted by $H^\times$.  
$H$ is called \textit{reduced} if $H^\times = \{1\}$.
\item $a\in H\setminus H^\times$ is an \textbf{atom} if, whenever $a = xy$, either $x\in H^\times$ or $y\in H^\times$. The set of atoms of $H$ is denoted by $\A(H)$.
\item $x,y\in H$ are \textbf{associates} if there are units $u,v\in H^\times$ so that $x = uyv$. In this case, we write $x \sim y$.
\item $x\in H$ is \textbf{idompotent} (or \textbf{an idempotent}) if $x^2 = x$.
\end{enumerate}
\end{defn}

Note that $a$ is an atom if and only if every divisor of $a$ is either an associate of $a$ or a unit in $H$.
This may be taken as a definition of an atom, or used as a starting point for generalized notions of an atom, as in [RANTHONY REFERENCE FOR DIFFERENT NOTIONS OF ASSOCIATE/ATOMS].

\begin{prop}
Let $H$ be a monoid, let $a\in \A(H)$, and let $u,v\in H^\times$.
Then $uav \in \A(H)$.
\end{prop}

\begin{defn}
Let $H$ be a monoid.
The \textbf{factorization homomorphism} of $H$ is the unique homomorphism $\pi_H: \F^*(H) \to H$ satisfying $\pi_H(x) = x$ for all $x\in H$.

The \textbf{factorization monoid} of $H$ is the free monoid $\F^*(\A(H))$ generated by the atoms of $H$.
Its elements are referred to as \textit{factorizations}.

If $x\in H$ is a non-unit, then the \textbf{set of factorizations} of $x$ is
\[ \Z_H(x) := \{ \aa\in \F^*(\A(H)) : \pi_H(\aa) = x \} = \F^*(\A(H)) \cap \pi_H^{-1}(x) \]
The subscript ``$H$" may be omitted for brevity if the ambient monoid in which the factorization is being considered is clear from context.

For a non-empty word $\aa\in \Z_H(x)$, if we write $\aa = a_1*\cdots*a_k$, the atoms $a_i$ are said to be \textit{factors} of $x$.
\end{defn}

\begin{defn}
Let $H$ be a monoid, $x\in H$ be a non-unit, and $\aa,\bb \in \F^*(\A(H))$.
We will say that $\aa$ is \textbf{equivalent} to $\bb$ if, writing $\aa = a_1*\cdots * a_k$ and $\bb = b_1*\cdots * b_\ell$,
\begin{enumerate}
\item $k = \ell$.
\item The factors in $\bb$ are permuted associates of the factors of $\aa$; that is, there is a permutation $\sigma\in S_n$ (where $S_n$ is the symmetric group on $\llb 1,n \rrb$) such that $b_i \sim a_{\sigma(i)}$ for all $i\in \llb 1,k \rrb$.
\item $\aa$ and $\bb$ have the same product; i.e., $\pi_H(\aa) = \pi_H(\bb)$.
\end{enumerate}
\end{defn}

It is not difficult to check that the relation defined here is indeed an equivalence relation on $\F^*(\A(H))$.

\begin{defn}
Let $H$ be a monoid and $x\in H\setminus H^\times$.
The \textbf{set of factorization classes} of $x$ is
\[ \mathsf{Z}_H(x) := \{ [\aa]: \aa\in \Z_H(x) \} = \Z_H(x)/\sim \]
and the \textbf{set of (factorization) lengths} of $x$ is
\[ \mathsf{L}_H(x) := \{ |\aa| : [\aa] \in \mathsf{Z}_H(x) \}. \]
\end{defn}

\begin{defn}
Let $H$ be a monoid.
Here we define some properties to measure the degree of uniqueness of factorization in $H$.
\begin{itemize}
\item $H$ has \textbf{unique factorization (UF)} if, for all $x\in H\setminus H^\times$, $|\mathsf{Z}_H(x)| = 1$.
\item $H$ is \textbf{half factorial (HF)} if, for all $x\in H\setminus H^\times$, $|\mathsf{L}_H(x)| = 1$.
\item $H$ has \textbf{finite factorization (FF)} if, for all $x\in H\setminus H^\times$, $|\mathsf{Z}_H(x)| <\infty$.
\item $H$ has \textbf{bounded factorization (BF)} if, for all $x\in H\setminus H^\times$, $|\mathsf{L}_H(x)| < \infty$.
\item $H$ is \textbf{atomic} if, for all $x\in H\setminus H^\times$, $\mathsf{Z}_H(x) \neq \emptyset$.
\end{itemize}
\end{defn}

\begin{prop}
We have the following logical implications among the properties defined just above:
\[\begin{tikzcd}[arrows = Rightarrow]
 & \text{HF} \arrow{dr}&  &  \\
\text{UF} \arrow{ur}\arrow{dr}  &  & \text{BF} \arrow{r}& \text{Atomic} \\
 & \text{FF} \arrow{ur} &  & 
\end{tikzcd}\]
\end{prop}



\begin{eg}
It is helpful to see some examples or non-examples of each of these properties.
\begin{enumerate}[label={\rm (\roman{*})}]
\item $\ZZ\setminus \{0\}$ is a unique factorization monoid (this is the Fundamental Theorem of Arithmetic).
\item Let $\mathbb{P} \subseteq \NN$ be the set of primes, and let $M = \gen{\mathbb{P}\times \mathbb{P}}$ be the monoid generated by pairs of primes under multiplication.  
Then, for any pair $(m,n)\in M$, it is clear that any factorization of $(m,n)$ has length equal to the number of primes (counted with multiplicity) dividing $m$ or $n$.
However, this is not a UF monoid; we have, for instance, that $(2,2)(3,3)(2,3) = (12,18) = (2,3)(2,3)(3,2)$.
\item Most examples we will encounter from here onward will be FF, so it is perhaps more useful to see a non-example of an FF monoid.
Let $R = \mathbb{R} + x \mathbb{C}[x]$ be the ring of polynomials with complex coefficients and real constant term.
Then, for all nonzero $r\in \mathbb{R}$, we have
\[ x^2 = ((r+i)x)\left(\frac{1}{r+i}\,x\right). \]
Since $r+i\notin R$ for $r\neq0$, each $r+i$ is a non-unit of $R$, so we have found infinitely many factorizations of $x^2$.
However, any element of $R\setminus \{0\}$ has only finitely many factorization \textit{lengths} by a degree argument.
Thus the monoid $R\setminus \mathbb{Z}$ is BF but not FF.
\item Some of the richest factorization behavior is encountered in BF monoids.  
Here we mention some highly studied classes of BF monoids without going into too much detail, on the promise that we will discuss a new class of examples in heavy detail later.
\begin{itemize}
\item \textit{Numerical monoids}: proper subsets $H \subsetneqq \NN$ with finite complement which are closed under addition. \textcolor{red}{[CITE SOME PAPERS]}
\item \textit{Monoids of zero-sum sequences}: for a finite abelian group $G$, this monoid consists of formal words or ``sequences" in the elements of $G$ whose sums are equal to $0$.  
%This monoid can be written as $\F(G) \cap \sigma^{-1}(0)$, where $\F(G)$ is the free \textit{abelian} monoid in which words are unordered and $\sigma: \F(G) \to G$ is the unique homomorphism sending $g \mapsto g$ (compare with our product map $\pi_H: \F^*(H) \to H$).
The interest in these monoids can be traced back to the study of the class group of a Dedekind domain (usually a ring of integers of a number field).  \textcolor{red}{[CITE SOME PAPERS]}

\item \textit{Integer-valued polynomials}: let $D$ be a domain with field of fractions $K$; then $\operatorname{Int}(D) := \{f(x) \in K[x]: f(D) \subseteq D \}$ is the ring of integer-valued polynomials of $D$.
In addition to the rich theory developed around understanding the prime ideal structure of this ring, it is amenable to the study of factorization behavior, and exhibits some surprising behaviors.  
For example, any finite subset of $\NN_{\ge2}$ can be realized as the set of factorization lengths of some polynomial $f(x)\in \operatorname{Int}(D)$.
Additionally, one can pose similar questions regarding the ring $\operatorname{Int}^\text{R}(D)$ of integer-valued rational functions. \textcolor{red}{[CITE SOME PAPERS]}
\end{itemize}
\item Since we will usually be looking at atomic monoids, we offer a non-example here; consider the set $Q = \mathbb{Q}_{\ge 0}$ of non-negative rational numbers under addition.
$Q$ is reduced (its only unit is the identity, $0$) and we have, for any non-zero element $x\in Q$, that $x = \frac{x}{2} + \frac{x}{2}$.
This is a decomposition of $x$ into two non-zero (hence non-unit) elements, so $x$ is not an atom.
Thus we learn that $Q$ not only fails to have factorizations into atoms, but also to have atoms at all.
\end{enumerate}
\end{eg}

%%%%%%
%%%%%%
\chapter{Power Monoids and (Minimal) Factorization Properties} \label{ch:power monoids}
%%%%%%
%%%%%%



We begin by defining our central object of study: the power monoid.
These objects were first introduced and studied by Y. Fan and S. Tringali in \cite{fan-tringali18}.

\begin{defn}
Let $H$ be a monoid; for nonempty $X,Y\subset H$, we will define the operation of setwise multiplication by
\[X \cdot Y = \{xy : x\in X,\, y\in Y \}. \]
This operation endows several collections of subsets of $H$ with a monoid structure.  
Namely, we have the \textit{Power Monoid} of $H$:
\[ \P_\fin(H) = \{ X \subseteq H: X\neq \emptyset,\, |X| < \infty \}\]
the \textit{Restricted Power Monoid} of $H$:
\[ \P_\funt(H) = \{ X \subseteq H: X \cap H^\times \neq \emptyset,\,|X| < \infty \} \]
and the \textit{Reduced Power Monoid} of $H$:
\[ \P_\fun(H) = \{ X \subseteq H: 1\in X, \,  |X| < \infty \}. \]
\end{defn}

\begin{rk} Let $H$ be a monoid.
\begin{enumerate}[label={\rm (\roman{*})}]
\item $\P_\fin(H) \supseteq \P_\funt(H) \supseteq \P_\fun(H)$.
\item The identity of each of these monoids is $\{1_H\}$.
Moreover, $\P_\fun(H)$ is indeed a reduced monoid; i.e., its only unit is $\{1_H\}$.
\item Unless $H$ is trivial, $\P_\fin(H)$ is non-cancellative.
\end{enumerate}
\end{rk}

%%%%%%
%%%%%%
\section{Conditions for Atomicity and Bounded Factorization Lengths} \label{sec:atomicity}
%%%%%%
%%%%%%

Here we embark on the study of the (arithmetic and algebraic) structure of power monoids.
We begin with some elementary but helpful observations we will often use without comment.
%
\begin{prop}\label{prop:unit-adjust}
	Let $H$ be a monoid.
	The following hold:
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:prop:unit-adjust(0)} If $u, v \in H^\times$ then $uv \in H^\times$, and the converse is also true if $H=H^\times$ or $\mathscr A(H)=\emptyset$.
		\item\label{it:prop:unit-adjust(i)} If $a\in \mathscr{A}(H)$ and $u, v \in H^\times$, then $uav\in \mathscr{A}(H)$.
		\item\label{it:prop:unit-adjust(ii)} If $x\in H\setminus H^\times$ and $u, v \in H^\times$, then $\mathsf{L}_H(uxv) = \mathsf{L}_H(x)$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	See parts (i), (ii), and (iv) of \cite[Lemma 2.2]{fan-tringali18}.
\end{proof}

\begin{prop}\label{prop:pm-arith}
	Let $H$ be a monoid. The following hold:
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:prop:pm-arith(i)} If $X_1,\ldots,X_n\in \P_{\fin,1}(H)$, then $X_1 \cup \cdots \cup X_n \subseteq X_1 \cdots X_n$.
		%
		\item\label{it:prop:pm-arith(ii)} If $u,v \in H^\times$ and $X_1,\ldots,X_n\in \P_{\fin,\times}(H)$, then $|uX_1 \cdots X_nv| = |X_1 \cdots X_n| \ge \max_{1 \le i \le n} |X_i|$.
		%
		\item\label{it:prop:pm-arith(iii)} If $K$ is a submonoid of $H$, then $\P_\fun(K)$ is a divisor-closed submonoid of $\P_\fun(H)$.
		%
		\item \label{it:prop:pm-arith(iv)} $\P_\fun(H)$ is a reduced monoid and $\P_\fin(H)^\times=\P_\funt(H)^\times = \bigl\{ \{u\}: u\in H^\times\bigr\}$.
		\item \label{it:prop:pm-arith(v)} $\mathscr{A}(\mathcal P_{\funt}(H)) \subseteq H^\times \mathscr{A}(\mathcal P_{\fun}(H)) H^\times$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	\ref{it:prop:pm-arith(i)} is trivial, upon considering that $(X \cdot 1_H) \cup (1_H \cdot Y) \subseteq XY$ for all $X, Y \in \mathcal P_\fun(H)$; \ref{it:prop:pm-arith(ii)} is a direct consequence of \ref{it:prop:pm-arith(i)} and the fact that the function $X \to H: x \mapsto uxv$ is injective for all $u, v \in H^\times$ and $X \subseteq H$; and \ref{it:prop:pm-arith(iii)} and \ref{it:prop:pm-arith(iv)} are immediate from \ref{it:prop:pm-arith(i)} and \ref{it:prop:pm-arith(ii)}.
	
	As for \ref{it:prop:pm-arith(v)}, let $A\in \mathscr{A}(\P_\funt(H))$.
	Because $A$ contains a unit of $H$, there is $u\in H^\times$ such that $1_H \in uA$.
	Then $uA$ is an element of $\P_\fun(H)$, and by Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(i)} it is also an atom of $\P_\funt(H)$.
	Thus, if $X,Y\in \P_\fun(H) \subseteq \P_\funt(H)$ and $uA = XY$, then $X$ or $Y$ is the identity of $\P_\fun(H)$.
	This means that $uA$ is an atom of $\P_\fun(H)$, and hence $A=u^{-1}(uA)\in H^\times \mathscr{A}(\P_\fun(H))$, as wished.
\end{proof}
%
%
Our ultimate goal is, for an arbitrary monoid $H$, to investigate factorizations in $\P_\fin(H)$. However, this is a difficult task in general, due to a variety of ``pathological situations'' that might be hard to classify in a satisfactory way, see, for instance, \cite[Remark 3.3(ii)]{fan-tringali18}.

In practice, it is more convenient to start with $\P_\fun(H)$ and then lift arithmetic results from $\P_\fun(H)$ to $\P_\funt(H)$, a point of view which is corroborated by the simple consideration that $\P_\fin(H) = \P_\funt(H)$ whenever $H$ is a group (i.e., in the case of greatest interest in Arithmetic Combinatorics).

In turn, we will see that studying the arithmetic of $\P_\funt(H)$ is tantamount to studying that of $\P_\fun(H)$, in a sense to be made precise presently.
To do so in as all-encompassing a way as possible, we recall from \cite[Definition 3.2]{tringali18} a notion which formally packages the idea that, under suitable conditions, arithmetic may be transferred from one monoid to another.
%
\begin{defn}\label{def:equimorphism}
	Let $H$ and $K$ be monoids, and $\varphi: H\to K$ a monoid homomorphism. We denote by $\varphi^*: \mathscr{F}^*(H)\to\mathscr{F}^*(K)$ the (unique) monoid homomorphism such that $\varphi^\ast(x) = \varphi(x)$ for every $x \in H$, and we call $\varphi$ an \textit{equimorphism} if the following hold:
	\begin{enumerate}[label={({\small{E}}\arabic{*})}]
		\item\label{def:equimorphism(E1)} $\varphi^{-1}(K^\times)\subseteq H^\times$;
		\item\label{def:equimorphism(E2)} $\varphi$ is \textit{atom-preserving}, meaning that $\varphi(\mathscr{A}(H)) \subseteq \mathscr{A}(K)$;
		\item\label{def:equimorphism(E3)} If $x\in H$ and $\mathfrak{b}\in \mathcal{Z}_K(\varphi(x))$ is a non-empty $\mathscr A(K)$-word, then $\varphi^*(\mathfrak{a}) \in \llb \mathfrak{b} \rrb_{\mathscr{C}_K}$ for some $\mathfrak{a}\in \mathcal{Z}_H(x)$.
	\end{enumerate}
	Moreover, we say that $\varphi$ is \textit{essentially surjective} if $K = K^\times \varphi(H)K^\times$.
	% (here as usual, we identify $H$ with a subset of $\mathscr F^\ast(H)$).
\end{defn}
%
\begin{prop}\label{prop:equimorphism}
	Let $H$ and $K$ be monoids and $\varphi:H\to K$ an equimorphism. The following hold:
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:prop:equimorphism(i)} $\mathsf{L}_H(x) = \mathsf{L}_K(\varphi(x))$ for all $x\in H\setminus H^\times$.
		\item\label{it:prop:equimorphism(ii)} If $\varphi$ is essentially surjective, then for all $y\in K\setminus K^\times$ there is $x\in H\setminus H^\times$ with $\mathsf{L}_K(y) = \mathsf{L}_H(x)$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	See \cite[Theorem 2.22(i)]{fan-tringali18} and \cite[Theorem 3.3(i)]{tringali18}.
\end{proof}
%
\begin{prop}\label{prop:funt&fun-have-the-same-system-of-lengths}
	Let $H$ be a Dedekind-finite monoid. The following hold:
	%
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:prop:funt&fun-have-the-same-system-of-lengths(i)} The natural embedding $\jmath: \P_\fun(H)\hookrightarrow \P_\funt(H)$ is an essentially surjective equimorphism.
		%
		\item\label{it:prop:funt&fun-have-the-same-system-of-lengths(ii)} $\mathscr{A}(\mathcal P_{\funt}(H)) = H^\times \mathscr{A}(\mathcal P_{\fun}(H)) H^\times$.
		%
		\item\label{it:prop:funt&fun-have-the-same-system-of-lengths(iii)} $\mathsf{L}_{\mathcal P_{\fun}(H)}(X) = \mathsf{L}_{\mathcal P_{\funt}(H)}(X)$ for every $X \in \mathcal P_{\fun}(H)$.
		%
		\item\label{it:prop:funt&fun-have-the-same-system-of-lengths(iv)} $\mathscr L(\mathcal P_{\funt}(H)) = \mathscr L(\mathcal P_{\fun}(H))$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	%	
	In view of Proposition \ref{prop:equimorphism}, parts \ref{it:prop:funt&fun-have-the-same-system-of-lengths(iii)} and \ref{it:prop:funt&fun-have-the-same-system-of-lengths(iv)} are immediate from \ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)}.
	Moreover, the inclusion from left to right in \ref{it:prop:funt&fun-have-the-same-system-of-lengths(ii)} is precisely the content of Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(v)}, and the other inclusion will follow from \ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} and Propositions \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(i)} and \ref{prop:pm-arith}\ref{it:prop:pm-arith(iv)}.
	Therefore, we focus on \ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} for the remainder of the proof.
	
	\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} By Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(iv)}, $\jmath$ satisfies \ref{def:equimorphism(E1)}.
	Moreover, $\jmath$ is essentially surjective, as any $X\in \mathcal P_\funt(H)$ contains a unit $u \in H^\times$, so $u^{-1}X\in \mathcal P_\fun(H)$ and $X = u(u^{-1}X)$ is associate to an element of $\mathcal P_\fun(H)$. 
	
	To prove \ref{def:equimorphism(E2)}, let $A\in\mathscr{A}(\mathcal P_\fun(H))$.
	We aim to show that $A$ is an atom of $\mathcal P_\funt(H)$. For, suppose that $A = XY$ for some $X,Y\in \mathcal P_\funt(H)$. Then there are $x \in X$ and $y \in Y$ with
	$xy=1_H$; and using that $H$ is Dedekind-finite, we get from \cite[Lemma 2.30]{fan-tringali18} that $x,y\in H^\times$.
	It follows that 
	\[
	A = XY = (Xx^{-1})(xY)
	\quad\text{and}\quad
	Xx^{-1}, xY\in \mathcal P_\fun(H). 
	\]
	But then
	$Xx^{-1} = \{1_H\}$ or $xY = \{1_H\}$, since $\mathcal P_\fun(H)$ is a reduced monoid and $A$ is an atom of $\mathcal P_\fun(H)$.
	So, $X$ or $Y$ is a $1$-element subset of $H^\times$, and hence $A \in \mathscr A(\mathcal P_\funt(H))$. 
	
	
	It remains to show that $\jmath$ satisfies \ref{def:equimorphism(E3)}. For, pick $X \in \mathcal P_\fun(H)$. If $X = \{1_H\}$, the conclusion holds vacuously. Otherwise, let $\mathfrak{b} := B_1*\cdots*B_n \in \mathcal Z_{\mathcal P_\fun(H)}(X)$. Then there are $u_1\in B_1,\ldots, u_n\in B_n$ such that $1_H = u_1\cdots u_n$; and as in the proof of \ref{def:equimorphism(E2)}, it must be that $u_1,\ldots, u_n\in H^\times$.
	Accordingly, we take, for every $i \in \llb 1, n \rrb$, $A_i := u_0 \cdots u_{i-1} B_i u_i^{-1} \cdots u_1^{-1}$, where $u_0 := 1_H$.
	Then 
	\[
	A_1 \cdots A_n = X
	\quad\text{and}\quad
	1_H \in A_1, \ldots, 1_H \in A_n;
	\]
	and by Propositions \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(i)} and \ref{prop:pm-arith}\ref{it:prop:pm-arith(v)}, $A_1, \ldots, A_n$ are atoms of $\mathcal P_{\fun}(H)$. This shows that $\mathfrak{a}:= A_1*\cdots * A_n \in \mathcal{Z}_{\mathcal P_\fun(H)}(X)$; and since $A_i \simeq_{\mathcal P_\funt(H)} B_i$ for each $i \in \llb 1, n \rrb$ (by construction), we conclude that $\mathfrak{a}$ is $\mathscr{C}_{\mathcal P_{\funt}(H)}$-congruent to $\mathfrak{b}$, as wished.
	%	
\end{proof} 
%
The next example shows that Dedekind-finiteness is, to some extent, necessary for Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(ii)}, and hence for the subsequent conclusions. 
%
\begin{eg}\label{exa:no-dedekind-finiteness}
	Let $\mathcal{B}$ be the set of all binary sequences $\mathfrak{s}: \mathbf N^+ \to \{0,1\}$, and let $H$ denote the monoid of all functions $\mathcal{B} \to \mathcal{B}$ under composition: We will write $\mathcal{B}$ multiplicatively; so, if $f, g \in \mathcal{B}$ then $fg$ is the map $\mathcal{B} \to \mathcal{B}: \mathfrak{s} \mapsto f(g(\mathfrak s))$.
	Further, let $n\ge 5$ and consider the functions 
	\begin{align*}
	L: \mathcal{B} \to\mathcal{B}: (a_1,a_2,\dots) &\mapsto (a_2,a_3,\dots)  &\,\textrm{(left shift);}\\
	R: \mathcal{B} \to\mathcal{B}: (a_1,a_2,\dots) &\mapsto (0,a_1,a_2,\dots) &\,\textrm{(right shift);}\\
	P: \mathcal{B} \to\mathcal{B}: (a_1,a_2,\dots) &\mapsto (a_{n},a_1,\dots, a_{n-1}, a_{n+2}, a_{n+3},\dots,) &\,\textrm{(cycle the first $n$ terms).}
	\end{align*}
	%
	In particular, $P \in H^\times$. Also, $LR = \operatorname{id}_\mathcal{B}$ but $RL \neq \operatorname{id}_\mathcal{B}$; whence $H$ is not Dedekind-finite, and neither $R$ nor $L$ is invertible. With this in mind, we will prove that $A:= \{L,P\} \cdot \{R,P\} = \{\operatorname{id}_\mathcal{B}, LP, PR, P^2 \}$ is an atom of $\P_\fun(H)$, although it is not, by construction, an atom of $\P_\funt(H)$.
	
	Indeed,
	assume $A = XY$ for some $X,Y\in \P_\fun(H)$.
	Then $X,Y\subseteq A$, and it is clear that $P^2 \ne PRLP$, or else $RL = {\rm id}_\mathcal{B}$ (a contradiction). Similarly, $PRPR \ne P^2 \ne LPLP$; otherwise, $P = RPR$ and hence $R$ is invertible, or $P = LPL$ and $L$ is invertible (again a contradiction). Lastly, we see that $P^2 \ne LP^2 R$ (by applying both functions to the constant sequence $1, 1, \ldots$).
	
	It follows that $P^2$ must belong to $X$ or $Y$, but not to both (which is the reason for choosing $n\ge 5$).
	%or $Y$ (since $P^2$ must be a product of units), but not to both .
	Accordingly, let $P^2 \in X \setminus Y$ (the other case is analogous).
	Then $Y = \{\operatorname{id}_\mathcal{B}\}$, since one can easily check that that $P^2LP, P^3R \notin A$, by noting that the action of $P^2LP$ and $P^3R$ differ from that of $A$ on the sequences $(1,1,\ldots)$ and $(1,0,1,1,\ldots)$. This makes $A$ an atom of $\P_\fun(H)$.
\end{eg}
%
We get from Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths} that studying factorization properties of $\P_\fun(H)$ is sufficient for studying corresponding properties of $\P_\funt(H)$, at least in the case when $H$ is Dedekind-finite.
Thus, as a starting point in the investigation of the arithmetic of $\P_\fun(H)$, one might wish to give a comprehensive description of
the atoms of $\P_\fun(H)$.
This is however an overwhelming task even in specific cases (e.g., when $H$ is the additive group of the integers), let alone the general case. Nevertheless, we can obtain basic information about $\mathscr A(\P_\fun(H))$ in full generality.
%
%
\begin{lemma}\label{lem:2-elt-atoms}
	Let $H$ be a monoid and $x \in H \setminus \{1_H\}$.
	The following hold:
	\begin{enumerate}[label={\rm (\roman{*})}]
		%
		\item\label{it:lem:2-elt-atoms(i)} The set $\{1_H, x\}$ is an atom of $\P_\fun(H)$ if and only if $1_H \ne x^2 \ne x$.
		\item\label{it:lem:2-elt-atoms(ii)} If $x^2=1_H$ or $x^2=x$, then $\{1_H,x\}$ does not factor into a product of atoms neither in $\P_{\fin,1}(H)$ nor in $\P_\funt(H)$.
	\end{enumerate}
\end{lemma}
%
\begin{proof}
	\ref{it:lem:2-elt-atoms(i)} If $x^2 = 1_H$ or $x^2 = x$, then it is clear that $\{1_H,x\} = \{1_H,x\}^2$, and therefore $\{1_H,x\}$ is not an atom of $\mathcal P_\fun(H)$. As for the converse, assume that $\{1_H,x\} = YZ$ for some non-units $Y,Z \in \mathcal P_\fun(H)$. Then we get from Proposition \ref{prop:pm-arith} that $Y$ and $Z$ are $2$-element sets, namely, $Y = \{1_H, y\}$ and $Z = \{1_H, z\}$ with $y,z \in H \setminus \{1_H\}$. Hence $\{1_H,x\} = YZ = \{1_H,y,z,yz\}$, and immediately this implies $x=y=z$. Therefore, $\{1_H,x\} = \{1_H,x,x^2\}$, which is only possible if $x^2 = 1_H$ or $x^2 = x$.
	
	\ref{it:lem:2-elt-atoms(ii)} Suppose that $x^2 = 1_H$ or $x^2 = x$. Then the calculation above shows that $\{1_H,x\} = \{1_H,x\}^2$ and there is no other decomposition of $\{1_H,x\}$ into a product of non-unit elements of $\mathcal P_{\fin,1}(H)$. So, $\{1_H,x\}$ is a non-trivial idempotent (hence, a non-unit) and has no factorization into atoms of $\mathcal P_{\fin,1}(H)$.
	
	It remains to prove the analogous statement for $\mathcal P_{\fin,\times}(H)$.
	For, assume to the contrary that $\{1_H,x\}$ factors into a product of $n$ atoms of $\mathcal P_{\fin,\times}(H)$ for some $n \in \mathbf N^+$. Then $n \ge 2$, since $\{1_H, x\}$ is a non-trivial idempotent (and hence not an atom itself). Consequently, we can write $\{1_H,x\} = YZ$, where $Y$ is an atom and $Z$ a non-unit of $\mathcal P_{\fin,\times}(H)$. In particular, we get from parts \ref{it:prop:pm-arith(i)}, \ref{it:prop:pm-arith(ii)}, and \ref{it:prop:pm-arith(iv)} of Proposition \ref{prop:pm-arith} that both $Y$ and $Z$ are $2$-element sets, say, $Y = \{u, y\}$ and $Z = \{v, z\}$. It is then immediate that there are only two possibilities: $1_H$ is the product of two units from $Y$ and $Z$, or the product of two non-units from $Y$ and $Z$.
	Without loss of generality, we are thus reduced to considering the following cases.
	\vskip 0.1cm
	\textsc{Case 1:} $uv=1_H$. Then $uz \ne 1_H$ (or else $z = u^{-1} = v$, contradicting the fact that $Z$ is a $2$-element set). So $uz=x$, and similarly $yv=x$. Then $y = xu = uzu$ and $z = xv = vyv$, and therefore
	\[
	\{u,y\} = \{u,uzu\} = \{1_H,uz\}\cdot \{u\} = \{1_H,x\}\cdot\{u\} = \{u,y\}\cdot \{vu,zu\}
	\]
	However, this shows that $\{u,y\}$ is not an atom of $\P_\funt(H)$, in contrast with our assumptions.
	\vskip 0.1cm
	\textsc{Case 2:}
	$yz = 1_H$ and $y,z\in H\setminus H^\times$. Then $u,v\in H^\times$, by the fact that $\{u, y\}, \{v, z\} \in \mathcal P_{\fin,\times}(H)$; and we must have $uz=x$, for $uz=1_H$ would yield $z = u^{-1}\in H^\times$.
	In particular, $x = uz$ is not a unit in $H$, so $uv=1_H$ and we are back to the previous case.
\end{proof}
%
We have just seen that, to even {\it hope} for $\P_\fun(H)$ to be atomic, we must have that the ``bottom layer'' of $2$-element subsets of $H$ consists only of atoms, and it will turn out that such a condition is also sufficient.
Before proving this, it seems appropriate to point out some structural implications of the fact that every non-identity element of $H$ is neither an idempotent nor a square root of $1_H$.
%
\begin{lemma}\label{lem:no-non-id-elts-of-small-order-implies-structure}
	Let $H$ be a monoid such that $1_H \ne x^2 \ne x$ for all $x\in H\setminus\{1_H\}$. The following hold:
	%
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:lem:no-non-id-elts-of-small-order-implies-structure(i)}
		$H$ is Dedekind-finite.
		\item\label{it:lem:no-non-id-elts-of-small-order-implies-structure(ii)}
		If $x \in H$ and $\gen{x}_H$ is finite, then $x \in H^\times$ and $\gen{x}_H$ is a cyclic group of order $\ge 3$.
	\end{enumerate}
\end{lemma}
%
\begin{proof}
	\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(i)}
	Let $y,z\in H$ such that $yz = 1_H$. Then $(zy)^2 = z(yz)y = zy$, and since $H$ has no non-trivial i\-dem\-po\-tents, we conclude that $zy=1_H$. Consequently, $H$ is Dedekind-finite.
	
	\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(ii)}
	This is an obvious consequence of \cite[Ch. V, Exercise 4, p. 68]{whitelaw}, according to which every finite semigroup has an idempotent.
	The proof is short, so we give it here for the sake of self-containedness.
	
	Because $\gen{x}_H$ is finite, there exist $n, k \in \mathbf N^+$ such that $x^n = x^{n+k}$, and by induction this implies that $x^n = x^{n+hk}$ for all $h \in \mathbf N$. Therefore, we find that
	\[
	(x^{nk})^2 = x^{2nk} = x^{(k+1)n}x^{(k-1)n} = x^n x^{(k-1)n} = x^{nk}.
	\]
	But $H$ has no non-trivial idempotents, thus it must be the case that $x^{nk}=1_H$. That is, $x$ is a unit of $H$, and we have $x^{-1} = x^{nk-1} \in \gen{x}_H$. So, $\gen{x}_H$ is a (finite) cyclic group of order $\ge 3$.
\end{proof}

%

\begin{thm}\label{th:atomicity}
	Let $H$ be a monoid. Then $\mathcal P_\fun(H)$ is atomic if and only if $1_H \ne x^2 \ne x$ for every $x \in H \setminus \{1_H\}$.
\end{thm}
%
\begin{proof}
	The ``only if'' part is a consequence of Lemma \ref{lem:2-elt-atoms}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(ii)}.
	As for the other direction, assume that $1_H \ne x^2 \ne x$ for each $x\in H\setminus\{1_H\}$, and fix $X \in \mathcal P_{\fun}(H)$ with $|X| \ge 2$.
	We wish to show that 
	\[
	X = A_1 \cdots A_n, \quad\text{for some }A_1, \ldots, A_n \in \mathscr{A}(\mathcal P_{\fin,1}(H)).
	\]
	If $X$ is a $2$-element set, the claim is true by Lemma \ref{lem:2-elt-atoms}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(i)}. So let $|X| \ge 3$, and suppose inductively that every $Y \in \P_\fun(H)$ with $2 \le |Y| < |X|$ is a product of atoms. If $X$ is an atom, we are done.
	Otherwise, $X = A B$ for some non-units $A, B \in \P_\fun(H)$, and by symmetry we can assume $|X| \ge |A| \ge |B| \ge 2$. 
	
	If $|A| < |X|$, then both $A$ and $B$ factor into a product of atoms (by the inductive hypothesis), and so too does $X=A B$. Consequently, we are only left to consider the case when $|X| = |A|$. 
	
	For, we notice that 
	$
	A \cup B \subseteq A B = X 
	$
	(because $1_H \in A \cap B$), and this is only possible if $A = X$ (since $|A| = |X|$ and $A \subseteq X$). So, to summarize, we have that
	\begin{equation}\label{equ:containments}
	|X| \ge 3, \quad |B| \ge 2, \quad\text{and}\quad B \subseteq AB = X = A.
	\end{equation}
	In particular, since $B$ is not a unit of $\mathcal P_{\fin,1}(H)$, we can choose an element $b\in B\setminus\{1_H\} \subseteq A$. Hence, taking $A_b := A \setminus \{b\}$, we have $|A_b| < |A|$, and it is easy to check that $A_b B = A = X$ (in fact, $1_H$ is in $A_b \cap B$, and therefore we derive from \eqref{equ:containments} that $
	A_b B \subseteq A = A_b \cup \{b\} \subseteq A_b B \cup \{b\} \subseteq A_b B \cup B = A_b B$).
	
	If $|B|<|A|$, then we are done, because $A_b$ and $B$ are both products of atoms (by the inductive hypothesis), and thus so is $X = AB = A_bB$.
	Otherwise, it follows from \eqref{equ:containments} and the above that 
	\begin{equation}\label{equ:further-identities}
	X = A = B = A_b B \quad\text{and}\quad |A| \ge 3, 
	\end{equation}
	so we can choose an element $a \in A \setminus\{1_H,b\}$. Accordingly, set $B_a := B \setminus \{a\}$. Then $|B_a| < |B|$ (because $A = B$ and $a \in A$), and both $A_b$ and $B_a$ decompose into a product of atoms (again by induction). But this finishes the proof, since it is straightforward from \eqref{equ:further-identities} that $X = A = A_b B_a$ (indeed, $1_H \in A_b \cap B_a$ and $b \in B_a$, so we find that $
	A_b B_b \subseteq A = A_b \cup \{b\} \subseteq A_b B_a \cup \{b\} \subseteq A_b B_a \cup B_a = A_b B_a$).
\end{proof}

Now with Proposition \ref{prop:equimorphism} and Theorem \ref{th:atomicity} in hand, we can engage in a finer study of the arithmetic of power monoids; in particular, we may wish to study their (systems of) sets of lengths. However, we are immediately met with a ``problem'' (i.e., some sets of lengths are infinite in a rather trivial way):
%
\begin{eg}\label{unbounded-fzn}
	Let $H$ be a monoid with an element $x$ of finite odd order $m \ge 3$, and set $X := \{x^k : k \in \mathbf N \}$. Then it is clear that $X$ is the setwise product of $n$ copies of $\{1_H, x\}$ for every $n \ge m$. This shows that the set of lengths of $X$ relative to $\P_\fun(H)$ contains $\llb m, \infty \rrb$ (and hence is infinite), since we know from Lemma \ref{lem:2-elt-atoms} that $\{1_H, x\}$ is an atom of $\P_\fun(H)$.
\end{eg}
%
The nature of this problem is better clarified by our next result, and we will more thoroughly address it in \S{ }\ref{sec:minimal-factorizations}.
%
\begin{thm}\label{thm:BF-torsion}
	Let $H$ be a monoid. The following hold:
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:thm:BF-torsion(i)} If $H$ is torsion-free and $X\in \P_\fun(H)$, then $\sup \mathsf{L}_{\mathcal P_\fun(H)}(X) \le |X|^2-|X|$.
		\item\label{it:thm:BF-torsion(ii)} $\P_\fun(H)$ is \textup{BF} if and only if $H$ is torsion-free.
		\item\label{it:thm:BF-torsion(iii)} $\P_\funt(H)$ is \textup{BF} if and only if $H$ is torsion-free.
	\end{enumerate}
\end{thm}
\begin{proof}
	\ref{it:thm:BF-torsion(i)}
	Set $n := |X| \in \mathbf N^+$, let $\ell$ be an integer $> (n-1)n$, and suppose for a contradiction that $X = A_1\cdots A_\ell$ for some $A_1,\dots, A_\ell\in \mathscr{A}(\P_\fun(H))$.
	By the Pigeonhole Principle, there is an element $x\in X$ and a subset $I \subseteq \llb 1,\ell \rrb$ such that $m := |I| \ge n$ and $x \in A_i$ for each $i\in I$.
	So, writing $I = \{i_1,\ldots, i_m\}$, we find that $x^k \in A_{i_1} \cdots A_{i_k} \subseteq A_1\cdots A_\ell = X$ for every $k \in \llb 1, m \rrb$, i.e., $\{1_H,x,\dots, x^m\} \subseteq X$.
	However, since $H$ is torsion-free, each power of $x$ is distinct, and hence $n = |X| \ge m+1 > n$ (a contradiction).
	
	\ref{it:thm:BF-torsion(ii)}
	First suppose for a contradiction that $\P_\fun(H)$ is BF and has an element $x$ of finite order $m$; then $\P_\fun(H)$ is also atomic, and we know by Theorem \ref{th:atomicity} and Lemma \ref{lem:no-non-id-elts-of-small-order-implies-structure}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(ii)} that $x^m = 1_H$.
	If $m$ is even then $(x^{m/2})^2 = 1_H$, contradicting the atomicity of $\P_\fun(H)$ since, by Theorem \ref{th:atomicity}, no non-identity element of $H$ can have order 2. 
	If $m$ is odd then Example \ref{unbounded-fzn} shows us that the set of lengths of $\{x^k : k \in \mathbf N \}$ is infinite, a contradiction to the assumption that $\P_\fun(H)$ is BF.
	
	Conversely, suppose $H$ is torsion-free; then all powers of non-identity elements are distinct, so Theorem \ref{th:atomicity} implies that $\P_\fun(H)$ is atomic, and \ref{it:thm:BF-torsion(i)} gives an explicit upper bound on the lengths of factorizations.
	
	\ref{it:thm:BF-torsion(iii)} 
	By part \ref{it:thm:BF-torsion(ii)}, it is sufficient to show that $\P_\funt(H)$ is BF if and only if $\P_\fun(H)$ is BF.
	The ``only if'' direction follows from \cite[Theorem 2.28(iv) and Corollary 2.29]{fan-tringali18}, so suppose that $\P_\fun(H)$ is BF.
	Then $\P_\fun(H)$ is atomic, and hence, by Theorem \ref{th:atomicity}, $1_H \neq x^2 \neq x$ for all $x\in H\setminus\{1_H\}$.
	In view of Lemma \ref{lem:no-non-id-elts-of-small-order-implies-structure}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(ii)}, this implies that $H$ is Dedekind-finite, so the natural embedding $\P_\fun(H)\hookrightarrow\P_\funt(H)$ is an essentially surjective equimorphism by Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)}.
	The result then follows from Proposition  \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(iv)}.
\end{proof}

\section{Minimal factorizations and conditions for bounded minimal lengths} \label{sec:min-fac}
\label{sec:minimal-factorizations}
%

%
Example \ref{unbounded-fzn} seems to indicate that, in the presence of torsion in the ground monoid $H$, the sets of lengths in $\P_\fun(H)$ can blow up in a predictable fashion.
In the commutative setting, we could counteract such phenomena directly by considering only factorizations involving ``sufficiently low'' powers of atoms (cf. the notion of ``index'' and the corresponding sets of factorization classes defined in \cite{geroldinger-lettl90}).
We strive instead to axiomatize an approach which responds to \textit{all} non-cancellative phenomena in a general monoid, spurring us to introduce a refinement of our notion of factorization (recall that, given a set $X$, we let $\varepsilon_X$ be the identity of $\mathscr F^\ast(X)$, the free monoid with basis $X$).
%
\begin{defn}\label{def:preorder}
	Let $H$ be a monoid. We denote by $\preceq_H$ 
	the binary relation on $\mathscr F^\ast(\mathscr A(H))$ determined by taking $\mathfrak a \preceq_H \mathfrak b$, for some  
	$\mathscr A(H)$-words $\mathfrak a$ and $\mathfrak b$ of length $h$ and $k$ respectively, if and only if 
	\begin{enumerate}[label=$\bullet$]
		\item $\mathfrak b = \varepsilon_{\mathscr A(H)}$ and $\pi_H(\mathfrak a) = 1_H$, or
		\item $\mathfrak a$ and $\mathfrak b$ are non-empty words, say $\mathfrak a = a_1 \ast \cdots \ast a_h$ and $\mathfrak b = b_1 \ast \cdots \ast b_k$, and
		there is an injection $\sigma: \llb 1, h \rrb \to \llb 1, k \rrb$ such that $b_i \simeq_H a_{\sigma(i)}$ for every $i \in \llb 1, h \rrb$. 
	\end{enumerate}
	We shall write $\mathfrak{a} \prec_H \mathfrak{b}$ if $\mathfrak{a} \preceq_H \mathfrak{b}$ but $\mathfrak{b} \not\preceq_H \mathfrak{a}$, and say that a word $\mathfrak{a} \in \mathscr F^\ast(\mathscr A(H))$ is \textit{$\preceq_H$-minimal} (or simply \textit{minimal}) if there does not exist any $\A(H)$-word $\mathfrak{b}$ such that $\mathfrak{b} \prec_H \mathfrak{a}$.
\end{defn}
%
The next result highlights a few basic properties of the relation introduced in Definition \ref{def:preorder}.
%
\begin{prop}\label{preorder-facts}
	Let $H$ be a monoid, and let $\mathfrak{a},\mathfrak{b}\in \mathscr F^*(\A(H))$. The following hold:
	\begin{enumerate}[label = {\textup{(\roman{*})}}]
		\item\label{it:prop:preorder-facts(0)} $\preceq_H$ is a preorder \textup{(}i.e., a reflexive and transitive binary relation\textup{)} on $\mathscr F^\ast(\mathscr A(H))$.
		\item\label{it:prop:preorder-facts(ii)} If $\mathfrak{a} \preceq_H \mathfrak{b}$ then $\| \mathfrak{a} \|_H \le \| \mathfrak{b} \|_H$.
		\item\label{it:prop:preorder-facts(i)} $\varepsilon_{\mathscr A(H)} \preceq_H \mathfrak a$ if and only if $\mathfrak a = \varepsilon_{\mathscr A(H)}$.
		%\item\label{it:prop:preorder-facts(iii)} $\mathfrak{a} \preceq \mathfrak{b}$ if and only if $\mathfrak{b}$ has a subword $\mathfrak{b}' \in \llb \mathfrak{a} \rrb_{\mathscr C_H}$.
		\item\label{it:prop:preorder-facts(iv)} $\mathfrak{a} \preceq_H \mathfrak{b}$ and $\mathfrak{b} \preceq_H \mathfrak{a}$ if and only if $\mathfrak a \preceq_H \mathfrak b$ and $\|\mathfrak a\|_H = \|\mathfrak b\|_H$, if and only if $(\mathfrak{a},\mathfrak{b}) \in \C_H$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	Points \ref{it:prop:preorder-facts(0)} and \ref{it:prop:preorder-facts(ii)} are straightforward from our definitions, and for  \ref{it:prop:preorder-facts(i)} it suffices to note that, by Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(0)}, $\pi_H(\mathfrak a) = 1_H$ if and only if $\mathfrak a = \varepsilon_{\mathscr A(H)}$. 
	
	As for \ref{it:prop:preorder-facts(iv)}, set $h := \|\mathfrak a\|_H$ and $k := \|\mathfrak b\|_H$. 
	By part \ref{it:prop:preorder-facts(ii)}, $\mathfrak{a} \preceq_H \mathfrak{b}$ and $\mathfrak{b} \preceq_H \mathfrak{a}$ only if  $\mathfrak a \preceq_H \mathfrak b$ and $h = k$; and it is immediate to check that $(\mathfrak{a},\mathfrak{b}) \in \C_H$ implies $\mathfrak{a} \preceq_H \mathfrak{b}$ and $\mathfrak{b} \preceq_H \mathfrak{a}$. 
	
	So, to finish the proof, assume that $\mathfrak a \preceq_H \mathfrak b$ and $h = k$. We only need to show that $(\mathfrak a, \mathfrak b) \in \mathscr C_H$. For, we have (by definition) that $\mathfrak a \preceq_H \mathfrak b$ if and only if $\pi_H(\mathfrak a) = \pi_H(\mathfrak b)$ and there is an injection $\sigma: \llb 1, h \rrb \to \llb 1, k \rrb$ 
	such that $a_i \simeq_H b_{\sigma(i)}$ for every $i \in \llb 1, h \rrb$. But $\sigma$ is actually a bijection (because $h = k$), and we can thus conclude that $(\mathfrak a, \mathfrak b) \in \mathscr C_H$.
\end{proof}
%
\begin{defn}\label{min-fac}
	Let $H$ be a monoid and $x \in H$. An $H$-word $\mathfrak{a}$ is a \textit{$\preceq_H$-minimal factorization} of $x$, or simply a \textit{minimal factorization} of $x$ (in or relative to $H$), if $\mathfrak a \in \mathcal Z_H(x)$ and $\mathfrak a$ is $\preceq_H$-minimal.
	Accordingly, 
	\[
	\mathcal{Z}_{H}^\m(x) := \left\{ \mathfrak{a}\in \mathcal{Z}_H(x): \mathfrak{a} \textrm{ is $\preceq_H$-minimal} \right\}
	\quad\text{and}\quad
	\mathsf{Z}_{H}^\m(x):= \mathcal{Z}_{H}^\m(x)/\mathscr{C}_H
	\]
	shall denote, respectively, the set of $\preceq_H$-minimal factorizations and the set of $\preceq_H$-minimal factorization classes of $x$ (cf. the definitions from \S{ }\ref{sec:factorizations}). In addition, we take 
	\[
	\mathsf{L}_{H}^\m(x) := \left\{ \|\mathfrak{a}\|_H : \mathfrak{a} \in \mathcal{Z}_{H}^\m(x) \right\} \subseteq \mathbf N
	\]
	to be the set of \textit{$\preceq_H$-minimal factorization lengths} of $x$, and
	\[
	\mathcal{L}^\m(H) := \left\{ \mathsf{L}_{H}^\m(x) : x\in H \right\} \subseteq \mathcal P(\mathbf N)
	\]
	to be the \textit{system of sets of $\preceq_H$-minimal lengths} 
	of $H$.
	Lastly, we say that the monoid $H$ is
	\begin{itemize}
		\item \textup{BmF} 
		or \textit{bounded-minimally-factorial} (respectively, \textup{FmF} or \textit{finite-minimally-factorial}) if $\mathsf{L}_{H}^\m(x)$ (respectively, $\mathsf{Z}_{H}^\m(x)$) is finite and non-empty for every $x\in H\setminus H^\times$;
		\item \textup{HmF} or \textit{half-minimally-factorial} (respectively, \textit{minimally factorial}) if $\mathsf{L}_{H}^\m(x)$ (respectively, $\mathsf{Z}_{H}^\m(x)$) is a singleton for all $x \in H \setminus H^\times$.
		%
		%\item \textit{minimally factorial} if $\mathsf{Z}_{H}^\m(x)$ is a singleton
	\end{itemize}
	Note that we may write $\mathcal{Z}^\m(x)$ for $\mathcal{Z}_{H}^\m(x)$, $\mathsf {L}^\m(x)$ for $\mathsf {L}_{H}^\m(x)$, etc. if there is no likelihood of confusion.
\end{defn}
%
It is helpful, at this juncture, to observe some fundamental features of minimal factorizations.
%
\begin{prop}\label{prop:min-basics}
	Let $H$ be a monoid and let $x\in H$. The following hold:
	%
	\begin{enumerate}[label = {\rm (\roman{*})}]
		\item\label{it:prop:min-basics(i)} Any $\A(H)$-word of length $0$, $1$, or $2$ is minimal.
		\item\label{it:prop:min-basics(ii)} $\Z_H(x) \ne \emptyset$ if and only if  $\Z_H^\m(x) \ne \emptyset$.
		%
		\item\label{it:prop:min-basics(iib)} If $\mathfrak a \in \mathcal Z_H^\m(x)$ and $(\mathfrak a, \mathfrak b) \in \mathscr C_H$, then $\mathfrak b \in \mathcal Z_H^\m(x)$.
		%
		\item\label{it:prop:min-basics(iii)} If $K$ is a divisor-closed submonoid of $H$ and $x \in K$, then $\Z_K^\m(x) = \Z_H^\m(x)$ and $\mathsf L_K^\m(x) = \mathsf L_H^\m(x)$.
		\item\label{it:prop:min-basics(iv)} If $H$ is commutative and unit-cancellative, then $\Z_H^\m(x) = \Z_H(x)$, and hence $\mathsf L_H^\m(x) = \mathsf L_H(x)$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	\ref{it:prop:min-basics(i)}, \ref{it:prop:min-basics(ii)}, and \ref{it:prop:min-basics(iib)} are an immediate consequence of parts \ref{it:prop:preorder-facts(ii)}-\ref{it:prop:preorder-facts(iv)} of Proposition \ref{preorder-facts} (in particular, note that, if $\mathfrak a$  is an $\mathscr A(H)$-word of length $1$, then $\pi_H(\mathfrak a)$ is an atom of $H$, and therefore $\pi_H(\mathfrak a) \ne \pi_H(\mathfrak b)$ for every  $\mathscr A(H)$-words $\mathfrak b$ of length $\ge 2$); and \ref{it:prop:min-basics(iii)} follows at once from considering that, if $K$ is a divisor-closed submonoid of $H$ and $x \in K$, then $\mathcal Z_K(x) = \mathcal Z_H(x)$ and $\mathsf L_K(x) = \mathsf L_H(x)$, see \cite[Proposition 2.21(ii)]{fan-tringali18}.
	
	\ref{it:prop:min-basics(iv)} Assume $H$ is commutative and unit-cancellative. It suffices to check that no non-empty $\mathscr A(H)$-word has a proper subword with the same product.
	For, suppose to the contrary that there exist  $a_1,\dots,a_n \in \mathscr A(H)$ with $\prod_{i \in I} a_i = a_1\cdots a_n$ for some $I \subsetneq \llb 1, n \rrb$. Since $H$ is commutative, we can assume without loss of generality that $I = \llb 1, k \rrb$ for some $k \in \llb 0, n-1 \rrb$. Then unit-cancellativity implies $a_{k+1}\cdots a_n \in H^\times$, and we get from \cite[Proposition 2.30]{fan-tringali18} that $a_{k+1},\dots,a_n \in H^\times$, which is however impossible (by definition of an atom).	
	%	
	%	\ref{it:prop:min-basics(vi)}
\end{proof}
%
To further elucidate the behavior of minimal factorizations, we give an analogue of Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(ii)} showing that multiplying a non-unit by units does not change its set of minimal factorizations.
%
\begin{lemma}\label{lem:min-unit-adjust}
	Let $H$ be a monoid, and fix $x\in H\setminus H^\times$ and $u,v\in H^\times$.
	Then there is a length-preserving bijection $\mathcal{Z}_H^\m(x)\to\mathcal{Z}_H^\m(uxv)$, and in particular $\mathsf L_H^\m(x) = \mathsf L_H^\m(uxv)$.
\end{lemma}
\begin{proof}
	Given $w, z \in H$ and a non-empty word $\mathfrak{z} = y_1 \ast \cdots \ast y_n \in \mathscr F^\ast(H)$ of length $n$, denote by $w\mathfrak{z}z$ the length-$n$ word $\bar{y}_1 \ast \cdots \ast \bar{y}_n \in \mathscr F^\ast(H)$ defined by taking $\bar{y}_1 := w y_1 z$ if $n = 1$, and $\bar{y}_1:= wy_1$, $\bar{y}_n := y_nz$, and $\bar{y}_i := y_i$ for all $i\in \llb 2,n-1\rrb$ otherwise. 
	We claim that the function 
	$$
	f: \mathcal{Z}_H^\m(x) \to \mathcal{Z}_H^\m(uxv): \mathfrak a \mapsto u\mathfrak a v
	$$
	is a well-defined length-preserving bijection. 
	In fact, it is sufficient to show that $f$ is well-defined, since this will in turn imply that the map $g: \mathcal{Z}_H^\m(uxv)\to\mathcal{Z}_H^\m(x):\mathfrak{b}\mapsto u^{-1}\mathfrak{b}v^{-1}$ is also well-defined (observe that $uxv \in H \setminus H^\times$ and $x = u^{-1} uxv v^{-1}$), and then it is easy to check that $g$ is the inverse of $f$.
	
	For the claim, let $\mathfrak a \in \mathcal{Z}_H^\m(x)$, and note that, by Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(0)}, $\|\mathfrak a\|_H$ is a positive integer, so that  $\mathfrak a = a_1 \ast \cdots \ast a_n$ for some $a_1, \ldots, a_n \in \mathscr A(H)$. 
	In view of Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(i)}, $u\mathfrak{a}v$ is a factorization of $uxv$, and we only need to verify that it is also $\preceq_H$-minimal. For,
	suppose to the contrary that $\mathfrak b \prec_H u\mathfrak av$ for some $\mathfrak b \in \mathscr F^\ast(\mathscr A(H))$.
	Then $\pi_H(\mathfrak b) = \pi_H(u\mathfrak a v) = uxv$ and, by Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)},
	$
	k := \|\mathfrak b\|_H \in \llb 1, n-1 \rrb
	$
	(recall that $uxv \notin H^\times$). So, $\mathfrak b = b_1 \ast \cdots \ast b_k$ for some atoms  $b_1, \ldots, b_k \in H$, and there exists an injection $\sigma: \llb 1, k \rrb \to \llb 1, n \rrb$ such that $b_i \simeq_H a_{\sigma(i)}$ for each $i \in \llb 1, k \rrb$.
	Define
	$
	\mathfrak{c} := u^{-1} \mathfrak b v^{-1}$. 
	
	By construction and Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(i)}, there are  $c_1, \ldots, c_k \in \mathscr A(H)$ such that $\mathfrak c = c_1 \ast \cdots \ast c_k$; and it follows from the above that $\pi_H(\mathfrak c) = u^{-1} \pi_H(\mathfrak b) v^{-1} = x$ and $c_i \simeq_H a_{\sigma(i)}$ for every $i \in \llb 1, k \rrb$. Since $k < n$, we can thus conclude from Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)} that $\mathfrak c \prec_H \mathfrak a$, contradicting the $\preceq_H$-minimality of $\mathfrak{a}$.
\end{proof}
%
We saw in the previous section that equimorphisms transfer factorizations between monoids (Proposition \ref{prop:equimorphism}).  
Equimorphisms have a similar compatibility with minimal factorizations, in the sense that an equimorphism also satisfies a ``minimal version'' of condition \ref{def:equimorphism(E3)} from Definition \ref{def:equimorphism}.
%
%
%
\begin{prop}\label{prop:min-equi}
	Let $H$ and $K$ be monoids and $\varphi: H\to K$ an equimorphism. The following hold: 
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:prop:min-equi(i)} If $x\in H \setminus H^\times$ and $\mathfrak{b}\in \mathcal{Z}_K^\m(\varphi(x))$, then there is $\mathfrak{a}\in \mathcal{Z}_H^\m(x)$ with $\varphi^*(\mathfrak{a})\in \llb \mathfrak{b} \rrb_{\mathscr{C}_K}$.
		%
		\item\label{it:prop:min-equi(ii)} $\mathsf{L}_K^\m(\varphi(x)) \subseteq \mathsf{L}_H^\m(x)$ for every $x\in H\setminus H^\times$.
		\item\label{it:prop:min-equi(iii)} If $\varphi$ is essentially surjective then, for all $y\in K\setminus K^\times$, there is $x\in H\setminus H^\times$ with $\mathsf{L}_K^\m(y) \subseteq \mathsf{L}_H^\m(x)$. 
	\end{enumerate}
\end{prop}
%
\begin{proof}
	\ref{it:prop:min-equi(i)}
	Pick $x\in H \setminus H^\times$, and let $\mathfrak b \in \mathcal{Z}_K^\m(\varphi(x))$. Then $\mathfrak b \ne \varepsilon_{\mathscr A(K)}$, otherwise $\varphi(x) = \pi_K(\mathfrak b) = 1_K$ and, by \ref{def:equimorphism(E1)}, $x \in \varphi^{-1}(\varphi(x)) = \varphi^{-1}(1_K) \subseteq H^\times$ (a contradiction). Consequently, \ref{def:equimorphism(E3)} yields the existence of a factorization $\mathfrak{a}\in \mathcal{Z}_H(x)$ with $\varphi^*(\mathfrak{a}) \in \llb \mathfrak{b} \rrb_{\mathscr{C}_K}$, and it only remains to show that $\mathfrak a$ is $\preceq_H$-minimal. 
	
	For, note that $n := \|\mathfrak a\|_H = \|\varphi^\ast(\mathfrak a)\|_K = \|\mathfrak b\|_K \ge 1$, and write $\mathfrak a = a_1 \ast \cdots \ast a_n$ and $\mathfrak b = b_1 \ast \cdots \ast b_n$, with $a_1, \ldots, a_n \in \mathscr A(H)$ and $b_1, \ldots, b_n \in \mathscr A(K)$. Then suppose to the contrary that $\mathfrak a$ is not $\preceq_H$-minimal, i.e., there exist a (necessarily non-empty) $\mathscr A(H)$-word $\mathfrak{c} = c_1 \ast \cdots \ast c_m$ and an injection $\sigma: \llb 1, m \rrb \to \llb 1, n \rrb$ such that $\pi_H(\mathfrak c) = \pi_H(\mathfrak a) = x$ and $c_i \simeq_H a_{\sigma(i)}$ for every $i \in \llb 1, m \rrb$. Then
	\[
	\pi_K(\varphi^\ast(\mathfrak c)) = \varphi(c_1) \cdots \varphi(c_m) = \varphi(x)
	\quad\text{and}\quad
	\varphi(c_1) \simeq_K \varphi(a_{\sigma(1)}), \ldots, \varphi(c_m) \simeq_K \varphi(a_{\sigma(m)})
	\]
	(recall that monoid hom\-o\-mor\-phisms map units to units; so, if $u \simeq_H v$, then $\varphi(u) \simeq_K \varphi(v)$); and together with Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(iib)}, this proves that 
	$\varphi^\ast(\mathfrak c) \prec_K \mathfrak b$, contradicting the $\preceq_K$-minimality of $\mathfrak b$.
	
	\ref{it:prop:min-equi(ii)} Fix $x \in H \setminus H^\times$, and suppose $\mathsf{L}_K^\m(\varphi(x)) \ne \emptyset$ (otherwise there is nothing to prove). Accordingly, let $k \in \mathsf{L}_K^\m(\varphi(x))$ and $\mathfrak b \in \mathcal Z_K^\m(\varphi(x))$ such that $k = \|\mathfrak b\|_K$. It is sufficient to check that $k \in \mathsf L_H^\m(x)$, and this is straightforward: Indeed, we have by \ref{it:prop:min-equi(i)} that $\varphi^\ast(\mathfrak a)$ is $\mathscr C_K$-congruent to $\mathfrak b$ for some $\mathfrak a \in \mathcal Z_H^\m(x)$, which implies in particular that $k = \|\varphi^\ast(\mathfrak a)\|_K = \|\mathfrak a\|_H \in \mathsf L_H^\m(x)$.
	
	\ref{it:prop:min-equi(iii)} Assume $\varphi$ is essentially surjective, and let $y \in K \setminus K^\times$. Then $y = u \varphi(x) v$ for some $u,v\in K^\times$ and $x\in H$, and neither $x$ is a unit of $H$ nor $\varphi(x)$ is a unit of $K$ (because $\varphi(H^\times) \subseteq K^\times$ and $y \notin K^\times$). Accordingly, we have by Lemma \ref{lem:min-unit-adjust} and part \ref{it:prop:min-equi(ii)} that $\mathsf{L}_K^\m(y) = \mathsf{L}_K^\m(\varphi(x)) \subseteq \mathsf{L}_H^\m(x)$.
\end{proof}
%
Let $H$ be a monoid. As in \S{ }\ref{sec:atomicity}, we would like to simplify the study of minimal factorizations in $\P_\funt(H)$ as much as possible by passing to consideration of the reduced monoid $\P_\fun(H)$. For, we have to make clear the nature of the relationship between minimal factorizations in $\P_\funt(H)$ and those in $\P_\fun(H)$.
We shall see that this is possible under \textit{some} circumstances. 
%
\begin{prop}\label{prop:comm-pm}
	Let $H$ be a commutative monoid, and let $X\in \P_{\fin,1}(H)$. The following hold:
	\begin{enumerate}[label = {\rm (\roman{*})}]
		\item\label{it:prop:comm-pm(i)} $\Z_{\P_{\fin,1}(H)}^\m(X) \subseteq \Z_{\P_{\funt}(H)}^\m(X)$.
		\item\label{it:prop:comm-pm(ii)} $\mathsf{L}_{\P_{\fin,1}(H)}^\m(X) = \mathsf{L}_{\P_\funt(H)}^\m(X)$.
		\item\label{it:prop:comm-pm(iii)} $\mathcal{L}^\m(\P_{\fin,1}(H)) = \mathcal{L}^\m(\P_\funt(H))$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	\ref{it:prop:comm-pm(i)} Let $\mathfrak{a}$ be a minimal factorization of $X$ relative to $\P_{\fin,1}(H)$. In light of Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, $\mathfrak{a}$ is a non-empty $\mathscr A(\mathcal P_{\fin,1}(H))$-word, i.e., $\mathfrak a = A_1 \ast \cdots \ast A_n$ for some atoms $A_1, \ldots, A_n \in \mathcal P_{\fin,1}(H)$. 
	
	Assume for the sake of contradiction that $\mathfrak a$ is not a minimal factorization relative to $\P_{\fin,\times}(H)$. Then there exist a non-empty $\mathscr A(\mathcal P_{\fin,\times}(H))$-word $\mathfrak b = B_1 * \cdots * B_m$ and an injection $\sigma: \llb 1, m \rrb \to \llb 1, n \rrb$ with 
	\[
	X = A_1 \cdots A_n = B_1 \cdots B_m
	\quad\text{and}\quad
	B_1 \simeq_{\mathcal P_{\fin,\times}(H)} A_{\sigma(1)}, \ldots, B_m \simeq_{\mathcal P_{\fin,\times}(H)} A_{\sigma(m)},
	\]
	and on account of Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)} we must have $1 \le m < n$.
	Since $H$ is a commutative monoid, this means in particular that, for each $i \in \llb 1, m \rrb$, there is $u_i \in H^\times$ such that $B_i = u_i A_{\sigma(i)}$. Thus we have
	\[
	A_1 \cdots A_n = B_1 \cdots B_m = (u_1 A_{\sigma(1)}) \cdots (u_m A_{\sigma(m)}) = u \cdot A_{\sigma(1)} \cdots A_{\sigma(m)},
	\]
	where $u := u_1 \cdots u_m \in H^\times$. In view of Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(ii)}, it follows that
	\[
	\left| A_1 \cdots A_n \right| = \left|A_{\sigma(1)} \cdots A_{\sigma(m)} \right|,
	\]
	which is only possible if 
	\[
	X = A_1 \cdots A_n = A_{\sigma(1)} \cdots A_{\sigma(m)}, 
	\]
	because $1_H \in A_i$ for every $i \in \llb 1, n \rrb$, and hence $A_{\sigma(1)} \cdots A_{\sigma(m)} \subseteq A_1 \cdots A_n$ (note that here we use again that $H$ is commutative). So, letting $\mathfrak a^\prime$ be the $\mathscr A(\mathcal P_{\fin,1}(H))$-word $ A_{\sigma(1)} \ast \cdots \ast A_{\sigma(m)}$ and recalling from the above that $m \le n-1$, we see by Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)} that $\mathfrak a^\prime \prec_{\mathcal P_{\fin,1}(H)} \mathfrak a$, which contradicts the hypothesis that $\mathfrak a$ is a minimal factorization of $X$ in $\mathcal P_{\fin,1}(H)$.
	
	\ref{it:prop:comm-pm(ii)} It is an immediate consequence of part \ref{it:prop:comm-pm(i)} and Propositions \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} and \ref{prop:min-equi}\ref{it:prop:min-equi(ii)}, when considering that every commutative monoid is Dedekind-finite.
	
	\ref{it:prop:comm-pm(iii)} We already know from part \ref{it:prop:comm-pm(ii)} that $\mathscr L^\m(\mathcal P_{\fin,1}(H)) \subseteq \mathscr L^\m(\mathcal P_\funt(H))$. For the opposite inclusion, fix $X \in \P_\funt(H)$. We claim that there exists $Y \in \mathcal P_{\fin,1}(H)$ with 
	$\mathsf L_{\P_\funt(H)}^\m(X) = \mathsf L_{\P_{\fin,1}(H)}^\m(Y)$.
	Indeed, pick $x \in X \cap H^\times$. Then $x^{-1} X\in \P_{\fin,1}(H)$, and we derive from Lemma \ref{lem:min-unit-adjust} and part \ref{it:prop:comm-pm(ii)} that 
	\[
	\mathsf{L}_{\P_\funt(H)}^\m(X) = \mathsf{L}_{\P_\funt(H)}^\m(x^{-1}X) = \mathsf{L}_{\P_{\fin,1}(H)}^\m(x^{-1} X),
	\]
	which proves our claim and suffices to finish the proof (since $X$ was arbitrary).
\end{proof}
%
We will now discuss an instance in which equality in Proposition \ref{prop:comm-pm}\ref{it:prop:comm-pm(ii)} does not necessarily hold true in the absence of commutativity, and the best we can hope for is the containment relation implied by Proposition \ref{prop:min-equi}\ref{it:prop:min-equi(ii)} when $\varphi$ is the natural embedding of  Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)}.
%is strict, so proving that the commutativity of $H$ in Proposition \ref{prop:min-equi} is critical.
%, by examining the natural embedding $\mathcal P_{\fin,1}(H) \hookrightarrow \mathcal P_{\fin,\times}(H)$, cf. Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)}.
%
\begin{eg}\label{exa:strict-inclusion}
	Let $n$ be a (positive) multiple of $105$, and $p$ a (positive) prime dividing $n^2 + n + 1$; note that $p \ge 11$ and $3 \le n \bmod p \le p-3$ (where $n \bmod p$ is the smallest non-negative integer $\equiv r \bmod p$). Following \cite[p. 27]{gorenstein80}, we take $H$ to be the metacyclic group generated by the $2$-element set $\{r, s\}$ subject to $\ord_H(r) = p$, $\ord_H(s) = 3$, and $s^{-1} r s = r^n$. 
	Then $H$ is a non-abelian group of (odd) order $3p$, and by Theorem \ref{th:atomicity} and Propositions \ref{prop:equimorphism}\ref{it:prop:equimorphism(ii)} and \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)}, $\mathcal P_{\fin,1}(H)$ and $\mathcal P_{\fin,\times}(H)$ are both atomic monoids. 
	
	We claim that $X := \langle r \rangle_H$ has minimal factorizations of length $p-1$ in $\mathcal P_{\fin,1}(H)$ but not in $\mathcal P_{\fin,\times}(H)$.
	For, pick $g \in X \setminus \{1_H\}$. Clearly $\ord_H(g) = p$, and thus we get from Lemma \ref{lem:2-elt-atoms}\ref{it:lem:2-elt-atoms(i)} that $\{1_H, g\}$ is an atom of $\mathcal P_{\fin,1}(H)$. Then it is immediate to see that $\mathfrak a_g := \{1_H, g\}^{\ast (p-1)}$ is a minimal factorization of $X$ in $\mathcal P_{\fin,1}(H)$; most notably, $\mathfrak a_g$ is minimal since otherwise there should exist an exponent $k \in \llb 1, p-2 \rrb$ such that $g^{p-1} = g^k$, contradicting that $\ord_H(g) = p$. Yet, $\mathfrak a_g$ is not a minimal factorization of $X$ in $\mathcal P_{\fin,\times}(H)$.
	Indeed, Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(ii)} and Lemma \ref{lem:2-elt-atoms}\ref{it:lem:2-elt-atoms(i)} guarantee that $\{1_H, g\}$ and $\{1_H, g^n\}$ are associate atoms of $\mathcal P_{\fin,\times}(H)$, because $s^{-1} g^n s = g$ and, hence, $s^{-1} \{1, g\} s = \{1_H, g^n\}$. So, in view of Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)}, it is straightforward that 
	\[
	\{1_H, g\}^{\ast (p-2)} \ast \{1_H, g^n\} \prec_{\mathcal P_{\fin,\times}(H)} \mathfrak a_g,
	\]
	In particular, note here that we have used that $3 \le n \bmod p \le p-3$ to obtain
	\[
	\{1_H, g, \ldots, g^{p-2}\} \cup \{g^n, g^{n+1}, \ldots, g^{n+p-2}\} = \{1_H, g, \ldots, g^{p-1}\} = X.
	\]
	Given that, suppose for a contradiction that $X$ has a minimal factorization $\mathfrak c$ of length $p-1$ in $\mathcal P_{\fin,\times}(H)$. Then by Propositions \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} and \ref{prop:min-equi}\ref{it:prop:min-equi(i)}, $\mathfrak c$ is $\mathscr C_{\mathcal P_{\fin,\times}(H)}$-congruent to a $\preceq_{\mathcal P_{\fin,1}(H)}$-minimal fac\-tor\-ization $\mathfrak a = A_1 \ast \cdots \ast A_{p-1}$ of $X$ of length $p-1$; and we aim to show that $\mathfrak a$ is $\mathscr C_{\mathcal P_{\fin,1}(H)}$-congruent to $\mathfrak a_g$ for some $g \in X \setminus \{1_H\}$, which is however impossible as it would mean that $\mathfrak a_g$ is a minimal factorization of $X$ in $\mathcal P_{\fin,\times}(H)$, in contradiction to what established in the above.
	
	Indeed, let $B_i$ be, for $i \in \llb 1, p-1 \rrb$, the image of $\{k \in \llb 0, p-1 \rrb: r^k \in A_i\} \subseteq \bf Z$ under the canonical map $\mathbf Z \to \mathbf Z/p\mathbf Z$. Then $\mathfrak a$ is a minimal factorization of $X$ in $\mathcal P_{\fin,1}(H)$ only if $\mathfrak b := B_1 \ast \cdots \ast B_{p-1}$ is a minimal factorization of $\mathbf Z/p\mathbf Z$ in the reduced power monoid of $(\mathbf Z/p\mathbf Z, +)$, herein denoted by $\mathcal P_{\fin,0}(\mathbf Z/p\mathbf Z)$.
	
	We want to show that $\mathfrak b$ is $\preceq_{\mathcal P_{\fin,0}(H)}$-minimal only if there is a non-zero $x \in \mathbf Z/p\mathbf Z$ such that $B_i = \{\overline{0}, x\}$ or $B_i = \{\overline{0}, -x\}$, or equivalently $A_i = \{1_H, r^{\hat{x}}\}$ or $A_i = \{1_H, r^{-\hat{x}}\}$, for every $i \in \llb 1, p-1 \rrb$ (for notation, see \S{ }\ref{subsec:generalities}). By the preceding arguments, this will suffice to conclude that $p-1 \notin \mathsf L^\m_{\mathcal P_\funt(H)}(X)$, because it implies at once that $\mathfrak a$ is $\mathcal C_{\mathcal P_\fun(H)}$-congruent to $\mathfrak a_g$ with $g := r^{\hat{x}} \in X \setminus \{1_H\}$.
	
	To begin, let $K$ be a subset of $\llb 1, p-1 \rrb$, and define $\mathcal{S}_K := \sum_{k \in K} B_k$ and $s_K := \{k \in K: |B_k| \ge 3\}$. Then we have by the Cauchy-Davenport inequality (see, e.g., \cite[Theorem 6.2]{grynkiewicz13}) that
	%
	\begin{equation}\label{equ:cauchy-davenport-application}
	\mathcal{S}_K = \mathbf Z/p\mathbf Z 
	\quad\text{or}\quad
	|\mathcal{S}_K| \ge 1 + {\sum}_{k \in K} \bigl(|B_k| - 1\bigr) \ge 1 + |K| + s_K.
	\end{equation}
	Now, let $I$ and $J$ be disjoint subsets of $\llb 1, p-1 \rrb$ with $|I \cup J| = |I| + |J| = p-2$. We claim $s_I = s_J = 0$. Indeed, it is clear that $\mathcal{S}_{I \cup J} \ne \mathbf Z/p\mathbf Z$, otherwise $\mathfrak b$ would not be a minimal factorization in $\mathcal P_{\fin,0}(\mathbf Z/p\mathbf Z)$. So, another application of the Cauchy-Davenport inequality, combined with \eqref{equ:cauchy-davenport-application}, yields
	%
	\begin{equation}\label{equ:another-cauchy-davenport-application}
	|S_{I \cup J}| = |S_I + S_J| \ge |S_I| + |S_J| - 1 \ge 1 + |I| + |J| + s_I + s_J = p-1 + s_I + s_J.
	\end{equation}
	%
	This suffices to prove that $|S_I + S_J| = p-1$ and $s_I = s_J = 0$, or else $S_{I \cup J} = \mathbf Z/p\mathbf Z$ (a contradiction). 
	
	It follows $|B_1| = \cdots = |B_{p-1}| = 2$. So, taking $I$ in \eqref{equ:another-cauchy-davenport-application} to range over all $1$-element subsets of $\llb 1, p-1 \rrb$ and observing that, consequently, $|S_J| \ge p-1-|S_I| = p-3 \ge 8 > |S_I|$, we infer from Vosper's theorem (see, e.g., \cite[Theorem 8.1]{grynkiewicz13}) that there exists a non-zero $x \in \mathbf Z/p\mathbf Z$ such that, for every $i \in \llb 1, p-1 \rrb$, $B_i$ is an arithmetic progression of $\mathbf Z/p\mathbf Z$ with difference $x$, i.e., $B_i = \{\overline{0}, x\}$ or $B_i = \{\overline{0}, -x\}$ (as wished).
\end{eg}



We proceed with an analogue of Theorem \ref{thm:BF-torsion}\ref{it:thm:BF-torsion(i)} and then prove the main results of the section.

\begin{prop}\label{prop:bounded-minimal-fzn}
	Let $H$ be a monoid and $X \in \P_\funt(H)$. The following hold:
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:prop:bounded-minimal-fzn(i)} If $X\in \P_\fun(H)$, then a minimal factorization of $X$ in $\P_\fun(H)$ has length $\le |X|-1$.
		\item\label{it:prop:bounded-minimal-fzn(ii)} If $H$ is Dedekind-finite, then a minimal factorization of $X$ in $\P_\funt(H)$ has length $\le |X|-1$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	\ref{it:prop:bounded-minimal-fzn(i)} The claim is trivial if $X = \{1_H\}$, when the only factorization of $X$ is the empty word; or if $X \in \mathscr A(\P_{\fin,1}(H))$, in which case $|X| \ge 2$ and $X$ has a unique factorization (of length $1$). So, assume that $X$ is neither the identity nor an atom of $\mathcal P_{\fin,1}(H)$, and let $\mathfrak a$ be a minimal factorization of $X$ (relative to $\P_{\fin,1}(H)$). Then $\mathfrak a = A_1*\cdots* A_n$, where $A_1, \ldots, A_n \in \mathscr A(\mathcal P_{\fin,1}(H))$ and $n \ge 2$; and we claim that
	\[
	A_1\cdots A_i \subsetneq A_1\cdots A_{i+1}, \quad \text{for every }i \in \llb 1, n-1 \rrb.
	\]
	In fact, let $i \in \llb 1, n-1 \rrb$. Since $1_H \in A_{i+1}$, it is clear that $A_1\cdots A_i \subsetneq A_1\cdots A_{i+1}$; and the inclusion must be strict, or else $A_1 \ast \cdots \ast A_i \ast \mathfrak b \prec_{\mathcal P_{\fin,1}(H)} \mathfrak a$, where $\mathfrak b := \varepsilon_{\mathscr A(\mathcal P_{\fin,1}(H))}$ if $i = n-1$ and $\mathfrak b := A_{i+2} \ast \cdots \ast A_n$ otherwise (contradicting the minimality of $\mathfrak a$). Consequently, we see that
	$
	2 \le |A_1\cdots A_i | < |A_1\cdots A_{i+1}| \le |X|$ for all $i \in \llb 1, n-1 \rrb$, and this implies at once that $n\le |X|-1$.
	
	\ref{it:prop:bounded-minimal-fzn(ii)} The conclusion is immediate from part \ref{it:prop:bounded-minimal-fzn(i)} and Propositions \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} and \ref{prop:min-equi}\ref{it:prop:min-equi(iii)}.
\end{proof}
%
\begin{thm}\label{BmF-char}
	Let $H$ be a monoid. Then the following are equivalent:
	%
	\begin{enumerate}[label={\rm (\alph{*})}]
		\item\label{it:BmF-char(a)} $1_H \ne x^2 \ne x$ for every $x \in H \setminus \{1_H\}$.
		\item\label{it:BmF-char(b)} $\P_\fun(H)$ is atomic.
		\item\label{it:BmF-char(c)} $\P_\fun(H)$ is \textup{BmF}.
		\item\label{it:BmF-char(d)} $\P_\fun(H)$ is \textup{FmF}.
		\item\label{it:BmF-char(e)} Every $2$-element subset $X$ of $H$ with $1_H \in X$ is an atom of $\mathcal P_\fun(H)$.
		\item\label{it:BmF-char(f)} $\P_\funt(H)$ is atomic.
		\item\label{it:BmF-char(g)} $\P_\funt(H)$ is \textup{BmF}.
		\item\label{it:BmF-char(h)} $\P_\funt(H)$ is \textup{FmF}.
		\item\label{it:BmF-char(i)} Every $2$-element subset $X$ of $H$ with $X \cap H^\times \ne \emptyset$ is an atom of $\mathcal P_\funt(H)$.
	\end{enumerate}
	%
\end{thm}
%
\begin{proof}
	We already know from Theorem \ref{th:atomicity} and Lemma \ref{lem:2-elt-atoms} that \ref{it:BmF-char(b)} $\Leftrightarrow$ \ref{it:BmF-char(a)} $\Leftrightarrow$ \ref{it:BmF-char(e)} and \ref{it:BmF-char(i)} $\Rightarrow$ \ref{it:BmF-char(a)}; while it is straightforward from our definitions that \ref{it:BmF-char(h)} $\Rightarrow$ \ref{it:BmF-char(g)} $\Rightarrow$ \ref{it:BmF-char(f)}. So, it will suffice to prove that \ref{it:BmF-char(b)}
	$\Rightarrow$ \ref{it:BmF-char(c)} $\Rightarrow$ \ref{it:BmF-char(d)} $\Rightarrow$ \ref{it:BmF-char(h)}
	and \ref{it:BmF-char(f)} $\Rightarrow$
	\ref{it:BmF-char(i)}.
	
	%	$$
	%	\text{\ref{it:BmF-char(b)} }
	%	\Rightarrow 
	%	\text{ \ref{it:BmF-char(c)} }
	%	\Rightarrow 
	%	\text{ \ref{it:BmF-char(d)} }
	%	\Rightarrow
	%	\text{ \ref{it:BmF-char(h)} }
	%	\quad\text{and}\quad
	%	\text{ \ref{it:BmF-char(f)} }
	%	\Rightarrow
	%	\text{ \ref{it:BmF-char(b)}}.
	%	$$
	\ref{it:BmF-char(b)} $\Rightarrow$ \ref{it:BmF-char(c)}: If $X \in \mathcal P_\fun(H)$ is a non-unit, then $\mathcal{Z}_{\mathcal P_\fun(H)}(X)$ is non-empty, and by Propositions \ref{prop:min-basics}\ref{it:prop:min-basics(ii)} and \ref{prop:bounded-minimal-fzn}\ref{it:prop:bounded-minimal-fzn(i)} we have that $\emptyset \ne \mathsf{L}_{\mathcal P_\fun(H)}^\m(X) \subseteq \llb 1, |X|-1\rrb$. So, $\mathcal P_\fun(H)$ is BmF.
	
	\ref{it:BmF-char(c)} $\Rightarrow$ \ref{it:BmF-char(d)}: Let $X \in \mathcal P_\fun(H)$ be a non-unit. 
	By Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(i)}, any atom of $\mathcal P_\fun(H)$ dividing $X$ must be a subset of $X$, and there are only finitely many of these (since $X$ is finite).
	Because a minimal factorization of $X$ is a bounded $\mathscr A(\mathcal P_\fun(H))$-word (by the assumption that $H$ is BmF), it follows that $X$ has finitely many minimal factorizations, and hence $\mathcal P_\fun(H)$ is FmF (since $X$ was arbitrary).
	
	\ref{it:BmF-char(d)} $\Rightarrow$ \ref{it:BmF-char(h)}: Pick a non-unit $X \in \mathcal P_{\fin,\times}(H)$, and let $u \in H^\times$ such that $uX \in \mathcal P_{\fin,1}(H)$. Since $\mathcal P_{\fin,1}(H)$ is FmF (by hypothesis), it is also atomic. Hence, by Theorem \ref{th:atomicity} and Lemma \ref{lem:no-non-id-elts-of-small-order-implies-structure}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(i)}, $H$ is Dedekind-finite, and so we have by Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} that the natural embedding $\mathcal P_{\fin,1}(H) \hookrightarrow \mathcal P_{\fin,\times}(H)$ is an essentially surjective equimorphism.  
	In particular, we infer from Proposition \ref{prop:min-equi}\ref{it:prop:min-equi(i)} that any minimal factorization of $uX$ in $\mathcal P_{\fin,\times}(H)$ is $\mathscr C_{\mathcal P_{\fin,\times}(H)}$-congruent to a minimal factorization of $uX$ in $\mathcal P_{\fin,1}(H)$.
	However, this makes $\mathsf{Z}_{\mathcal P_{\fin,\times}(H)}^\m(uX)$ finite, whence $\mathsf{Z}_{\mathcal P_{\fin,\times}(H)}^\m(X)$ must also be finite as a consequence of Lemma \ref{lem:min-unit-adjust}.
	
	
	
	\ref{it:BmF-char(f)} $\Rightarrow$ \ref{it:BmF-char(i)}: Let $X$ be a $2$-element subset of $H$ with $X \cap H^\times \ne \emptyset$. Then $X = uA$ for some unit $u \in H^\times$, where $A := u^{-1}X$ is a $2$-element subset of $H$ with $1_H \in H$; and since $\mathcal P_{\fin,\times}(H)$ is atomic (by hypothesis), we are guaranteed by Lemmas \ref{lem:2-elt-atoms} and \ref{lem:no-non-id-elts-of-small-order-implies-structure}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(i)} that $A$ is an atom of $\mathcal P_\fun(H)$ and $H$ is Dedekind-finite. Therefore, we conclude from Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(ii)} that $X \in \mathscr A(\mathcal P_\funt(H))$.
\end{proof}

\begin{thm}\label{prop:HF-exp-3}
	Let $H$ be a monoid. Then $\mathcal P_\fun(H)$ is \textup{HmF} if and only if $H$ is trivial or a cyclic group of order $3$.
	%	
	%	Then the following are equivalent:
	%	\begin{enumerate}[label={\rm (\alph{*})}]
	%	\item\label{it:prop:HF-exp-3(i)} $\mathcal P_\fun(H)$ is \textup{HmF}.
	%	\item\label{it:prop:HF-exp-3(ii)} $H$ is trivial or a cyclic group of order $3$.
	%	\end{enumerate}
\end{thm}

\begin{proof}
	The ``if'' part is an easy consequence of Theorem \ref{BmF-char} and Propositions \ref{prop:bounded-minimal-fzn}\ref{it:prop:bounded-minimal-fzn(i)} and \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, when considering that, if $H$ is trivial or a cyclic group of order $3$, then $1_H \ne x^2 \ne x$ for all $x \in H \setminus \{1_H\}$ and every non-empty subset of $H$ has at most $3$ elements.
	%, and let $n \in \mathbf N^+$ such that $1_H,x,\dots, x^n$ are pairwise distinct. We claim that $n \le 2$.
	
	
	As for the other direction, suppose $\mathcal P_\fun(H)$ is HmF and $H$ is non-trivial. Then $\mathcal P_\fun(H)$ is atomic, and we claim that $H$ is a $3$-group. By Theorem \ref{th:atomicity} and Lemma \ref{lem:no-non-id-elts-of-small-order-implies-structure}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(ii)}, it suffices to show that
	$
	x^3 \in \{1_H, x, x^2\}$ for every $x \in H$, since this in turn implies (by induction) that $\langle x \rangle_H \subseteq \{1_H, x, x^2\}$ and $\ord_H(x) \le 3$.
	
	For, assume to the contrary that $x^3 \notin \{1_H, x, x^3\}$ for some $x \in H$, and set $X := \{1_H, x, x^2, x^3\}$. By Theorem \ref{BmF-char}, $\mathfrak a := \{1_H, x\}^{\ast 3}$ and $\mathfrak b := \{1_H, x\} \ast \{1_H, x^2\}$ are both factorizations of $X$ in $\mathcal P_\fun(H)$; and in light of Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, $\mathfrak b$ is in fact a minimal factorization (of length $2$). Then $\mathfrak a$ cannot be minimal, because $\mathcal P_\fun(H)$ is HmF and $\mathfrak a$ has length $3$. However, since $\mathcal P_\fun(H)$ is a reduced monoid (and $X$ is not an atom), this is only possible if $x^3 \in X = \{1_H, x\}^2$, a contradiction.
	
	So, $H$ is a $3$-group, and as such it has a non-trivial center $Z(H)$, see e.g. \cite[Theorem 2.11(i)]{Gor1980}. Let $z$ be an element in $Z(H) \setminus \{1_H\}$, and suppose for a contradiction that $H$ is not cyclic. Then we can choose some element $y \in H \setminus \gen{z}_H$, and it follows from the above that $K := \gen{y,z}_H$ is an abelian subgroup of $H$ with $\ord_H(y) = \ord_H(z) = 3$ and $|K| = 9$. 
	We will prove that $K$ has $\preceq_{\mathcal P_\fun(H)}$-minimal factorizations of more than one length, which is a contradiction and finishes the proof.
	
	Indeed, we are guaranteed by Theorem \ref{BmF-char} that $\mathfrak c := \{1_H,y\}^{\ast 2} \ast \{1_H,z\}^{\ast 2}$ is a length-$4$ factorization of $K$ in $\P_\fun(H)$; and it is actually a minimal factorization, because removing one or more atoms from $\mathfrak c$ yields an $\mathscr A(\mathcal P_\fun(H))$-word whose image under $\pi_{\mathcal P_\fun(H)}$ has cardinality at most $8$ (whereas we have already noted that $|K| = 9$).
	On the other hand, it is not difficult to check that $A := \{1_H, y, z\}$ is an atom of $\mathcal P_\fun(H)$: If $\{1_H, y, z\} = YZ$ for some $Y, Z \in \mathcal P_\fun(H)$ with $|Y|, |Z| \ge 2$, then $Y, Z \subseteq \{1_H, y, z\}$ and $Y \cap Z = \{1_H\}$, whence $YZ = \{1_H, y\}\cdot\{1_H, z\} = K \ne A$. This in turn implies that $A^{\ast 2}$ is a length-$2$ factorization of $K$ in $\P_\fun(H)$, and it is minimal by Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}.
	So, we are done.
\end{proof}

\begin{cor}\label{cor:when-reduced-pm-is-minimally-factorial}
	Let $H$ be a monoid. Then $\mathcal P_\fun(H)$ is minimally factorial if and only if $H$ is trivial.
\end{cor}

\begin{proof}
	The ``if'' part is obvious. For the other direction, assume by way of contradiction that $\mathcal P_\fun(H)$ is minimally factorial but $H$ is non-trivial. Then $\mathcal P_\fun(H)$ is HmF, and we obtain from Theorem \ref{prop:HF-exp-3} that $H$ is a cyclic group of order $3$. Accordingly, let $x$ be a generator of $H$. By Lemma \ref{lem:2-elt-atoms}\ref{it:lem:2-elt-atoms(i)} and Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, $\mathfrak a := \{1_H, x\}^{\ast 2}$ and $\mathfrak b := \{1_H, x^2\}^{\ast 2}$ are both minimal factorizations of $H$ in $\mathcal P_{\fin,1}(H)$. However, $(\mathfrak a, \mathfrak b) \notin \mathscr C_{\mathcal P_\fun}(H)$, because $\mathcal P_\fun(H)$ is a reduced monoid. Therefore, $\mathcal P_\fun(H)$ is not minimally factorial, so leading to a contradiction and completing the proof.
\end{proof}
%
At this point, we have completely characterized the correlation between the ground monoid $H$ and whether $\P_\fun(H)$ has factorization properties such as atomicity, BFness, etc., and their minimal counterparts.
In most cases, this extends to a characterization of whether the same properties hold for $\P_\funt(H)$, with the exception of the gap suggested by Theorem \ref{prop:HF-exp-3} and Corollary \ref{cor:when-reduced-pm-is-minimally-factorial}.
In particular, it still remains to determine the monoids $H$ which make $\P_\funt(H)$ HmF or minimally factorial.
However, what we have shown indicates, we believe, that the arithmetic of $\P_\fun(H)$ and $\P_\funt(H)$ is robust and ripe for more focused study.

\section{Cyclic monoids and interval length sets} \label{sec:finite-cyclic}
\label{sec:cyclic-case} 
For those monoids $H$ with $\P_\fun(H)$ atomic, we have by Proposition \ref{lem:no-non-id-elts-of-small-order-implies-structure} that the semigroup generated by an element $x\in H$ is isomorphic either to $\ZZ/n\ZZ$ or to $\NN$ under addition.
As such, we will concentrate throughout on factorizations in $\P_{\fin,0}(\mathbf{Z}/n\mathbf{Z})$ and also mention some results on $\P_{\fin,0}(\NN)$ which are discussed in detail in \cite[\S{ }4]{fan-tringali18}.
At the end we will return to the general case, where the preceding discussion will culminate in a realization result (Theorem \ref{th:interval-lengths}) for sets of minimal lengths of $\P_\fun(H)$.

We invite the reader to review \S{ }\ref{subsec:generalities} before reading further. Also, note that, through the whole section, we have replaced the notation $\P_\fun(H)$ with $\P_{\fin,0}(H)$ when $H$ is written additively (cf. Example \ref{exa:strict-inclusion}).


\begin{defn}\label{NR-factorization}
	Let $X \in \mathcal P_{\fin,0}(\ZZ/n\ZZ)$. We say that a non-empty factorization $\mathfrak a = A_1 \ast \cdots \ast A_\ell \in \mathcal{Z}(X)$ is a \textit{non-reducible factorization} (or, shortly, an \textit{\textup{NR}-factorization}) if $ \max\hat{A}_1 + \dots + \max\hat{A}_\ell = \max \hat{X}$.
	%has \textit{no reduction $\fixed[-0.5]{\text{ }}{}\bmod n$} if $ \max\hat{A}_1 + \dots + \max\hat{A}_\ell = \max \hat{X}$, in which case we refer to $\mathfrak{a}$ as a
\end{defn}

This condition on factorizations will allow us to bring calculations up to the integers, where sumsets are more easily understood.
More importantly, NR-factorizations are very immediately relevant to our investigation of minimal factorizations.

\begin{lemma}\label{NR-factorizations-are-minimal}
	Any \textup{NR}-factorization in $\P_{\fin,0}(\mathbf{Z}/n\mathbf{Z})$ is a minimal factorization.
\end{lemma}

\begin{proof}
	Let $\mathfrak{a} = A_1 \ast \cdots \ast A_\ell$ be an NR-factorization in $\mathcal P_{\fin,0}(\mathbf Z/n\mathbf Z)$ of length $\ell$, and assume for the sake of contradiction that $\mathfrak a$ is not minimal. Since
	$\P_{\fin,0}(\mathbf{Z}/n\mathbf{Z})$ is reduced and commutative, the factorizations which are $\mathscr C_{\P_{\fin,0}(\mathbf{Z}/n\mathbf{Z})}$-congruent to $\mathfrak{a}$ are exactly the words $A_{\sigma(1)} \ast \cdots \ast A_{\sigma(\ell)}$, where $\sigma$ is an arbitrary permutation of the interval $\llb 1, \ell \rrb$.
	So, on account of Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, the non-minimality of $\mathfrak{a}$ implies without loss of generality that $\ell \ge 3$ and $
	X := A_1 + \cdots + A_\ell = A_1 + \cdots + A_k$ for some $k \in \llb 1, \ell-1 \rrb$. 
	
	Now, let $x \in X$ such that $\hat{x} = \max \hat{X}$. Using that $\mathfrak a$ is an NR-factorization, and considering that, for each $i \in \llb 1, \ell \rrb$, $A_i$ is an atom of $\mathcal P_{\fin,0}(\mathbf Z/n\mathbf Z)$ and hence $\max \hat{A}_i \ge 1$, it follows from the above that
	\begin{equation}\label{equ:inequ-with-maxima}
	\hat{x} = \max\hat{A}_1+\max\hat{A}_2+\cdots+\max\hat{A}_\ell > \max\hat{A}_1 + \dots + \max\hat{A}_k,
	\end{equation}
	On the other hand, since $X = A_1 + \cdots + A_k$, there are $a_1 \in A_1,\dots, a_k \in A_k$ such that $a_1+\dots+ a_k = x$, from which we see that $\hat{x} \equiv \hat{a}_1 + \cdots + \hat{a}_k \bmod n$. But it follows from \eqref{equ:inequ-with-maxima} that
	$
	0 \le \hat{a}_1+\dots+ \hat{a}_k < \hat{x} < n$, and this implies $\hat{x} \not\equiv \hat{a}_1 + \cdots + \hat{a}_k \bmod n$ (recall that, by definition, $\hat{X} \subseteq \llb 0, n-1 \rrb$). So we got a contradiction, showing that $\mathfrak a$ was minimal and completing the proof.
\end{proof}


We are aiming to find, for every $k\in\llb 2, n-1\rrb$, a set $X_k\in\P_{\fin,0}(\ZZ/n\ZZ)$ for which $\mathsf{L}^\m(X_k) = \llb 2, k \rrb$, on the assumption that $n\ge 5$ is odd:
Surprisingly, most of the difficulty lies in showing that $2\in \mathsf{L}^\m(X_k)$.
To do this, we first need to produce some large atoms.

\begin{prop}\label{large-atom-construction}
	Let $n\ge 5$ be odd.
	Then the following sets are atoms of $\mathcal P_{\fin,0}(\mathbf Z/n\mathbf Z)$:
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:large-atom-construction(i)} $B_h := \bigl\{\overline{0}\} \cup \{\overline{1},\overline{3},\dots, \overline{h}\bigr\}$ for odd $h\in \llb 1,(n-1)/2 \rrb$.
		\item\label{it:large-atom-construction(ii)} $C_1 := \bigl\{\overline{0}, \overline{2}\bigr\}$, $C_3 := \bigl\{\overline{0},\overline{2},\overline{3},\overline{4}\bigr\}$, and $C_\ell := B_\ell\cup\bigl\{\overline{\ell+1}\bigr\}$ for odd $\ell\in \llb 5, (n-1)/2 \rrb$.
	\end{enumerate}
\end{prop}

\begin{proof}
	\ref{it:large-atom-construction(i)} Let $h \in \llb 1, (n-1)/2 \rrb$ be odd, and suppose that $B_h = X + Y$ for some $X,Y\in \mathcal P_{\fin,0}(\mathbf Z/n\mathbf Z)$.
	Then $X$ and $Y$ are subsets of $B_h$, so
	\[
	\max\hat{X} + \max\hat{Y} \le 2\max\hat{B}_h = 2h \le n-1.
	\]
	Because $\overline{1}\in B_h$, we must have $\overline{1}\in X\cup Y$.
	However, if $\overline{1}\in X$ and $a\in Y$ for some $a \in B_h\setminus\{\overline{0}\}$, then  $1+\hat{a} \in \hat{X} + \hat{Y}$ is even, which is impossible since $\max\hat{X} + \max\hat{Y} < n$ and $\hat{B}_h \setminus\{0\}$ consists only of odd numbers.
	Thus $Y = \{\overline{0}\}$, and hence $B_h$ is an atom.
	
	\ref{it:large-atom-construction(ii)}
	$C_1$ is an atom by Lemma \ref{lem:2-elt-atoms}\ref{it:lem:2-elt-atoms(i)} and it is not too difficult to see that so is $C_3$. Therefore, let $\ell\ge 5$ and suppose $C_\ell = X+Y$ for some $X,Y\in \mathcal P_{\fin,0}(\mathbf Z/n\mathbf Z)$ with $X,Y\neq\bigl\{\overline{0}\bigr\}$.
	
	First assume that $\overline{\ell+1}\notin X\cup Y$. Then $\hat{X}$ and $\hat{Y}$ consist only of odd integers, so $\hat{x}+\hat{y}$ is an even integer in the interval $\llb 2, n-1 \rrb$ for all $x\in X\setminus\bigl\{\overline{0}\bigr\}$ and $y\in Y\setminus\bigl\{\overline{0}\bigr\}$.
	However, $\hat{X}+\hat{Y} = \hat{C}_\ell$ and the only non-zero even element of $\hat{C}_\ell$ is $\ell+1$. Thus, it must be that $X = \bigl\{\overline{0},x\bigr\}$ and $Y = \bigl\{\overline{0},y\bigr\}$ for some non-zero $x, y \in \mathbf Z/n\mathbf Z$, with the result that $|X+Y| \le 4 < |C_\ell|$, a contradiction.
	
	It follows (without loss of generality) that $\overline{\ell+1}\in Y$.
	Then $X \subseteq \bigl\{\overline{0},\overline{\ell},\overline{\ell+1}\bigr\}$, for, if $x\in X$ with $0 < \hat{x} < \ell$, then $\hat{x} + \ell+1 \in \hat{C}_\ell$, which is impossible since $\hat{x}+\ell+1 \in \llb \max\hat{C}_\ell+1 , n-1 \rrb$.
	This in turn implies that $Y \subseteq \bigl\{\overline{0},\overline{1},\overline{\ell},\overline{\ell+1}\bigr\}$ for similar reasons. As a consequence,
	\[
	X+Y
	\subseteq \bigl\{\overline{0},\overline{\ell},\overline{\ell+1}\bigr\}
	+ \bigl\{\overline{0},\overline{1},\overline{\ell},\overline{\ell+1}\bigr\}
	= \bigl\{ \overline{0}, \overline{1}, \overline{\ell}, \overline{\ell+1}, \overline{2\ell},\overline{2\ell+1}, \overline{2\ell+2} \bigr\}
	\]
	However, $\ell+1 < 2\ell \le n-1$, so we cannot have $\overline{2\ell}\in X+Y$. Then $2\ell+1 = n$, in which case $\overline{2\ell+1} = \overline{0}$ and $\overline{2\ell+2} = \overline{1}$; or $2\ell+1 < n$, so that $\overline{2\ell+1}, \overline{2\ell+2} \notin C_h$ (recall that $\ell \le (n-1)/2$). In either case, we get $X+Y \subseteq \bigl\{ \overline{0}, \overline{1}, \overline{\ell}, \overline{\ell+1}\bigr\}$, hence $|X+Y| \le 4 < |C_\ell|$, which is a contradiction and leads us to conclude that $C_\ell$ is an atom.
\end{proof}

Now that we have found large atoms in $\P_{\fin,0}(\ZZ/n\ZZ)$, we can explicitly give, for each $k\in \llb 2,n-1\rrb$, an element $X_k\in \P_{\fin,0}(\ZZ/n\ZZ)$ which has a (minimal) factorization of length $2$.

\begin{lemma}\label{2-atom-factorization}
	Fix an odd integer $n\ge 5$ and let $k\in \llb 2, n-1 \rrb$.
	Then the set $X_k = \{\overline{0},\overline{1},\dots, \overline{k}\}$ has an \textup{NR}-factorization into two atoms in $\P_{\fin,0}(\mathbf{Z}/n\mathbf{Z})$.
\end{lemma}

\begin{proof}
	We will use the atoms $B_h$ and $C_\ell$ as defined in Proposition \ref{large-atom-construction}. We claim that, for every $r\in\{0,1\}$ and all odd $h\in \llb 1, (n-1)/2 \rrb$,
	%
	\[
	\hat{B}_{h+2r}+\hat{C}_h = \llb 0, 2h+2r+1 \rrb
	\quad\text{and}\quad
	\hat{C}_{h+2r} + \hat{C}_{h} = \llb 0, 2r+2h+2\rrb.
	\]
	We will only demonstrate that $\hat{B}_h + \hat{C}_h = \llb 0, 2h+1 \rrb$ (the other cases are an easy consequence).
	The claim is trivial if $h=1$ or $h=3$, so suppose $h \ge 5$.
	Then
	\[
	\hat{B}_h + \hat{C}_h \supseteq \{1,3,\dots,h\} + \{0, h+1\} = \{1,3,\dots, 2h+1\}
	\]
	and
	\[
	\hat{B}_h + \hat{C}_h \supseteq \{1,3,\dots,h\} + \{1, h\} = \{2,4,\dots, 2h\},
	\]
	so $\hat{B}_h +\hat{C}_h \supseteq \llb 0 , 2h+1 \rrb$.
	This gives that $\hat{B}_h +\hat{C}_h = \llb 0 , 2h+1 \rrb$, since $\max\hat{B}_h+\max\hat{C}_h = h+(h+1)$.
	
	Accordingly, we now prove that $X_k$ can be expressed as a two-term sum involving $B_h$ and $C_\ell$, for some suitable choices of $h$ and $\ell$ depending on the parity of $k$.
	\begin{enumerate}[leftmargin=1.8cm,label={\textsc{Case }\arabic{*}:}]
		\item $k = 2m+1$ (i.e., $k$ is odd). Then it is immediate to verify that $X_k = B_m+C_m$ if $m$ is odd, and $X_k = B_{m+1} +C_{m-1}$ if $m$ is even.
		\item $k = 2m$ (i.e., $k$ is even). Since $X_2 = B_1+B_1$ and $X_4 = B_1+B_3$, we may assume $m\ge3$. Then it is seen that $X_k = C_{m} + C_{m-2}$ if $m$ is odd, and $X_k = C_{m-1}+C_{m-1}$ if $m$ is even.
	\end{enumerate}
	We are left to show that the decompositions given above do in fact correspond to minimal factorizations. As an example, consider the case when $k=2m+1$ and $m$ is odd (the computation will be essentially identical in the other cases).
	Then $\max\hat{B}_{m}+\max\hat{C}_m = 2m+1$, so that $B_m \ast C_m$ is an NR-factorization of $X_k$, and is hence minimal by Proposition \ref{NR-factorizations-are-minimal}.
\end{proof}



\begin{lemma}\label{lem:interval-minimal-length-sets}
	Fix an odd integer $n\ge 3$ and, for each $k\in \llb2,n-1\rrb$, let $X_k := \{\overline{0},\overline{1}, \dots, \overline{k} \} \in  \P_{\fin,0}(\mathbf{Z}/n\mathbf{Z})$.
	Then $\mathsf{L}^\m(X_k) = \llb 2,k \rrb$.
\end{lemma}

\begin{proof}
	We have already established in Lemma \ref{2-atom-factorization} that $X_2$ has an NR-factorization of length $2$.
	Now fix $k \in \llb 3, n-1 \rrb$ and suppose that, for all $h \in \llb 2, k-1 \rrb$ and $\ell \in \llb 2,h \rrb$, $X_h$ has an NR-factorization of length $\ell$.
	Choose some $\ell \in \llb 2,k-1 \rrb$; $X_{k-1}$ has an NR-factorization $\mathfrak{a}$, and it is straightforward to see that $\{\overline{0},\overline{1}\}*\mathfrak{a}$ is an NR-factorization of $X_k$.
	Letting $\ell$ range over $\llb 2,k-1\rrb$, this argument, Lemma \ref{NR-factorizations-are-minimal}, and Lemma \ref{2-atom-factorization} imply that $\mathsf{L}^\m(X_k) \supseteq \llb 2, k \rrb$.
	Moreover, Proposition \ref{prop:bounded-minimal-fzn}\ref{it:prop:bounded-minimal-fzn(i)} yields the other inclusion and so we have  $\mathsf{L}^\m(X_k) = \llb 2,k \rrb$.
\end{proof}


\begin{lemma}\label{prop:intervals-in-N}
	Let $H$ be a non-torsion monoid.
	Then $\mathscr{L}(\P_{\fin,0}(\NN)) \subseteq \mathscr{L}^\m(\P_\fun(H))$, and for every $k\ge 2$ there exists $Y_k\in \P_\fun(H)$ with $\mathsf{L}^\m(Y_k) = \llb 2, k \rrb$.
\end{lemma}

\begin{proof}
	Suppose that $y\in H$ has infinite order, and set $Y := \{y^k: k \in \mathbf N\}$. Clearly, $Y$ is a submonoid of $H$, and the (monoid) homomorphism $(\NN,+) \to Y: k \mapsto y^k$ determined by sending $1$ to $y$ induces an iso\-morphism $\P_{\fin,0}(\NN) \to \P_\fun(Y)$.
	Since, by Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(iii)}, $\P_\fun(Y)$ is a divisor-closed submonoid of $\P_\fun(H)$, we thus have by parts \ref{it:prop:min-basics(iii)} and \ref{it:prop:min-basics(iv)} of Proposition \ref{prop:min-basics} that
	\[
	\mathscr{L}(\P_{\fin,0}(\NN)) = \mathscr{L}^\m(\P_{\fin,0}(\NN)) = \mathscr{L}^\m(\P_\fun(Y)) \subseteq \mathscr{L}^\m(\P_\fun(H)).
	\]
	The rest of the statement now follows from the above and \cite[Proposition 4.8]{fan-tringali18}.
\end{proof}




\begin{thm}\label{th:interval-lengths}
	Assume $H$ is a monoid such that $1_H \neq x^2 \neq x$ for all $x\in H\setminus\{1_H\}$, and set $N := \sup\{\ord_H(x) : x\in H \}$.
	Then $\llb 2, k \rrb \in \mathscr{L}^\m(\P_\fun(H))$ for every $k \in \llb 2, N-1 \rrb$.
\end{thm}

\begin{proof}
	If $H$ is non-torsion, this follows immediately from Lemma \ref{prop:intervals-in-N}.
	Otherwise, let $k\in \llb 2, N-1 \rrb$ and $y\in H$ with $n := \ord_H(x) > k$.
	Then $Y :=\gen{y}_H \cong \ZZ/n\ZZ$, so we have by Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(iii)}, Lemma \ref{lem:interval-minimal-length-sets}, and Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(iii)} that
	$\llb 2, k \rrb \in \mathscr{L}^\m(\P_\fun(Y)) \subseteq \mathscr{L}^\m(\P_\fun(H))$.
\end{proof}


%%%%%%
%%%%%%

%%%%%%
%%%%%%

%%%%%%
%%%%%%
\chapter{Partition Type of Factorizations in the Natural Power Monoid} \label{ch:partitions}
\section{Bad Partition Types for Intervals} \label{sec:partitions}
%%%%%%
%%%%%%


%One can see that the intervals $\llb 0,n \rrb$ have overwhelmingly many factorizations in $\P_{\fin,0}(\NN)$.
%Any subset of $\NN$ can be obtained by removing points from such an interval, and we know that arbitrary subsets may exhibit all sorts of factorization behavior.  
%As such, it may be interesting to try and observe gradual changes in this behavior as we remove points from $\llb 0,n \rrb$.
%At the opposite extreme of the extremely flexible factorization behavior of $\llb 0,n \rrb$, we have the subsets with the most behavior: the atoms.
%We would like to determine whether there is a distinct threshold for the number of points we are required to remove from $\llb 0,n \rrb$ to obtain an atom.

The length set realization Theorems \ref{thm:ind-atoms} and \ref{thm:2n-length-set} show that some subsets of $\NN$ have very well-controlled sets of factorization.
On the other hand, there are subsets with comparatively ``wild" set of factorizations; the intervals $\llb 0,n \rrb$ are a simple class examples which demonstrate this since, for instance, we have $\mathsf{L}(\llb0,n\rrb) = \llb 2,n \rrb$ \cite[Proposition 4.8]{fan-tringali18}.
However, observe that any subset $X$ can be obtained by deleting points from the interval $\llb 0,\max(X) \rrb$.
If $X$ has relatively tame factorization behavior and we imagine this process of deleting points from $\llb 0,\max(X)\rrb$, then the subsets between the full interval and $X$ experience a transition between ``wild" and ``tame" factorization behavior.
In what follows, we seek to more rigorously quantify what is meant by ``wild" factorization behavior and to investigate the nature of this transition.

Since we will be thinking of elements of $\PN$ as subsets of the intervals $\llb 0,n \rrb$, it will be convenient to have some notation to help us filter $\NN$.


\begin{defn} \label{def:filtration}
	For $n\ge 0$, we distinguish the following collections of subsets:
	\begin{align*}
	\P_n &= \{ X \subseteq \llb 0,n \rrb : 0,n\in X \} \\
	\mathcal{A}_n &= \mathcal{A}(\PN) \cap \P_n  \\
	\mathcal{N}_n &= \P_n \setminus \mathcal{A}_n 
	\end{align*}
	%Here we are just filtering the subsets, atoms, and non-atoms (respectively) in accordance with the intuitive grading on subsets of $\NN$.
\end{defn}


%\begin{defn}
%Define a function $z:\NN \to \NN$ by
%\[ z(n) := \Z_{\P_{\fin,0}(\NN)}(\llb 0,n \rrb) \]
%\end{defn}
%This function measures the number of factorizations of an interval into atoms of $\P_{\fin,0}(\NN)$.
%Our goal in the coming pages will be to describe the behavior (especially growth) of this function. 
%In so doing, we should glean some insight into the most flexibly factorable elements of the natural power monoid.

In any monoid, we can distinguish different factorizations of an element $x$ by their lengths; that is, we know that if $\aa,\bb\in \Z(x)$ with $|\aa| \neq |\bb|$, then $\aa$ and $\bb$ are not equivalent.
In $\PN$, we have some additional leverage which comes from integer partitions; we make some definitions to facilitate this leverage now.

\begin{defn}
	Let $n\ge 1$. A \textit{partition of $n$} is $P = (m_1,\dots, m_k)$, where $m_1 \ge \dots \ge m_k \ge 1$ and $m_1+\cdots + m_k = n$. 
	Each $m_i$ is said to be a \textit{part} of $P$, and $k$ is said to be the \textit{length} or number of parts of $P$.
	For brevity, we occasionally write $P \vdash n$.
	
	For $X \in \PN$ and for any partition $P = (m_1,\dots, m_k)$ of $\max(X)$, we define the \textbf{set of factorizations of $X$ of (partition) type $P$} to be
	\[ \Z^P(X) := \{ A_1*\cdots * A_k \in \Z(X) : A_i \in \mathcal{A}_{m_i} \textrm{ for } i\in \llb 1,k \rrb \}. \]
	We also define the \textbf{set of (partition) types of $X$} to be
	\[ \mathsf{T}(X) :=  \{ P \vdash \max(X) : \Z^P(X) \neq \emptyset \}. \]
\end{defn}

\begin{rk}
	There are some elementary observations to be made which connect factorization behavior with partition type.
	Say $X \in \PN$ with $n = \max(X)$.
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item $\Z(X) = \bigsqcup_{P} \Z^P(X)$, a disjoint union taken over all partitions $P$ of $n$.
		\item $\Z^{(n)}(X) = \emptyset$ if and only if $X$ is not an atom.
	\end{enumerate}
	Though the disjoint union in (i) is not too hard to see, it is not clear that each $\Z^P(X)$ is nonempty.
	In fact, we will soon see evidence to the contrary.
\end{rk}


%Here, we have demonstrated that each $\Z^P(\llb 0,n \rrb)$ is nonempty when $\min(P) = 1$.  
%However, as with other aspects of the set of factorizations of $\llb 0,n \rrb$, we hope this indicates that intervals have \textit{many} factorizations of each such type $P$.
%On the other hand, some types can never admit factorizations; we shall see some examples of this soon.

\begin{prop} \label{prop:2-elt factor/cofactor}
	Let $X\in \PN$.
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item Let $n = \max(X) + b$. $X + \{0,b\} = \llb 0,n \rrb$ if and only if $X \cap \{k,k-b\} \neq \emptyset$ for every $k\in \llb 0,n \rrb$.
		\item For any $c\ge 1$, $X + \{0,2c\} = \llb 0,\max(X)+2c \rrb$ implies that $\{0,c\}$ divides $X$.
	\end{enumerate}
\end{prop}

\begin{proof}
	For (i), we first prove the ``only if" direction.  
	Suppose $k\in \llb 0,n \rrb$; then $k\in X + \{0,b\}$.
	We must have that $k\in X + 0$ or that $k \in X + b$, which is the same as saying $k\in X$ or $k-b\in X$.
	
	Conversely, suppose that $k\in \llb 0,n \rrb$.
	If $k\in X \subseteq X + \{0,b\}$, we are done.
	If $k\notin X$, then we have by assumption that $k-b\in X$, meaning $k\in X +b \subseteq X+ \{0,b\}$.
	We conclude that $X + \{0,b\} \supseteq \llb 0,n \rrb$, and the other inclusion is clear since $\max(X+\{0,b\}) = \max(X) + b = n$.
	
	For (ii), we use Proposition \ref{prop:cofactors}.
	Let $Y = X\:\{0,c\} = X\cap (X-c)$; we know that $\{0,c\} + Y \subseteq X$, so we just need to show the other inclusion.
	Suppose $X \supsetneqq \{0,c\} + Y$; then there is $x\in X$ with $x\notin \{0,c\} + Y$.
	This means that $x\notin X \cap (X-c)$ and $x \notin X \cap (X-c)$; all together, this means $x+c,x-c\notin X$.
	However, this contradicts part (i), taking $b = 2c$ and $k = x+c$.
	Thus we must have $X = \{0,c\} + X\:\{0,c\}$.
\end{proof}

\begin{prop} \label{prop:bad types}
	Let $n\ge 1$.
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item For $n\ge 4$, $\Z^{(n-2,2)}(\llb 0,n \rrb) = \emptyset$.
		\item For even $n\ge 4$, $\Z^{(2,\dots,2)}(\llb 0,n \rrb) = \emptyset$.
		\item For odd $n\ge 5$, $\Z^{(3,2,\dots, 2)}(\llb 0,n \rrb) = \emptyset$.
		\item For even $n\ge 6$, $\Z^{(4,2,\dots, 2)}(\llb 0,n \rrb) = \emptyset$.
		\item For odd $n\ge 7$, $\Z^{(5,2,\dots, 2)}(\llb 0,n \rrb) = \emptyset$.
	\end{enumerate}
\end{prop}
\begin{proof}
	For (i), we can use the second part of Lemma \ref{prop:2-elt factor/cofactor} with $c = 1$ to see that there can be no atom $A$ with $A+\{0,2\} = \llb 0,n \rrb$.
	
	It is easy to see (ii) because $\{0,2\}$ is the only atom in $\mathcal{A}_2$, and no sum of the form $\{0,2\} +\dots +\{0,2\}$ can contain $1$, let alone a whole interval.
	
	For (iii), write $n = 2m+1$.
	We note that $\mathcal{A}_3 = \{\{0,2,3\}, \{0,1,3\} \}$.
	Since $1$ belongs to the interval, if $\llb 0,2m+1 \rrb$ is to have a factorization of partition type $(3,2,\dots,2)$, then that factorization must include $\{0,1,3\}$.
	However, we see that 
	\[ \{0,1,3\} + (m-1)\{0,2\}  = \{0,1,3\} + \{0,2,\dots, 2m-2\} = \llb 0, 2m-1 \rrb \cup \{2m+1\} \]
	which does not contain $2m = n-1$, so $\llb 0,2m+1\rrb$ cannot have a factorization of type $(3,2,\dots,2)$.
	
	The arguments for the remaining parts proceed along similar lines.
	For (iv), we note that the only atoms in $\mathcal{A}_4$ which contain $1$ are $\{0,1,4\}$ and $\{0,1,2,4\}$.
	However, if $n = 2m$, we have
	\[ \{0,1,2,4\} + (m-2)\{0,2\} = \{0,1,4\} + \{0,2,\dots, 2m-4\} = \llb 0, 2m-2 \rrb \cup \{2m\} \]
	which again fails to contain $n-1$.
	
	Finally, we turn to (v).
	We similarly begin by observing that the only atoms in $\mathcal{A}_5$ which contain $1$ are $\{0,1,5\}$, $\{0,1,2,5\}$, and $\{0,1,3,5\}$.
	Let $n = 2m+1$.
	By calculations similar to those above, one can see that $n-2 \notin \{0,1,2,5\} +(m-2)\{0,2\}$ and $n-1\notin \{0,1,3,5\} + (m-2)\{0,2\}$.
\end{proof}

%%%%%%
%%%%%%
\section{Good Partition Types for Intervals}
%%%%%%
%%%%%%

As we have just seen above, several partition types fail to appear because of the limited number of atoms available in $\mathcal{A}_N$ for small $N$.
Even in $\mathcal{A}_5$, where there are a few choices of atoms containing $1$, there is no atom which contains both $1$ as well as enough ``comparably larger'' elements closer to $5$.
However, this issue does not seem to arise for atoms with larger maximum; indeed, in $\mathcal{A}_7$ we have several choices which fit this requirement: for example, $\{0, 1, 2, 4, 6, 7\}$, and $\{0, 1, 3, 5, 6, 7\}$ seem promising if one hopes to produce factorizations of type $(7,2,\dots, 2)$. 
Indeed, the problems that occur for atoms of sizes between $2$ and $5$ do not persist, for we have the following.

Our goal now will be to verify that intervals have factorizations of various partition types.  
To aid in this, we will need a few classes of specifically structured ``large atoms" to populate the sets $\mathcal{A}_N$.

\begin{prop} \label{prop:2-congruence atoms}
	Each of the following sets is an atom of $\PN$ for the given values of the parameter $h$.
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item $B_{2h-1} := \{0,1,3,\dots, 2h-1\}$ for $h\ge 1$.
		\item $B_{2h} := \{0,1,3,\dots, 2h-1,2h\}$ for $h \ge 3$.
		\item $C_{2h} := \{0,2,4,\dots,2h\}\cup\{1\}$ for $h\ge 2$.
		\item $C_{2h+1} := \{0,2,4,\dots, 2h\}\cup\{1,2h+1\}$ for $h\ge 3$.
	\end{enumerate}
\end{prop}

\begin{proof}
	Beginning with (i), we suppose that there are $X,Y\in \PN$ so that $B_{2h-1} = X + Y$.
	Without loss of generality, $1\in X$.
	Then $Y\subseteq B_{2h-1}$ cannot contain any nonzero elements; if $y\in Y\setminus\{0\}$ then $1+y\in B_{2h-1}$ is even, a contradiction.
	Thus $Y = \{0\}$ and $B_{2h-1}$ is an atom.
	
	For (ii), we start similarly by assuming that $B_{2h} = X + Y$ and that $1\in X$.
	If $y\in Y \setminus\{0\}$, then $1+y\in B_{2h}$ is even, meaning that $y = 2h-1$.
	We now have that $Y = \{0\}$ or $Y = \{0,2h-1\}$.
	In the first case, we are done; but we are nearly done in the second case as well.  
	Since $\max(X) + \max(Y) = 2h$, it must be that $X = \{0,1\}$, so $B_{2h} = X+Y = \{0,1\} + \{0,2h-1\} = \{0,1,2h-1,2h\}$.
	However, this is impossible since we have assumed that $h\ge 3$.
	
	Turning to (iii), suppose that $C_{2h} = X + Y$ and that $1\in X$.
	We know that if $Y$ has a nonzero even element then $C_{2h} = X + Y$ contains the odd element $y+1 > 1$.
	Thus $Y \subseteq \{0,1\}$; but then $C_{2h} \subseteq \{0,1\} + \{0,1\} = \{0,1,2\}$, which is incompatible with the assumption that $h\ge 2$.
	
	Finally, for (iv), let $X$ and $Y$ be subsets such that $C_{2h+1} = X + Y$, and say $1\in X$.
	Similarly to (iii), we see that $Y$ can have no nonzero even elements $y$ \textit{unless} $y=2h$.
	This means that the only possibilities are $Y = \{0\}$ (in which case we are done), $Y = \{0,1\}$, or $\max(Y) = 2h$.
	These last two cases are symmetric, so suppose $\max(Y) = 2h$.
	Then $X = \{0,1\}$ and $Y \subseteq \{0,1,2h\}$, so $C_{2h+1} \subseteq \{0,1\} + \{0,1,2h\} = \{0,1,2,2h,2h+1\}$.
	This last inequality is seen to be infeasible by recalling that $h\ge 3$.
\end{proof}

We will see that the above constructions are helpful because sums of small numbers of these atoms will be able to form relatively large intervals.

\begin{lemma} \label{lem:two-part types}
	If $q\ge r \ge 3$ then $\llb 0, q+r \rrb \in \A_q + \A_r$; that is, there are atoms $A_q\in \A_q$ and $A'_r\in \A_r$ such that $A_q + A'_r = \llb 0,q+r \rrb$.
\end{lemma}

\begin{proof}
	There are several cases to consider; roughly, these amount to when both, one of, or none of $q$ and $r$ is large.
	
	\underline{Case 1}: $q,r \ge 6$. 
	
	\underline{Subcase 1.a}: $q = 2s$ and $r = 2t+1$.
	Then 
	\begin{align*}
	B_{2s} + C_{2t+1} 
	&\supseteq \{0,1\}\cup\{2s-1,2s\} + \{0,1,2,4,\dots, ,2t,2t+1\} \\
	&= \llb 0, 2t+2 \rrb \cup \llb 2s-1,2s+2t+1 \rrb
	\end{align*}
	and, switching the roles of $s$ and $t$ in the calculation we just saw, we also have 
	\[B_{2s}+C_{2t+1} \supseteq \llb 0,2s+1 \rrb \cup \llb 2t,2s+2t+1 \rrb.\]
	Thus we conclude that $\llb 0,2s+2t+1 \rrb \subseteq B_{2s}+C_{2t+1} \subseteq \llb 0,2s+2t+1 \rrb$ and so $B_r + C_q = \llb 0,q+r \rrb$.
	
	\underline{Subcase 1.b}: $q = 2s+1$ and $r = 2t$.
	Because the above computation does not depend on which of $q$ and $r$ is smaller, we may recycle that argument to see that $C_q + B_r = \llb 0,q+r \rrb$.
	
	\underline{Subcase 1.c}: $q = 2s+1$ and $r = 2t+1$.\\
	One can show that $C_q + C_r = \llb 0,q+r \rrb$ by a calculation similar to the one above.
	
	\underline{Subcase 1.d}: $q = 2s$ and $r = 2t+1$. \\
	Again, similar methods will tell us that $B_q + C_r = \llb 0,q+r \rrb$.
	
	\underline{Case 2}: $3 \le r \le 5 < q$.\\
	There are only a few possibilities here.
	Let $A_3 = \{0,1,3\}$, $A_4 = \{0,2,3,4\}$, and $A_5 = \{0,2,4,5\}$; then we can see that $B_q +A_r = \llb 0,q+r \rrb$ when $q$ is even and $C_q + A_r = \llb 0,q+r \rrb$ when $q$ is odd.
	
	\underline{Case 3}: $3\le r\le q \le 5$.\\
	This leaves only a handful of $(q,r)$ pairs to check; namely $(3,3)$, $(4,3)$, $(5,3)$, $(4,4)$, $(5,4)$, and $(5,5)$.
	By judicious choice of atoms like $A_3$, $A_4$, and $A_5$ in the previous case, the result can be realized for each of these pairs.
\end{proof}

\begin{prop} \label{prop:3-congruence atoms}
	For $h\ge 2$, each of the following subsets of $\NN$ is an atom in $\PN$:
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item $D_{3h} := \{0,3,6,\dots, 3h\} \cup \{ 1, 3h-1 \}$.
		\item $D_{3h+1} := \{0,3,6,\dots, 3h\} \cup \{ 1, 3h+1 \}$.
		\item $D_{3h+1} := \{0,3,6,\dots, 3h\} \cup \{ 1, 3h+1, 3h+2 \}$.
	\end{enumerate}
\end{prop}

\begin{proof}
	The arguments for each are similar, but (i) and (ii) are comparatively easier than (iii), so we will just prove (iii).
	Suppose that there are $X$ and $Y$ so that $D_{3h+2} = X + Y$.
	We may freely suppose that $1\in X$ this implies that $Y \subseteq \{0,3h,3h+1\}$.
	We cannot have $\max(Y) = 3h$, for then $\max(X) = 3h+2 - \max(Y) = 2$.
	This is impossible since $2\notin D_{3h+2}$.
	
	If $\max(Y) = 3h+1$ then $X = \{0,1\}$, so $D_{3h+2} \subseteq \{0,1\} + \{0,3h,3h+1\} = \{0,1,3h,3h+1,3h+2\}$.
	However, this cannot be the case since $3,6\in D_{3h+2}$.
	The only remaining possibility is that $Y = \{0\}$, which implies that $D_{3h+2}$ is an atom, as we wished.
\end{proof}

These atoms will help us obtain more decompositions of intervals, with the following rough justification: we know that $3\NN + 2\NN = \NN \setminus\{1\}$. 
We hope to mimic this for finite subsets by adding a truncated (and slightly modified) copy of $3\NN$ to a truncated copy of $2\NN$.
To make this precise, we have the following lemma.

\begin{lemma} \label{lemma:many 2s types}
	For $q \ge 6$ and $t\ge 2$, there is an atom $A\in \A_q$ with $A + t\{0,2\} = \llb 0, q+2t \rrb$.
\end{lemma}

\begin{proof}
	This essentially depends on the congruence class of $q$ modulo $6$.
	In the spirit of the argument from the preceding proposition, we demonstrate the result for the most representatively difficult of these cases.
	
	Suppose $q \equiv 0 \mod 6$, so $q = 3h$ for some even $h$.
	We first note that
	\begin{align*}
	D_{3h} + t\{0,2\} 
	&\supseteq \{0,6,\dots, 3h\} + \{0,2,4,\dots, 2t\} \\
	& = \{0,2,4,\dots, 3h+2t \}
	\end{align*}
	and similarly that
	\begin{align*}
	D_{3h} + t\{0,2\}
	&\supseteq \{3,9,\dots, 3(h-1) \}\cup\{1,3h-1\} + \{0,2,4,\dots, 2t \} \\
	&= \{3,5,\dots, 3h-3 + 2t \}\cup \{1,3h-1 + 2t \} \\
	&= \{1,3,5,\dots, 3h+2t-1 \}
	\end{align*}
	Putting these together, we see that $D_{3h} + t\{0,2\} = \llb 0,3h+2t \rrb$.
\end{proof}

\begin{rk}
	The most important details that make this argument work are
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item $1,q-1\in D_q$
		\item $\{0,2,4\} \subseteq t\{0,2\}$
	\end{enumerate}
	Point (i) enables us to ``perturb" $t\{0,2\}$ in a way which ensures that the points near the ends of the desired interval are included.
	Point (ii) is significant because it allows us to include the middle portion of the interval by covering it with ``patches" of length $6$.
	This is also a comforting constraint in light of Proposition \ref{prop:bad types}, which says that $D_q + \{0,2\}$ cannot be an interval since $D_q$ is an atom.
\end{rk}


\begin{thm} \label{thm:good types}
	Let $n\ge 1$ and suppose $P$ is a partition of $n$ with $P \notin \{(n-2,2)\} \cup \{ (m,2\dots,2) : 2\le m \le 5\}$.
	Then $\Z^P(\llb 0,n \rrb) \neq \emptyset$.
	In particular, $|\mathsf{T}(\llb 0,n \rrb)| = p(n)-4$, where $p(n)$ is the number of integer partitions of $n$.
\end{thm}

\begin{proof}
	It is helpful to first classify the ways in which $P$ can avoid being a partition not of the types prescribed above.  
	We have several possibilities.
	
	
	\underline{Case 1}: $P = (q,2,\dots, 2)$ with $m\ge 6$.
	
	Here, Lemma \ref{lemma:many 2s types} implies that $\Z^P(\llb 0,n \rrb) \neq \emptyset$.
	
	\underline{Case 2}: $P$ has two parts, both of which are larger than $2$.
	
	The content of Lemma \ref{lem:two-part types} is exactly that $\Z^P(\llb 0,n \rrb) \neq \emptyset$ for any such partition.
	
	\underline{Case 3}: $P = (m_1,\dots, m_k)$ with $k\ge 3$ and $m_1\ge m_2 \ge 3$.
	
	To resolve this possibility, we proceed by induction.
	The constraints on $P$ imply that $n\ge 8$.  
	Enumerating the factorizations of $\llb 0,8 \rrb$ by hand (or, preferably, by computer) is not prohibitively difficult and indeed confirms that $\llb 0,8 \rrb$ has factorizations of every type other than those excluded in the statement of the theorem.
	
	Suppose now that $n > 8$ and, for $8\le m < n$, $\llb 0,m \rrb$ has factorizations of each type fitting the description in (iii).
	Consider $P' = (m_1,\dots, m_{k-1})$.
	If $k=3$ then $P'=(m_1,m_2)$ is a partition of $n-m_k$ as described in case 2, and if $k>3$ then $P'$ is as in case 3.  
	In any event, either by the result from case 2 or by our inductive assumption, we know that $\Z^{P'}(\llb 0,n-m_k \rrb) \neq \emptyset$.
	Taking $\aa' \in \Z^{P'}(\llb 0,n-m_k \rrb)$, we have that $\aa := \aa' * \{0,m_k\} \in \Z^P(\llb 0,n \rrb)$.
	
	\underline{Case 4}: $P$ has smallest part equal to $1$.
	
	Finally, we have the partitions described in (iv): those with smallest part equal to 1.
	The result is reasonable to check by hand for $n=1,2,3$.
	We proceed by induction on $n$, assuming that $n>3$ and that the proposition is true for $m<n$.
	Let us write $P = (m_1,\dots, m_k, 1)$.
	
	If $k=1$, we can see that $C_{n-1}*\{0,1\}\in \Z^P(\llb 0,n \rrb)$, where $C_{n-1}$ is one of the atoms constructed in Proposition \ref{prop:2-congruence atoms}.
	Similarly, if $k=2$ we have by Lemma \ref{lem:two-part types} that there are atoms $A\in \A_{m_1}$ and $A'\in \A_{m_2}$ with $A+A' = \llb 0,m_1+m_2 \rrb$, so $A*A'* \{0,1\}\in \Z^P(\llb 0,n \rrb)$.
	
	Now assume that $k>2$ and write $P' = (m_1,\dots, m_k)$.
	If $m_k=1$, then there is some $\aa'\in \Z^{P'}(\llb 0,n-1 \rrb)$ by induction, so that $\aa = \aa' * \{0,1\}\in \Z^P(\llb 0,n \rrb)$.
	However, if $m_k > 1$, set $Q = (m_1,\dots, m_{k-1}, 1)$ (a partition of $n-m_k$).
	Again, we have by induction that there is some $\bb \in \Z^Q(\llb 0, n-m_k \rrb)$.
	Since $k>2$ and $m_k \le m_i$ for all $i\ge 1$, we also have that $m_k < n/2$ and so $n-m_k > m_k$.
	This allows us to conclude that $\aa = \bb * \{0,m_k\} \in \Z^P(\llb 0,n \rrb)$, proving what we wished.
\end{proof}

\section{Partition Subsums and Near Intervals}
We have just seen that intervals of the form $\llb 0,n \rrb$ have factorizations of most partition types.
There is a very sharp dichotomy between the wildly varied factorization behavior of intervals and that of any other subset of $\NN$, which we will see presently.  

\begin{defn}
	Let $m_1,\dots, m_k$ be integers.
	We will refer to $S = (m_1,\dots, m_k)$ as a \textit{sequence} of integers.
	Define the \textbf{set of subsums of S} to be $\Sigma(S) := \left\{ \sum_{i\in I} m_i : I\subseteq \llb 1,k \rrb \right\}$.
\end{defn}

\begin{rk}
	The notion of ``set of subsums" of a sequence can be compared with the similar notion which appears in much of the literature on zero-sum problems in finite abelian groups \textcolor{red}{[CITE SOME PAPERS]}.  
	Ours is nearly identical, except for its inclusion of the empty sum.
	Since we are not focused on the appearance of zero sums, including the empty sum does not put us at any disadvantage in our setting.
	To the contrary, it is convenient for us as it allows us to express the set of subsums of $S = (m_1,\dots, m_k)$ as a sum in $\P_\fon(\ZZ)$: $\Sigma(S)  = \{0,m_1\} + \cdots +\{0,m_k\}$.
\end{rk}

\begin{lemma} \label{lem:long-partitions}
	Let $m_1,\dots, m_k$ be positive integers with $m_1\ge \cdots \ge m_k \ge 1$ and let $n = m_1 + \cdots + m_k$.
	If $k> n/2$ then $\Sigma(m_1,\dots, m_k) = \llb 0,n \rrb$.
\end{lemma}

\begin{proof}
	To prove this, we will induct on $k$; if $k=1 > n/2$, then $n \le 1$ and the result is trivial.
	Now suppose $k > 1$ and that, for any sequence $T$ consisting of $\ell < k$ terms satisfying $\ell > \max(\Sigma(T))/2$, $\Sigma(T) = \llb 0, \max(\Sigma(T)) \rrb$.
	
	First observe that the maximum term of $S$ is at least the average of the terms of $S$; that is, $m_1 \ge \frac{n}{k}$.
	From here, we have
	\[ \frac{m_2+\cdots + m_k}{k-1} = \frac{n-m_1}{k-1} \le \frac{n-n/k}{k-1} = \frac{n}{k} < 2 \]
	Thus $k - 1 > \frac{m_2+\cdots+m_k}{2}$ and we can apply the inductive hypothesis to $T := (m_2,\dots, m_k)$.
	Now we have $\Sigma(T) = \llb 0, n-m_1 \rrb$, so $\Sigma(S) = \{0,m_1\} + \llb 0,n-m_1 \rrb = \llb 0,n-m_1 \rrb \cup \llb m_1,n \rrb$.
	This union of intervals is equal to $\llb 0,n \rrb$ if $m_1 \le m_2 + \cdots + m_k +1$, so all that remains is to verify this last inequality.
	
	From our assumption that $k > n/2$, we have $k-1 \ge (n-1)/2$, so 
	\[m_2 + \cdots + m_k \ge 1 +\cdots + 1 = k-1 \ge \frac{n-1}{2}.\]
	Using this inequality twice, we have that
	\[m_1 = n - (m_2 + \cdots + m_k) \le n - \frac{n-1}{2} = \frac{n+1}{2} \le m_2 + \cdots + m_k + 1,\]
	exactly as we wished.
\end{proof}

\begin{lemma} \label{lem:n/2-partitions}
	Let $n$ be even and let $P$ be a partition into $n/2$ parts.
	Then one of the following holds:
	\begin{itemize}
		\item $\Sigma(P) = \llb 0, n \rrb$.
		\item $\Sigma(P) = \llb 0,n \rrb\setminus\{n/2\}$ and $P = (n/2+1,1,\dots,1)$.
		\item $\Sigma(P) = 2\cdot \llb 0, n/2 \rrb$ and $P = (2,\dots, 2)$
	\end{itemize}
\end{lemma}

\begin{proof}
	Let $P = (m_1,\dots, m_k)$ with $k=n/2$ and $m_1\ge \cdots \ge m_k \ge 1$.
	Note that the average size of the parts of $P$ is $(m_1+\cdots+m_k)/k = n/(n/2) = 2$.
	Thus the smallest part $m_k$ satisfies $m_k \le 2$.
	
	If $m_k = 2$ then $m_1 = n - (m_2+\cdots+m_k) \le n - (k-1)(2) = n - (n/2-1)2 = 2$.
	Thus we have $m_1 = \cdots = m_k = 2$ and so $\Sigma(P) = \{0,2\}+\cdots+\{0,2\} = \{0,2,\dots,n\} = 2\cdot\llb0,n/2\rrb$ (recalling that $2\cdot X = \{2x: x\in X\}$, as opposed to $2X = X+X$).
	
	Suppose now that $m_k=1$.
	Then, since the average of the parts $m_i$ is equal to $2$, we must have that the greatest part $m_1 > 2$.
	As a result, 
	\[\frac{m_2+\cdots+m_k}{k-1} = \frac{n-m_1}{n/2-1} < \frac{n-2}{n/2-1} = 2, \]
	so $k-1 > (m_2 + \cdots + m_k)/2$; by Lemma \ref{lem:long-partitions}, $\Sigma(m-2,\dots,m_k) = \llb 0, n-m_1 \rrb$.
	
	Now we have $\Sigma(P) = \{0,m_1\} + \llb 0,n-m_1\rrb = \llb 0,n-m_1 \rrb \cup \llb m_1, n\rrb$, so $\Sigma(P) = \llb 0,n \rrb$ provided $2m_1 < n+1$.
	If not, then $2m_1 \ge n+2$, so $m_1 \ge \frac{n+2}{2}$.
	From this, it follows that 
	\[m_2 +\cdots+m_k = n-m_1 \le n - \frac{n+2}{2} = \frac{n}{2}-1 = k-1.\]
	Since each $m_i \ge 1$, we must have $m_2 = \cdots = m_k = 1$, so $P = (n/2+1, 1,\dots, 1)$ and $\Sigma(P) = \llb 0,n/2-1 \rrb \cup \llb n/2+1,n\rrb$.
\end{proof}

\begin{thm}
	Let $X \in \PN$ and suppose that there is $k\in \mathsf{L}(X)$ with $k > \max(X)/2$.
	Then $X = \llb 0, \max(X) \rrb$.
\end{thm}

\begin{proof}
	Let $n = \max(X)$ and let $\aa\in\Z(X)$ be a factorization with length $|\aa| = k$.
	Then there are integers $m_1\ge\cdots \ge m_k \ge 1$ and atoms $A_i\in \A_{m_i}$ with $\aa = A_1*\cdots*A_k$.
	The result is immediate from Lemma \ref{lem:long-partitions}, since we have
	\[ X = A_1 + \cdots + A_k \supseteq \{0,m_1\} + \cdots + \{0,m_k\} = \Sigma(m_1,\cdots,m_k) = \llb 0,n \rrb \]
	and we know $X \subseteq \llb 0,\max(X) \rrb = \llb 0, n \rrb$.
\end{proof}

\chapter{Techniques in Abelian Groups and Applications} \label{ch:applications}
%%%%%%
%%%%%%
\section{Passage Between Power Monoids}\label{sec:passage}


The natural power monoid $\PN$ is connected to the study of many other power monoids.
In this section we will mention some ways relating the study of $\PN$ to other classes of power monoids.
In some cases, we will be able to \textit{locally transfer} the factorization behavior between $\PN$ and other power monoids, (the meaning of this is made precise in Definition \ref{def:local transfer}).
This yields especially powerful results when we consider $\NN^d$; as we will see in Theorem \ref{thm:passage-to-Nd} that the study of factorizations in $\PN$ is essentially the same as that of $\P_\fon(\NN^d)$.
Highlighting these relationships between $\PN$ and other monoids serves to further motivate the study of both $\PN$ and its relatives.


%\subsection*{Cyclic Groups}

%Abelian groups are a classical setting for combinatorial sumset problems \textcolor{red}{[CITE SOME PAPERS]}.
%By the Fundamental Theorem of Finitely Generated Abelian Groups, all finitely-generated abelian groups can be constructed as direct sums of cyclic groups, so studying the power monoid of a cyclic group can be motivated by the hope to fully understand sumset arithmetic in all abelian groups.

%For any abelian group $G$, $\P_\fin(G)  = \P_\funt(G)$, and we have by Lemma \ref{prop:comm-pm} that the embedding $\P_\fun(G) \hookrightarrow \P_\funt(G)$ is an essentially surjective equimorphism.
%Thus the study of $\P_\fun(G)$ actually encompasses the full study of $\P_\fin(G)$. 

%Section \ref{sec:cyclic-case} tells us about the factorization theory of $\P_\fon(\ZZ/n\ZZ)$, establishing a foothold in the study of subset arithmetic of finite cyclic groups.  
%By analogy, we should study $\P_\fon(\ZZ)$ to complete our understanding of cyclic groups.
%However, it suffices to study $\PN$ by the following:

%\begin{prop}
%	The inclusion $i: \P_\fon(\NN) \hookrightarrow \P_\fon(\ZZ)$ is an essentially surjective equimorphism.
%\end{prop}

%\begin{proof}
%	We can see without much effort that $i$ is essentially surjective; for any $X\in \P_\fon(\ZZ)$, $X - \min(X) \in \PN$.
%	It remains to verify properties \ref{def:equimorphism(E1)}, \ref{def:equimorphism(E2)}, and \ref{def:equimorphism(E3)} of Definition \ref{def:equimorphism}.
%	\ref{def:equimorphism(E1)} is immediate since $i$ is an inclusion map, the other properties follow from Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(iii)} (that is, from the fact that $\PN$ is divisor-closed in $\P_\fon(\ZZ)$).
%\end{proof}


%We have seen just above that studying $\PN$ is sufficient for studying the subset arithmetic of $\ZZ$.



As Fan and Tringali prove in \cite[Theorem 3.8, Theorem 4.11]{fan-tringali18}, all of the factorization information of $\PN$ embeds into \textit{any} non-torsion monoid $H$.
We briefly recall the basic ideas underpinning this fact below.

\begin{prop}\label{prop:natural-to-non-tors}
	Let $H$ be a non-torsion monoid.
	Then there is an equimorphism from $\PN \to \P_\fun(H)$.
\end{prop}
\begin{proof}
	If $H$ is a non-torsion monoid, let $x\in H$ be an element with infinite multiplicative order.  
	Then the map $f: \NN \to \gen{x}$ given by $n\mapsto x^n$ is an isomorphism (specifically, from $(\NN,+)\to (\gen{x},\cdot)$).
	On the level of sets, this yields an isomorphism $f: \PN \to \P_\fun(\gen{x})$.
	In turn, this isomorphism induces an isomorphism $f^*: \F(\A(\PN)) \to \F(\A(\P_\fun(\gen{x})))$.
	As a consequence, for any $X \in \PN$, we have a bijection $f^*: \Z_{\PN}(X) \to \Z_{\P_\fun(\gen{x})}(f(X)) = \Z_{\P_\fun(H)}(f(X))$, where the last inequality follows from Proposition \ref{prop:pm-arith} \ref{it:prop:pm-arith(ii)} (that is, $\P_\fun(\gen{x})$ is divisor-closed in $\P_\fun(H)$).
\end{proof}

Thus the study of factorizations of $\PN$ actually tells us about the factorization of certain subsets of $H$.
Of course, there is much more to be studied in $\P_\fun(H)$ when we include subsets of $\gen{x,y}\subseteq H$, especially when $x$ and $y$ do not commute.
At a minimum, what we have observed above does tell us that every behavior encountered in $\PN$ actually occurs in many more power monoids.

It is not always possible to find a large-scale structural embedding of the factorization behavior of one monoid into another.  
However, it is possible for the study of factorizations of two monoids to be closely linked in a somewhat weaker sense.

\begin{defn} \label{def:local transfer}
Let $H$ and $K$ be monoids. 
We will say that $H$ is \textbf{locally transferrable} to $K$ if, for every non-unit $x\in H$, there is a homomorphism $f: H \to K$ such that 
\begin{enumerate}[label={\rm (\roman{*})}]
	\item $f$ is atom-preserving; for every $a\in \A(H)$, $f(a)\in \A(K)$.
	\item $f^*:\Z_H(x) \to \Z_K(f(x))$ is a bijection (here $f^*$ is identified with the restriction to $\Z_H(x)$ of the induced map $f^*: \F^*(\A(H)) \to \F^*(\A(K))$).
\end{enumerate}
We will refer to $f$ as an $x$-\textbf{transfer} to $K$.
One may also note that, by construction, $f^*:\Z_H(x) \to \Z_K(f(x))$ preserves factorization lengths.
\end{defn}

The remaining results in this section highlight the motivating example for the definition of local transferrability; namely, the monoids $\P_\fon(\NN^d)$ for $d>1$.

\begin{lemma}\label{lem:local-transport}
Let $\varphi: H \to K$ be a homomorphism of (additively written) commutative monoids. 
If $W\subseteq H$ is a subset with the property:
\begin{itemize}
\item[$(*)$] For all $x,y,z\in W$, $\varphi(x) = \varphi(y) + \varphi(z)$ if and only if $x = y + z$.
\end{itemize}
Then we have that
\begin{enumerate}[label={\rm (\roman{*})}]
\item The restriction $\varphi|_W$ is injective.
\item $\varphi:\P_\fon(H) \to \P_\fon(K)$ is an atom-preserving map.
\item The induced map $\varphi:\Z_{\P_\fon(H)}(W) \to \Z_{\P_\fon(K)}(\varphi(W))$ is a length-preserving bijection.
\end{enumerate}
\end{lemma}

\begin{proof}
Point (i) is clear by taking $z = 0$ in property $(*)$.
To see (ii), suppose $A\subseteq W$ and $\varphi(A) = Y+Z$.
Then, since $Y,Z\subseteq \varphi(A)$, we may write $Y = \varphi(B)$ and $Z = \varphi(C)$ for some $B,C\subseteq A$.
For any $a\in A$, $\varphi(a) \in \varphi(B) + \varphi(C)$, so there are $b\in B$ and $c\in C$ with $\varphi(a) = \varphi(b) + \varphi(c)$.
By $(*)$, $a = b + c \in B+C$, so $A \subseteq B + C$.
A nearly identical argument yields the other inclusion, so that $A = B+C$.
Thus, if $A$ is an atom, so too must be $\varphi(A)$. 

For (iii), we wish to see that $\Phi$ is a bijection; we will show that $\Phi$ has an inverse.
Let $\bb = B_1 * \cdots * B_k\in \Z(\varphi(W))$.
Each $B_i = \varphi(A_i)$ for some $A_i\subseteq W$ and, by (i), $\varphi^{-1}(\varphi(A_i)) = A_i$.
This implies that the map sending $\bb \mapsto \varphi^{-1}(B_1) * \cdots * \varphi^{-1}(B_k)$ is inverse to $\varphi^*$, which is all we needed to show.
\end{proof}

\begin{rk}
Note that the property $(*)$ in Lemma \ref{lem:local-transport} is \textit{not} equivalent to the restriction $\varphi|_W$ being injective, because we have not made any assumption of algebraic structure on $W$; in particular, $W$ is not necessarily closed under addition. 
\end{rk}

\begin{prop}\label{prop:flattening}
Let $r \ge 1$ and $W\in \P_\fon(\NN^{r+1})$.
Let $N > 2 \max\{\pi_r(w): w\in W\}$, where $\pi_r: \NN^{r+1} \to \NN$ is the projection map from the $r$th coordinate.
Define $\varphi: \NN^{r+1} \to \NN^r$ by $\varphi(w_1,\dots, w_{r+1}) = (w_1,\dots, w_{r-1},w_r + N w_{r+1})$.
Then
\begin{enumerate}[label={\rm (\roman{*})}]
	\item $\varphi$ is a homomorphism.
	\item For all $x,y,z\in W$, $\varphi(x) = \varphi(y) + \varphi(z)$ if and only if $x = y + z$.
	\item $\varphi*:\Z_{\P_\fon(\NN^{r+1})}(W) \to \Z_{\P_\fon(\NN^r)}(\varphi(W))$ is a bijection.
\end{enumerate}
\end{prop}
\begin{proof}
It is easy to see (i), for this follows from the distributivity of multiplication in $\ZZ$.

Point (ii) will follow from our choice of $N$ (Recall that $N > 2m$, where $m = \max\{\pi_r(w): w\in W\}$).
Let $x,y,z\in W$, writing $x = (x_1,\dots, x_{r+1})$ (and so on), and suppose tha$\varphi(x) = \varphi(y) + \varphi(z)$.
Then we immediately have $x_i = y_i + z_i$ for all $i < r$.
For the $r$th component, we have $x_r + Nx_{r+1} = y_r + Ny_{r+1} + z_r + Nz_{r+1}$, so
$x_r -y_r - z_r = N(y_{r+1}+z_{r+1}-x_{r+1})$.
Since 
\[|x_r - y_r - z_r| \le | |x_r - y_r| - |z_r| | \le |x_r-y_r| + |z_r| \le 2m < N,\]
it must be that both sides of this last equation are equal to zero, so that $x_r = y_r + z_r$ and $x_{r+1} = y_{r+1}+z_{r+1}$.
Now we have $x = y+z$, as we wished.

Finally, (iii) follows from (i) and (ii) by Lemma \ref{lem:local-transport}.
\end{proof}

\begin{thm}\label{thm:passage-to-Nd}
Let $d > 1$. 
Then $\P_\fon(\NN^d)$ is locally transferrable to $\PN$.
\end{thm}
\begin{proof}
We can prove this by inducting on $d$.
Begin with the case $d=2$ and let $X\in \P_\fon(\NN^2)$.
Proposition \ref{prop:flattening} gives us an $X$-transfer to $\varphi:\P_\fon(\NN^2) \to \PN$, so we are done.

Now suppose $d>2$ and assume by way of induction that $\P_\fon(\NN^{d-1})$ is locally transferrable to $\PN$.
Let $X\in \P_\fon(\NN^{d})$.
As above, Proposition \ref{prop:flattening} yields an $X$-transfer $\varphi$ to $\P_\fon(\NN^{d-1})$.
Since we have assumed $\P_\fon(\NN^{d-1})$ to be locally transferrable to $\PN$, there is a $\varphi(X)$-transfer $\psi: \P_\fon(\NN^{d-1}) \to \PN$.
Then $\psi\circ\varphi: \P_\fon(\NN^d) \to \PN$ is an $X$-transfer, so we conclude that $\P_\fon(\NN^d)$ is locally transferrable to $\PN$.
\end{proof}

We will revisit the connection between $\PN$ and the natural lattice in the next section.
For now, we will mention some more connections to other power monoids.

%In this section, we give several reasons which motivate the study of $\PN$, mention some known facts about this monoid, and outline some techniques which can hopefully help us learn more about all aspects of this monoid (and which help us recover some results of Y. Fan and S. Tringali from a different viewpoint).

%We begin by outlining several reasons that, certainly within the scope of power monoids, $\PN$ is a well-motivated and natural setting in which to study factorizations.





\section{Algorithmic Approaches to Factorization}
In this section, we wish to develop some tools for making arguments about factorizations of subsets inside an abelian group.  
We also wish to lay out some practical procedures for the benefit of those who wish to approach power monoids from a computational point of view.

%Throughout this section, we will assume $G$ is an abelian group and that $H\subseteq G$ is a monoid such that, for all $x\in H\setminus\{1\}$, $x^2 \notin\{1,x\}$ (by Theorem \ref{th:atomicity}, this means exactly that $\P_\fon)
%The prototypical example of this situtation is the case when $G = \ZZ^d$ and $H = \NN^d$.
%Unless otherwise specified, all subsets of $H$ instantiated are assumed to be finite and to contain $0$.  That is, they are assumed to be elements of $\P_\fon(H)$.

First and foremost, we can take advantage of the setting of an abelian group to develop an inductive approach to factorization in $\P_\fon(H)$, when $H$ is a submonoid of an abelian group $G$.
Given $A\in \P_\fon(H)$, we often wish to determine whether $A$ divides $X$; that is, whether there is $Y$ so that $X = A+Y$.
Due to the non-cancellative nature of power monoids, there is not a canonical choice for such a $Y$.
In general, there may be many such $Y$.
To make the best of our situation, we have the following definition and proposition.

\begin{defn} \label{def:cofactor}
	Let $G$ be an abelian group, let $H \subseteq G$ be a monoid, and let $X,A\in \P_{\fin,0}(H)$.
	We define the \textbf{saturated cofactor of $A$ in $X$} by
	\[ X\:A := \bigcap_{a\in A} (X-a) \]
\end{defn}

$X\:A$ is the largest possible set $Y$ such that $X = A + Y$, in the sense of the following proposition.

\begin{prop} \label{prop:cofactors}
	Let $X,A \in \P_\fon(H)$. 
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item $A + X\:A \subseteq X$.
		\item If $X = A + Y$ then $Y \subseteq X\:A$.
		\item If $A$ divides $X$ if and only if $A + X\:A = X$.
	\end{enumerate}
\end{prop}

\begin{proof}
	Point (i) is straightforward to see; suppose $a\in A$ and $x\in X\:A$.
	Then, by construction, $x\in X-a$ so that $x+a \in (X-a) +a = X$.
	
	For (ii), suppose $y\in Y$ and $a\in A$.
	Then $a+y \in A + Y = X$, so $y \in X-a$; this was true for any $a\in A$, so $y\in \bigcap_{a\in A} (X-a) = X\:A$.
	
	To see (iii), first suppose that $A$ divides $X$; then there is some $Y$ so that $A + Y = X$.
	Then, using (ii) and then (i), we have that $X = A+Y \subseteq A+ (X\:A) \subseteq X$, whence all the inclusions are equalities.
\end{proof}


\begin{rk}
Consider the following algorithm for finding the prime factorization of an element $n\in \NN$:
\begin{itemize}
	\item For every prime $p \le \sqrt{n}$, check if $p$ divides $n$.
	\begin{itemize}
		\item If no such $p$ divides $n$ then $n$ is a prime; return the factorization $n$.
		\item If some $p$ does divide $n$, find a factorization $\aa$ of $n/p$ and return $p * \aa$.
	\end{itemize}
\end{itemize}
	
We might wish to imitate this in $\P_\fon(H)$ using our notion of cofactors.
Let $X$ be a subset of $H$; then consider the following ``naive algorithm'' for factoring in $\P_\fon(H)$:
\begin{itemize}
	\item For every atom $A \subsetneqq X$, check if $A$ divides $X$ (that is, whether $A + X\:A = X$).
	\begin{itemize}
		\item If no such $A$ divides $X$ then $X$ is an atom; return $X$.
		\item If $A$ divides $X$, return the set $\{A * \aa: \aa\in \Z_{\P_\fon(H)}(X) \}$.
	\end{itemize}
\end{itemize}
This algorithm comes up short since it fails in general to obtain the entire set of factorizations of $X$, as we will see now.
\end{rk}

\begin{eg}
Let $H = \NN$ and take $X := [0,n]$ for some odd $n \ge 11$.
We can show that $A := \{0,1,3\}$ and $B := \{0,1,3,\dots,n-2,n-3\}$ are both atoms, and that $X = A + B$ (so $A*B$ is a factorization of $X$).
However, $X\:A = [0,n] \cap [-1,n-1] \cap [-3,n-3] = [0,n-3] \neq B$ and $X\: B \neq A$.
Thus the above algorithm will find factorizations of the form $A*\bb$ for $\bb$ a factorization of $[0,n-3]$ (and similarly $B*\aa$ for $\aa$ a factorization of $[0,3]$), but it will fail to find $A*B$.
\end{eg} 

This example suggests an adjustment to our ``Naive" algorithm.
In the setting when $H$ is a submonoid of an abelian group $G$ such that $\P_\fon(H)$ is atomic, we see by Theorem \ref{th:atomicity} that $H$ cannot contain any elements of order $2$.
For simplicity, we will consider a torsion-free submonoid of an abelian group, at which point it suffices by Theorem \ref{thm:passage-to-Nd} to consider the case when $H = \NN$.

\begin{defn} \label{def:fac algorithm}
We define the function $\mathbf{fac}$ which assigns to a given $X$ a set of factorizations of $X$ (which we will later assert is the entire set of factorizations of $X$).
Given any $X\in \P_\fon(H)$,
\begin{itemize}
	\item[(1)] Start with $\mathbf{fac}(X) = \emptyset$.
	\item[(2)] If $X = \{0\}$, return $\mathbf{fac}(X) = \emptyset$.
	\item[(3)] If $X$ is an atom, return $\mathbf{fac}(X) = \{X\}$. 
	\item[(4)] For each atom $A \subseteq X$, if $A + X\:A = X$,
	\begin{itemize}
	\item[(5)] For every subset $Y \subseteq X\:A$, if $A+Y = X$,
	\begin{itemize}
		\item[(6)] For every $\bb\in \mathbf{fac}(Y)$, add $A*\bb$ to $\mathbf{fac}(X)$.
	\end{itemize}
\end{itemize}
\item[(7)] Return $\mathbf{fac}(X)$.
\end{itemize}
\end{defn}

\begin{prop}
For any $X\in \PN$, $\mathbf{fac}(X) = \Z_{\PN}(X)$.
\end{prop}

\begin{proof}
We can prove this by inducting on the size of $X$.
If $|X|=1$ then $X = \{1\}$ and $\Z_{\P_\fon(H)}(X) = \emptyset = \mathbf{fac}(X)$ (in accordance with step (2) in the definition of $\mathbf{fac}$).
If $|X| = 2$ then, since $H$ is reduced and contains no nontrivial idempotents (as it lies inside $G$), $X$ is an atom by Lemma \ref{lem:2-elt-atoms}.
Hence $\Z_{\P_\fon(H)}(X) = \{X\} = \mathbf{fac}(X)$ by step (3).

It is apparent by construction that $\operatorname{fac}(X) \subseteq \Z_{\P_\fon(H)}(X)$, so we only need to show that the other inclusion holds.
Suppose $A_1*\cdots*A_k \in \Z_{\P_\fon(H)}$.
Then $A_1 + (A_2 + \cdots + A_k) = X$, so Proposition \ref{prop:cofactors}(iii) implies that $A_1 + (X\:A_1) = X$.
At this point, step (5) of the procedure for generating $\mathbf{fac}(X)$ will find $Y:=A_2+\cdots+A_k$ in its search of all subsets of $X\:A_1$.
By induction, we have that $A_2*\cdots*A_k \in \Z_{\P_\fon(X)}(Y) = \mathbf{fac}(Y)$.
Thus $A_1 * \cdots * A_k \in \mathbf{fac}(X)$, as we wished.
\end{proof}

\begin{rk}
This algorithm still proceeds by brute force, and can be computationally cumbersome.  
There are several refinements that we can make by taking advantage of the specific situation of factoring inside $\PN$.
For instance, as we discuss in Chapter \ref{ch:partitions}, $\PN$ comes equipped with a natural grading of sorts.
Let $\P_n = \{X\in \PN: \max(X)=n\}$ and $\A_n = \{A\in \P_n: A\in \A(\PN)\}$; then $\P_n + \P_m \subseteq \P_{n+m}$.
As a preliminary improvement to Definition \ref{def:fac algorithm}, we can replace the search in step (5) with a search over all subsets $Y \subseteq X\:A$ with $\max(Y) = \max(X\:A)$.
\end{rk}



\section{Independence Arguments in the Natural Lattice}

Theorem \ref{thm:passage-to-Nd} states that the factorization theory of $\P_\fon(\NN^d)$ is locally included in that of $\PN$.
Thus, to study $\P_\fon(\NN^d)$, we need only look inside $\PN$. 
Another perspective is the following: to study factorizations in $\PN$, we now have access to the space and geometric intuition afforded to us by working inside the $d$-dimensional lattice $\NN^d$.
To make effective use of this intuition, we will formulate and exploit some techniques suitable to this setting.

Throughout this section, all subsets of $\NN^d$ that we instantiate will be assumed to be finite and to contain $0$ (that is, they will be assumed to be elements of $\P_\fon(\NN^d)$).
Furthermore, we will drop the subscripts from the sets of factorizations (resp., lengths) of elements of $\P_\fon(\NN^d)$, as in $\Z(X)$ (resp., $\mathsf{L}(X)$).

\begin{defn}
First we set the notation that, for any subset $X \subseteq \ZZ^d$, $\ZZ X := \gen{X}_{\ZZ^d}$ is the subgroup of $\ZZ^d$ generated by $X$.
We say that subsets $U$ and $V$ of $\NN^d$ are \textbf{$\ZZ$-independent (or $V$ is $\ZZ$-independent from $U$)} if $\ZZ U \cap \ZZ V = \{0\}$.

We will say that subsets $U_1,\dots, U_n\subseteq \NN^d$ are \textbf{(totally) $\ZZ$-independent} if, for every pair of disjoint subsets $I,J\subseteq\llb 1,n \rrb$, $\sum_{i\in I} U_i$ and $\sum_{j\in J} U_j$ are $\ZZ$-independent.
\end{defn}

We begin by outlining some basic properties of $\ZZ$-independence.  
More often than not, we will use these without mention, or by simply citing ``$\ZZ$-independence."
\begin{prop} \label{prop:eltwise-indep}
Let $u_1,\dots, u_k\in \NN^d$ be nonzero elements.
\begin{enumerate}[label={\rm (\roman{*})}]
	\item $\{u_1,\dots,u_k\}$ is a $\ZZ$-linearly independent set if and only if $\{0,u_1\},\dots,\{0,u_k\}$ are totally $\ZZ$-independent.
	
	\item If $\sum_i u_i = 0$ then $u_i = 0$ for all $i=1,\dots, k$.
	
	\item If $U_1,\dots, U_k$ are totally $\ZZ$-independent and $u_i, v_i\in U_i$ for each $i\in \llb 1,k \rrb$,
	then $\sum_i u_i = \sum_i v_i$ implies that $u_i = v_i$ for $i = 1,\dots, k$.
\end{enumerate}
\end{prop}

\begin{proof}
(i) is a straightforward exercise in the definition of total $\ZZ$-independence and (ii) is simply a consequence of $H$ being a reduced monoid.

For (iii), we can induct on $k$.
The result is trivial if $k = 1$, so let $k=2$.
$u_1 + v_1 = u_2 + v_2$ implies that $u_1 - v-1 = v_2 - u_2 \in \ZZ U_1 \cap \ZZ U_2 = \{0\}$, so $u_1 = v_1$ and $u_2 = v_2$.

For the inductive step, suppose $k>2$ and that the result holds for integers smaller than $k$.
The equation $\sum_i u_i = \sum_i v_i$ implies that $u_1 - v_1 = \sum_{i\ge 2} (v_i - u_i)$, and we have that 
\[u_1 - v_1 \in \ZZ U_1 \cap \ZZ(U_2+\cdots+U_k) = \{0\},\]
yielding that $u_1 = v_1$ and $\sum_{i\ge 2} u_i = \sum_{i\ge 2} v_i$.
By induction, the last equation implies that $u_i = v_i$ for all $i$ and we are done.
\end{proof}

\begin{prop} \label{prop:indep-decomp}
Let $U,V \subseteq \NN^d$ be $\ZZ$-independent and let $A_1,\dots, A_k$ be nonzero subsets with $U+V = \sum_{i=1}^k A_i$.
\begin{enumerate}[label={\rm (\roman{*})}]
	\item $U_j = \sum_{i=1}^k U_j\cap A_i$.
	\item If $U \cap A_i = \{0\}$ then, for any $V'\subseteq V$, $(U+V')\cap A_i = V'\cap A_i$.
	\item For each $i$, $U\cap A_i \neq \{0\}$ or $V \cap A_i \neq \{0\}$.
	\item $k \le \max \mathsf{L}(U) + \max \mathsf{L}(V)$.
\end{enumerate}
\end{prop}

\begin{proof}
(i) For each $i$, let $u_i\in U\cap A_i$.
Then $\sum_i u_i \in \sum_i A_i = U+V$, and there are $u\in U$ and $v\in V$ with $\sum_i u_i = u+v$.
By Proposition \ref{prop:eltwise-indep}(ii), $v = 0$ and $\sum_i u_i = u \in U$

The other inclusion is similar; for any $u\in U \subseteq \sum_i A_i$, we can find $u_1,\dots,u_k\in U$ and $v_1,\dots, v_k\in V$ such that $u_i+v_i\in A_i$ for each $i$ and $u = \sum_i (u_i + v_i)$.
Again by Proposition \ref{prop:eltwise-indep}(ii), $\sum_i v_i = 0$, and each $v_i = 0$ by Proposition \ref{prop:eltwise-indep}(i).

Moving on to (ii), it is sufficient to prove the result for $i=1$ by renumbering the $A_i$ if necessary.
Suppose $u\in U$, $v\in V'$, and $u+v\in A_1$.
Since $U\cap A_1 = \{0\}$, we know from (i) that
\[ U = \sum_{i\ge 1} U\cap A_i = \sum_{i\ge 2} U\cap A_i, \]
so $u+v + U \subseteq A_1 + \sum_{i\ge 2} A_i \subseteq U+V$.
Thus, for any $w\in U$, there are $u'\in U$ and $v'\in V$ so that $u+v+w = u'+v'$.
By the $\ZZ$-independence of $U$ and $V$, $v' = v$ and so we actually have that $u+v+U \subseteq U + v$.
We can cancel $v$ to get $u+U \subseteq U$.
Since $|u+U| = |U| <\infty$, we must actually have $u+U = U$; however, this implies that $u = 0$.
We now have that $v = u+v \in A_1$, so $(U+V')\cap A_1 \subseteq V' \cap A_1$.
The reverse inclusion is trivial since $0\in U$, so we are done.

(iii) follows quickly from (ii); suppose $U\cap A_i = \{0\} = V\cap A_i$.
Then $A_i = (U+V)\cap A_i = V\cap A_i = \{0\}$ (we used (ii) at the second equal sign).

Finally, for (iv): let $\ell = \max \mathsf{L}(U)$ and $m = \max\mathsf{L}(V)$.
Without loss of generality, say $\llb 1,s \rrb = \{i: U\cap A_i \neq \{0\} \}$ and $\llb t,k \rrb = \{i: V\cap A_i \neq \{0\} \}$.
Since, by (i), $U = \sum_i U\cap A_i = \sum_{i\le s} U \cap A_i$, $| \llb 1,s \rrb | \le \ell$ (similarly, $|\llb t,k \rrb| \le m$).
By (iii), $\llb 1,k \rrb = \llb 1,s \rrb \cup \llb t,k \rrb$, so $k \le \ell + m$ as we wished.
\end{proof}

\begin{lemma} \label{lem:indep-atom-decomp}
Let $U, V_1,\dots, V_m\subseteq \NN^d$ be totally $\ZZ$-independent.
Suppose each $V_j$ is an atom, and let $V := \sum_j V_j$.
Further suppose that $A_1,\dots, A_k$ are nonzero subsets with $U+V = \sum_{i=1}^k A_i$.
\begin{enumerate}[label={\rm (\roman{*})}]
	\item There is a function $f: \llb 1,m \rrb \to \llb 1,k \rrb$ with $V_j \subset A_{f(j)}$ for each $j\in \llb 1,m\rrb$.
	\item For each $h\in \llb 1,k\rrb$, $V\cap A_h = \sum\limits_{j\in f^{-1}(h)} V_j$.
	\item For each $h\in \llb 1,k\rrb$, $\left( \sum\limits_{j\notin f^{-1}(h)} V_j \right) \cap A_h = \{0\}$.
\end{enumerate}
\end{lemma}

\begin{proof}
For (i), fix $j\in \llb 1,m \rrb$.
Then, by Proposition \ref{prop:indep-decomp}(i), $V_j = \sum_i V_j \cap A_i$.
Since $V_j$ is an atom, only one summand on the right side of this equation can be zero; let $f(j)$ denote the index of that summand.
Then we have $V_j = V_j \cap A_{f(j)} \subseteq A_{f(j)}$.

To prove (ii), let $J := f^{-1}(h) = \{j: V_j \subseteq A_h\}$ and call $V' = \sum_{j\in J} V_j$.
Similarly, let $K = \llb 1,m \rrb \setminus J$ and call $V'' = \sum_{j\in K} V_j$.
Because $V_1,\dots, V_m$ are totally $\ZZ$-independent, $V'$ and $V''$ are $\ZZ$-independent.

For each $j\in J$ and each $i\neq h$, $V_j\cap A_i = \{0\}$. 
An easy induction on $|J|$ then yields that $V' \cap A_i = \{0\}$ for each $i\neq h$.
As a result, we have (using Proposition \ref{prop:indep-decomp}(i)) that $V' = \sum_i V'\cap A_i = V' \cap A_h$.

On the other hand, for $j\in K$, $V_j\cap A_h = \{0\}$, so $(V' + V_j) \cap A_h = V' \cap A_h$ (using Prop \ref{prop:indep-decomp} (ii)).
By induction on $|K|$, we can see that $V'' \cap A_h$ = 0, so that $A_h = V\cap A_h = (V' + V'')\cap A_h = V' \cap A_h = V'$, completing the proofs of both (ii) and (iii).
\end{proof}

\begin{thm} \label{thm:ind-atoms}
If $V_1,\dots,V_m\subseteq \NN^d$ are totally $\ZZ$-independent then $V_1+\cdots+V_m$ factors uniquely (up to reordering of factors).
\end{thm}

\begin{proof}
Let $V = V_1+\cdots + V_m$.
The result will essentially follow from Lemma \ref{lem:indep-atom-decomp}, taking $U = \{0\}$.

Let $A_1,\dots, A_k$ be atoms with $V = \sum_i A_i$.
As in Lemma \ref{lem:indep-atom-decomp}(i), there is $f:\llb 1,m \rrb \to \llb 1,k\rrb$ with $V_j \subseteq A_{f(j)}$ for each $j\in \llb 1,m\rrb$.
We wish to show that $f$ is injective; let $h\in \llb 1,k \rrb$ and let $J = f^{-1}(h)$.
By Lemma \ref{lem:indep-atom-decomp}(ii), $A_h = V \cap A_h = \sum_{j\in J} V_j$, which is only an atom if $|J|=1$, making $f$ injective.  

We have shown more; we in fact have, for each $j\in \llb 1,m \rrb$, $V_j = A_{f(j)}$.
All that remains to see is that $f$ is a surjection.
To see this, suppose $A_i \notin f(\llb 1,m \rrb)$.
Then $V_j \cap A_i = \{0\}$ for all $j\in  \llb 1,m \rrb$, and we have by Proposition \ref{prop:indep-decomp}(ii) and induction that $A_i = \{0\}$.
However, this is impossible since $A_i$ is an atom.  

We conclude that $f$ is a bijection and that the only factorization of $V$ (up to reordering) is $V_1*\cdots*V_m$.
\end{proof}

\begin{eg} \label{eg:recover-flat-unique-fac}
Theorem \ref{thm:ind-atoms} allows us to partially recover \cite[Proposition 4.9]{fan-tringali18}.
We recall here the content of Fan and Tringali's result: Let $a_1,\dots, a_\ell \in \NN$ such that $a_1 + \cdots + a_i < \frac{1}{2} a_{i+1}$ for $i\in \llb 1,\ell-2 \rrb$ and (if $\ell \ge 2$) $a_1+\cdots + a_{\ell-1} < a_\ell - a_{\ell-1}$.
Then $\Z(\{0,a_1\}+\cdots+\{0,a_\ell\}) = \{ \{0,a_1\}*\cdots*\{0,a_\ell\}\}$.

There are many sequences of integers $a_1,\dots,a_\ell$ satisfying the specified properties; for simplicity, let us use the sequence given by $a_i = b^{i-1}$, for some integer $b \ge 3$.

For $i\in \llb 1,\ell \rrb$, let $e_i \in \NN^\ell$ be the $i$th standard basis vector (whose entries are all zero, except for a $1$ in the $i$th coordinate).
Let $V = \{0,e_1\} + \cdots + \{0,e_\ell\}$; by Theorem \ref{thm:ind-atoms}, $V$ factors uniquely.
We will follow the procedure given in Theorem \ref{thm:passage-to-Nd} to ``flatten" $V$ into a subset of $\NN$ which still factors uniquely.
According to this procedure, we need maps $\NN^\ell \to \NN^{\ell-1} \to \dots \to \NN$.

For $i\in \llb 1,\ell-1 \rrb$, define $\varphi_i: \NN^{i+1} \to \NN^{i}$ by $v \mapsto \hat{v} + be_{i}$ (where $\hat{v}$ is the vector consisting of the first $i$ components of $v$, and we have identified $e_i$ with the $i$th standard basis vector in $\NN^i$).
Let $V_\ell = V$ and $V_i = \varphi_i(V_i+1)$ for $i <\ell$.
By Proposition \ref{prop:flattening}, $\varphi_i$ is a homomorphism which essentially preserves the set of factorizations of $V_{i+1}$.
Letting $\varphi := \varphi_1\circ \cdots \circ \varphi_{\ell-1}$, we have that $U := \varphi(V)$ factors uniquely.

To see what elements actually comprise $U$, it is enough to check the value of $\varphi$ on $e_1,\dots, e_\ell$ (since $\varphi$ is a homomorpism).
It is not too difficult to see that $\varphi(e_i) = b^{i-1}$, so that $U = \{0,1\}+\{0,b\}+\cdots+\{0,b^{\ell-1}\}$ which is indeed already known to factor uniquely by Fan and Tringali's result.
\end{eg}

We the end this section with a result with a result asserting some degree of compatibility between uniqueness of factorization and $\ZZ$-independence.

\begin{thm} \label{thm:unique longest factorization}
Let $U\in \P_\fon(\NN^d)$ be an element whose two longest factorizations have lengths $\ell < N$.
Suppose $V_1,\dots,V_m\subseteq \NN^d$ are atoms so that $U,V_1,\dots, V_k$ are totally $\ZZ$-independent.
Further assume that $U$ has a unique longest factorization (of length $N$).
Then $\mathsf{L}(U+V_1+\cdots+V_k) \cap \llb \ell+1,\infty \rrb = \{N+m\}$.
\end{thm}

\begin{proof}
For convenience, let $V := V_1 + \cdots + V_m$.
Suppose that $k > \ell + m$ and that there are atoms $A_1,\dots,A_k$ with $U+V = A_1 + \cdots + A_k$.
By Proposition \ref{prop:indep-decomp}(iv), we know that $k \le N+m$.

By Proposition \ref{prop:indep-decomp}(iii), we can say (renumbering if necessary)
\[ \llb 1,s \rrb =  \{ i: U\cap A_i \neq\{0\}\} \quad \textrm{and} \quad \llb t,k \rrb = \{i: V\cap A_i \neq \{0\}\}. \]
Since we know that $\llb 1,k \rrb = \llb 1,s \rrb \cup \llb t,k \rrb$, we know that $t \le s+1$.
The arguments to follow hinge on whether these two intervals overlap.  
First suppose that the intervals overlap; i.e., that $t \le s$.
We will show that this cannot happen by showing that, in this case, $A_s$ is not an atom.

Let $J = \{ j: V_j \subseteq A_s \}$ and set $V' = \sum_{j\in J} V_j$; we know by Lemma \ref{lem:indep-atom-decomp} that $V' = V \cap A_s$.
Also let $K = \llb 1,m \rrb \setminus J$ and $V'' = \sum_{j\in K} V_j$.

\noindent\underline{Claim A}: $V' = V\cap A_s$ and $V'' \cap A_s = \{0\}$. \label{cla}

This follows directly from Lemma \ref{lem:indep-atom-decomp}(ii),(iii).

\noindent\underline{Claim B}: $A_i \subseteq U$ for $i<t$ and $A_i \subseteq V$ for $i > s$. \label{clb}

Proposition \ref{prop:indep-decomp}(ii) implies both statements since $V \cap A_i = \{0\}$ for $i<t$ (and $U\cap A_i = \{0\}$ for $i>s$).

\noindent\underline{Claim C} For $v\in V$, $U+v = \sum\limits_{i<s} U\cap A_i + (U+v)\cap A_s$. \label{clc}

We move to show both inclusions.
First suppose $u\in U$. 
Then $u+v \in \sum_{i=1}^\ell A_i$, and we can find $u_1,\dots, u_s\in U$ and $v_t,\dots, v_k\in V$ so that
$u_i\in A_i$ if $i < t$, $u_i + v_i \in A_i$ if $t\le i \le s$, and $v_i \in A_i$ if $i > s$.
Then we will have
\[u+v = \sum_{i<t} u_i + \sum_{i=t}^{s} (u_i+v_i) + \sum_{i > s} v_i, \]
whence the $\ZZ$-independence of $U,V_1,\dots,V_m$ implies that $u = \sum_{i\le s} u_i$, $v_s = v$, and $v_i = 0$ for all $i\neq s$.
Now $u+v = \sum_{i<s} u_i + (u_s+v)\in \sum_{i<s} U\cap A_i + (U+v)\cap A_s$.

For the other inclusion, let $u_1,\dots, u_s\in U$ with $u_i\in A_i$ for all $i<s$ and $u_s + v\in A_s$.
Then $\sum_{i\le s} u_i +v \in \sum_{i\le s} A_i \subseteq U+V$, so we can find $u'\in U$ and $v'\in V$ with 
\[\sum_{i\le s}u_i + v = u' + v',\]
at which point we can use $\ZZ$-independence again to see that $v' = v$, so that $\sum_{i\le s} u_i + v\in U+v$.

\noindent\underline{Claim D}: $(U+v)\cap A_s = U\cap A_s + v$. \label{cld}

We can write $(U+v)\cap A_s = A + v$ for some $A \subseteq U$.
Now $U+v = \sum_{i<s} U\cap A_i + (U+v)\cap A_s = \sum_{i<s} U\cap A_i + A + v$.
We can cancel $v$ from both sides of this set equality (since $v$ is a unit in $\P_\fon(\ZZ^n)$), yielding
\[ U = \sum_{i<s} U\cap A_i + A. \tag{D1}\]
On the other hand, we also have that
\[ U = \sum_{i<s} U\cap A_i + U\cap A_s. \tag{D2}\]
We will now show that we can cancel the common factors that appear in these two decompositions.

First, as an aside, note that $t > \ell$.
If this were not the case and $t \le \ell$, then $k = | \llb 1,s \rrb \cup \llb t,k \rrb | \le \ell + | \llb t,k \rrb | \le \ell+m$, which contradicts our intial assumption about $k$.

This is significant because $\sum_{i<t} U\cap A_i = \sum_{i<t} A_i$ is a sum of at least $\ell+1$ atoms, and $U$ has only one factorization consisting of more than $\ell$ atoms.
Say $B_1,\dots, B_{N}$ are the atoms with $U = \sum_{i=1}^{N} B_i$.
Then, by renumbering if needed, there is some $h$ for which $\sum_{i<s} U\cap A_i = B_1 + \cdots + B_h$.

Consequently, by the uniqueness of the atoms $B_i$, it must be that $B_1 +\cdots + B_h$ can be cancelled in the decompositions (D1) and (D2), leaving
\[ A = B_{h+1} +\cdots+ B_{N} = U\cap A_s, \]
and we have proved the claim.

\noindent\underline{Claim E}: $A_s$ is not an atom. \label{cle}

To see this, we compute
\begin{align*}
A_s = (U+V)\cap A_s 
&= (U+V'+V'') \cap A_s \\
&= (U+V') \cap A_s \tag{by Claim A and Proposition \ref{prop:indep-decomp}} \\
&= \bigcup_{v\in V'} (U+v)\cap A_s \\
&= \bigcup_{v\in V'} (U\cap A_s + v) \tag{by Claim D} \\
&= U\cap A_s + V'.
\end{align*}
Since $U\cap A_s$ and $V' = V\cap A_s$ are both nonzero, $A_s$ is not an atom.
This is a contradiction which followed from our assumption that some of the $A_i$ may intersect nontrivially with \textit{both} $U$ and $V$.

Now suppose this does not occur; necessarily, $s < t$ and we in fact have that $t = s+1$ by Proposition \ref{prop:indep-decomp}(iii).
For $i \le s$, since $V\cap A_i  = \{0\}$, Proposition \ref{prop:indep-decomp}(ii) implies that $A_i = (U+V)\cap A_i = U\cap A_i \subseteq U$.
Then we have, by Proposition \ref{prop:indep-decomp}(i), that $U = \sum_{i\le s} U\cap A_i = \sum_{i\le s} A_i$.
This means that $s\in \mathsf{L}(U)$ and, by identical reasoning for $V$, that $| \llb t,k \rrb| = m$.
We conclude that $k \in \mathsf{L}(U) + m$ and, due to the assumption that $k>\ell+m$, it must be the case that $k = N + m$.
\end{proof}


\section{Length Sets in High-Dimensional Lattices}
In this section, we wish to show that certain prescribed sets occur as sets of lengths of elements of $\P_\fon(\NN^d)$ (and hence as sets of lengths of elements of $\PN$).
First, we will recover a version of \cite[Proposition 4.10]{fan-tringali18} which says that, for any $n\ge 2$, there is an element $U$ which has exactly two factorizations: one of length $2$, and one of length $n+1$.
Then we will extend this construction to a class of constructions which realizes some new sets of lengths.

We will be working with a particular construction for most of this section, so we take a moment to set some notation.

\begin{defn} \label{def:two-fac-construction}
Fix an integer $n\ge 2$ and let $d\ge n$.
For $i\in \llb 1,n\rrb$, let $e_i \in \NN^d$ be the $i$th standard basis vector, whose components are all zero except for a single $1$ in the $i$th coordinate.

For any $I \subseteq \llb 1,n \rrb$, we will let $e_I := \sum_{i\in I} e_i$.
Further, let $f := e_{\llb 1,n \rrb} = \sum_{i=1}^n e_i$ and let $g := f + e_n$.
Finally, we set
\[U_{n+1} := \sum_{i=1}^n \{0,e_i\} + \{0,g\}.\]
\end{defn}

We will show (in Theorem \ref{thm:2n-length-set}) that $U_{n+1}$ has exactly two factorizations. 
Before proving this fact or making use of it, we construct a class of atoms which will continue to appear through the remainder of the section.

\begin{lemma} \label{lem:large-atom-two-fac}
Let $U_{n+1}$ be as in Definition \ref{def:two-fac-construction}, and let $V\subseteq \NN^d$ be $\ZZ$-independent from $U_{n+1}$.
Then the set
\[ B:= \left( \sum_{i=1}^{n-1} \{0,e_i\} + \{0,g\} + V \right) \cup \{f\} \]
is an atom.
\end{lemma}

\begin{proof}
Suppose that $B = X + Y$.
It will suffice to prove that one of $X$ or $Y$ is equal to $\{0\}$.
Observe first that $f$ cannot be written as a sum of two or more elements of $B$, since $f\notin \operatorname{span}_\ZZ (\{e_1,\dots, e_{n-1}\}\cup V)$ and the $e_n$ coefficient of $g$ is larger than that of $f$.

One can also see that $g$ cannot be written as a sum of two or more elements of $B$.
As above, $g\notin \operatorname{span}_\ZZ (\{e_1,\dots, e_{n-1}\}\cup V)$.
The only remaining possibility is that $f$ is included at least twice in the sum so that $g = 2f + b$ for some $b\in B$.
This is impossible, as the $e_1$ coefficient of $2f+b$ is at least $2$, whereas that of $g$ is $1$.

We conclude from these observations that $f,g\in X \cup Y$.
Noting that $f+g \notin B$, we may say (without loss of generality) that $f,g\in X$.
Now we aim to show that $Y = \{0\}$.
Suppose $b := \varepsilon g + e_I +v \in Y$ for some $\varepsilon \in \{0,1\}$, $I\subseteq \llb 1,n-1\rrb$, and $v\in V$.
Then we must have $f + b \in X+Y = B \subseteq U_{n+1} + V$, so choose some $u'\in U_{n+1}$ and $v'\in V$ with $f + b = u' + v'$.
By the $\ZZ$-independence of $U_{n+1}$ and $V$, it must be that $v' = v$ and $f + \varepsilon g + e_I = u' \in U_{n+1} \cap B$.

We can finish the proof by noting that the only element of $U_{n+1}\cap B$ with an odd $e_n$ coefficient is $f$, meaning that $\varepsilon=0$ and $I = \emptyset$.
Then $f+b = f+v \in B$, at which point we see that $v = 0$.
Thus $Y = \{0\}$ as we wished.
\end{proof}

\begin{thm} \label{thm:2n-length-set}
Let $n\ge 2$ and let $e_1,\dots, e_n\in \NN^n$ be $\ZZ$-linearly independent.
Set $f = \sum_{i=1}^n e_i$, $g=f+e_n$.
Letting $U = \sum_{i=1}^n \{0,e_i\} + \{0,g\}$, we have 
\[\Z_{\P_\fon(\NN^n)}(U) = \left\{ \{0,e_1\}*\cdots*\{0,e_n\}*\{0,g\}, \left[\sum_{i=1}^{n-1}\{0,e_i\}+\{0,g\}\right]\cup\{f\} * \{0,e_n\} \right\}. \]
\end{thm}

\begin{proof}
Suppose $U = X + Y$ for some $X,Y\subseteq U$ with $X,Y\neq \{0\}$.
First we set some notation by analogy with the proof of \cite[Theorem 4.10]{fan-tringali18}: $I_X := \{i\in \llb 1,n \rrb: e_i\in X\}$, $I_Y := \{i\in \llb1,n \rrb: e_i\in Y \}$.
For further convenience and compactness, we let $e_I := \sum_{i\in I}e_i$ for any $I\subseteq \llb 1,n \rrb$.

Begin by noting that $\llb 1,n \rrb = I_X \sqcup I_Y$; indeed, for each $i\in\llb 1,n \rrb$, $e_i\in X+Y$, and it must be that $e_i\in X\cup Y$ since all the $e_i$ are linearly independent.  
Moreover, we cannot have $e_i\in X\cap Y$ since $2e_i \notin C = \{e_I : I\subseteq \llb 1,n \rrb \}$.

To prove some of the claims which follow, we will use a basic understanding of which linear combinations of the $e_i$ appear as elements of $U$.
Every element of $U$ has one of the following forms:
\begin{enumerate}[label={\rm (F\arabic{*})}]
\item $e_I$: the coefficient to each $e_i$ is either $0$ or $1$.
\item $g+e_I$: the $e_n$ coefficient is either $2$ or $3$, and all other $e_i$-coefficients are either $1$ or $2$.
\end{enumerate}

We now wish to determine the structure of $X$ and $Y$.
For the ease of understanding the argument, we state and prove several small claims about $X$ (which will also hold for $Y$ by symmetry).

\noindent\underline{Claim A}: If $I\subseteq I_X$ then $e_I\in X$. 

Suppose $I = J\sqcup K$ with $e_J\in X$ and $e_K\in Y$.
If $K\neq \emptyset$ then let $k\in K\subseteq I_X$; we have $2e_k + e_{K\setminus\{k\}} = e_k + e_K\in X+Y$, which is impossible unless $K = \llb 1,n\rrb$, so that $e_K = f$.
However, since $1\in K\subseteq I\subseteq I_X$, this implies that $2e_1 + e_{K\setminus\{k\}} = e_1 + e_K\in X+Y$, a contradiction.

\noindent\underline{Claim B}: For $I\subsetneqq \llb 1,n \rrb$, $e_I\in X$ only if $I\subseteq I_X$.

Suppose $K := I \cap I_Y$ is nonempty (otherwise, we are done).
Then $e_{I\setminus K} + 2e_K = e_I + e_K \in X +Y$ has at least one coefficient equal to $0$ and at least one coefficient $\ge 2$, which is a contradiction.

\noindent\underline{Claim C}: If $g + e_I\in X$ then $e_I\in X$. 

Let $K := I\cap I_Y$; then $g + e_{I\setminus K} + 2e_K = (g+e_I) + e_K \in X+Y$, which is not possible unless $K=\emptyset$ (since no element of $U$ has more than one coefficient $>2$).
This implies the desired conclusion.

\noindent\underline{Claim D}: Exactly one of $X$ or $Y$ has an element of the form $g + e_I$. 

This is easy to see; if neither $X$ nor $Y$ has such an element then no element of $X+Y$ has a coefficient larger than two.
On the other hand, if $g+e_J\in X$ and $g+e_K\in Y$ then $2g + e_J + e_K \in X+Y$, which is a contradiction since this element has an $e_n$-coefficient $\ge 4$.

\noindent\underline{Claim E}: If $g+ e_H\in X$ for some $H\subseteq \llb 1,n \rrb$ then $g + e_I \in X$ for every $I\subseteq I_X$ with $I\subsetneqq \llb 1,n\rrb$. 

%First note that if $H = \llb 1,n \rrb$ then $g+f\in X$ and so $Y = \{0\}$.
%It must be that $H\subsetneqq \llb 1,n \rrb$.
Let $I \subseteq I_X$ with $I\subsetneqq \llb1,n\rrb$.
Since $g+e_I\in U = X+Y$, we may write $g+e_I = x +y$ with $x = \delta g + e_J\in X$ (for $\delta\in \{0,1\}$) and $y=e_K\in Y$ by (D).
Now $g + e_I = \delta g + e_J + e_K$.
\begin{itemize}
\item[\underline{Case 1}:] If $\delta = 1$ then $e_I = e_J + e_K$, hence $I = J\sqcup K$. 
Since $I\neq \llb1,n\rrb$, $K\subsetneqq \llb 1,n \rrb$ and so $K\subseteq I_Y$ by (B).
However, we now have that $K = \emptyset$ since $K\subseteq I \subseteq I_X$.
Thus $g + e_I = g + e_J \in X$, as we wished.
\item[\underline{Case 2}:] If $\delta = 0$ then $g + e_I = e_J + e_K$, and the only possibility is that $I = \llb 1,n-1\rrb$ and $J = K = \llb 1,n\rrb$ (so $e_J = e_K = f$).
However, since $\llb 1,n-1 \rrb \subseteq I_X$, we have $e_1 + f \in X+Y$, which is a contradiction (no element of $U$ has an $e_n$-coefficient of $1$ and an $e_1$-coefficient of $2$), finishing the proof of the claim.
\end{itemize}

Assume without loss of generality that $g\in X$.
If $I_X = \emptyset$ then $X = \{0,g\}$ and $Y = \sum_{i=1}^n \{0,e_i\}$ by Claim A.
By Theorem \ref{thm:ind-atoms}, $Y$ factors uniquely and we have $\{0,e_1\}*\cdots \{0,e_n\}*\{0,g\}\in \Z_{\P_\fon(\NN^n)}(U)$.

Now suppose $I_X \neq \emptyset$.
Then, by Claims (C) and (E), 
\[X \supseteq \{0,g\} + \sum_{i\in I_X} \{0,e_i\} \tag{1} \label{factor-includes} \]
We can completely determine the structure of $Y$.
First observe that we cannot have $f=e_{\llb1,n\rrb}\in Y$ since we would then have $(g+e_{I_X})+f \in X+Y$, but this is not an element of $U$.
This allows us to use Claim (B), as well as (A) and (D), to say that $Y = \sum_{i\in I_Y} \{0,e_i\}$.

With this, we can say more about the structure of $X$.
By Proposition \ref{prop:cofactors}, we have 
\[X \subseteq U\:Y = \bigcap_{y\in Y}(U-y) = \bigcap_{K\subseteq I_Y} \underbrace{\{e_I - e_K, g+e_I - e_K : I\subseteq \llb 1,n \rrb \}}_{=:U_K} \]

Recalling the forms (F1) and (F2) of all elements of $U$ that we outlined earlier, we can similarly express the forms of elements of $U\:Y$:
\begin{enumerate}[label={\rm (F\arabic{*}$'$)}]
\item $e_I$ for $I\subseteq I_X$. 
To see this, observe that $e_I = e_{I\cup K}-e_K\in U_K$ for any $K\subseteq I_Y$.
On the other hand note that, for $H \subseteq \llb 1,n \rrb$ with $H\cap I_Y\neq \emptyset$, $g+e_H\notin U_{H\cap I_Y}$, so these are the only elements of form (F1) which remain in $U\:Y$.
%
%for each $k\in I_Y$, every element of the form $e_I - e_k\in U_{\{k\}}\cap U$ has $e_k$ coefficient of zero.
%In the intersection of the $U_K$ over all $K\subseteq I_Y$, we are left only with the elements whose $e_i$ coefficients are $0$ for all $i\in I_Y$.
\item $g+e_I$ for $I\subseteq I_X$.
For this, we observe $g+e_{I\cup K} - e_K\in U_K$. 
Similar to the argument just above, we see that $g+e_H\notin U_{H\cap I_Y}$ whenever $H\cap I_Y\neq\emptyset$.
\item $f\in U\:Y$ only if $I_Y = \{n\}$.
First, it is clear that $f = e_{\llb 1,n \rrb} \in U_\emptyset$.
For any $K\subseteq I_Y$ with $n\in K$, $f = g+ e_{K\setminus\{n\}} - e_K\in U_K$.
However, if $n\notin K$ but $K$ is non-empty, then $f\notin U_K = \{e_I, g+e_I-e_K: I\subseteq \llb1,n\rrb\}$.
This is because $e_I - e_K \neq f$ (since $K$ is non-empty), and $g+e_I-e_K$ has an $e_n$ coefficient larger than $1$ (since $n\notin K$).
\end{enumerate}
We now have, combining our work here with (\ref{factor-includes}) above, that
\[ \{0,g\} + \sum_{i\in I_X}\{0,e_i\} \subseteq X \subseteq U\:Y \subseteq \left[\{0,g\}+\sum_{i\in I_X} \{0,e_i\} \right]\cup\{f\},\]
so we have determined $X$ almost exactly, up to the choice of whether $f\in X$.

Before discussing the possible factorizations of $X$, recall that $Y = \sum_{i\in I_Y} \{0,e_i\}$ and so $Y$ factors uniquely (by Theorem \ref{thm:ind-atoms}) as the sum of the $\{0,e_i\}$ for $i\in I_Y$.

Now we turn to $X$; first suppose $f\notin X$.
Then $X = \{0,g\} +\sum_{i\in I_X} \{0,e_i\}$, which has a unique factorization (by Theorem \ref{thm:ind-atoms}) as the sum of $\{0,g\}$ and the $\{0,e_i\}$ for $i\in I_X$.
This can only produce -- up to reordering, of course -- the factorization $\{0,g\}*\{0,e_1\}*\cdots*\{0,e_n\}\in \Z_{\P_\fon(\NN^n)}(U)$.

If $f\in X$, then $X = \left[\{0,g\}+\sum_{i\in I_X} \{0,e_i\} \right]\cup\{f\}$ (and $Y = \{0,e_n\}$ per our considerations in (F3$'$)).
By Lemma \ref{lem:large-atom-two-fac}, $X$ is an atom, producing the factorization $X*\{0,e_n\}\in \Z_{\P_\fon(\NN^n)}(U)$ and completing the proof.
\end{proof}


\begin{rk}
In the same vein as Example \ref{eg:recover-flat-unique-fac}, one may use Theorem \ref{thm:2n-length-set} to recover some cases of \cite[Proposition 4.8]{fan-tringali18}.
\end{rk}


\begin{cor} \label{thm:int-point-construction}
Fix $n\ge 2$ and $m\ge 1$, and let $V_1,\dots, V_m \subseteq \NN^d$ be atoms such that $U_{n+1},V_1,\dots, V_m$ are totally $\ZZ$-independent.
Then $\mathsf{L}(U_{n+1}+V_1+\cdots+V_m) = \llb 2,m+2 \rrb \cup \{m+n+1\}$.
\end{cor}

\begin{proof}
For convenience, let $U := U_{n+1}$ and $V := V_1 + \cdots + V_m$.
We will start by verifying the values that most clearly belong to $\mathsf{L}(U+V)$.
It is easiest to see that $m+n+1 =\max\mathsf{L}(V)+\max\mathsf{L}(U) \in \mathsf{L}(U+V)$.
For the rest, suppose $0\le h \le m$.
Then, by Lemma \ref{lem:large-atom-two-fac}, 
\[B_h := \left( \sum_{i=1}^{n-1} \{0,e_i\} + \{0,g\} + \sum_{j\in \llb h+1,m \rrb} V_j \right) \cup \{f\} \]
is an atom.
From here, it is straightforward to check that
\[ U+ V = \{0,e_n\} + B_h + V_1 + \cdots + V_h \]
so $h+2 \in \mathsf{L}(U+V)$.
As we allow $h$ to range over $\llb 0,m \rrb$, we get that $\llb 2,m+2 \rrb \in \mathsf{L}(U+V)$.

For the other inclusion, we need to show that no other values are included in $\mathsf{L}(U+V)$.
To do this, we note that $U$ has a unique longest factorization by Theorem \ref{thm:2n-length-set} and hence, using Theorem \ref{thm:unique longest factorization}, $\mathsf{L}(U+V) \cap \llb m+3, m+n+1 \rrb = \{m+n+1\}$.
\end{proof}


%%%%%%
%%%%%%




%Now we know that $\llb 0,n\rrb$ has factorizations of most partition types.  
%In many cases, the existence of one factorization of a given type seems to indicate the possible presence of others.
%In what follows, we will try to determine the extent to which that is true.

%%%%%%
%%%%%%

%\section{Non-Atomicity of Near Intervals in the Natural Power Monoid} \label{sec:near intervals}
%
%%%%%%%
%%%%%%%
%
%We have seen that intervals are, in some sense, as far as possible from being atoms.
%Every set, including atoms, can be realized as an interval with some (possibly many) points removed.  
%Thus we expect that $\llb 0,n \rrb \setminus S$ ``loses" factorizations as $S$ is allowed to become larger.  
%We would like to understand certain thresholds in this process of varying $S$; for instance, how large does $S$ need to become for $\llb 0,n \rrb \setminus S$ to become an atom?  
%From here, we pivot to a slightly different question with the same underlying theme: given $n$, is it possible that $\llb 0,n \rrb \setminus S$ always factors nontrivially for $|S|$ sufficiently small?
%Our goal is to formalize this question and make some progress toward determining the answer.
%
%\begin{conj}
%There is a function $s:\NN \to \NN$ such that, for any subset $S\subseteq \llb 0,n \rrb$ with $|S| \le s(n)$, $\llb 0,n \rrb \setminus S$ factors nontrivially in $\PN$.
%\end{conj}
%
%The following lemma represents many of the ``easy cases" when the set $S$ to be removed from the interval is concentrated in a small segment of the interval.
%
%\begin{lemma}\label{first-third}
%Let $n\in \NN$ and let $S\subseteq \NN$ with $3(\max(S)+1)< n$.
%Then $\llb 0,n \rrb \setminus S$ factors nontrivially and is divisible by $\{0,\max(S)+1\}$.
%\end{lemma}
%
%\begin{proof}
%Let $c =  \max(S)+1$ and $X = \llb 0, n \rrb \setminus S$.
%By Proposition \ref{prop:cofactors}, it is sufficient to show that $X \subseteq \{0,c\} + X\cap (X-c)$.
%Suppose $x\in X$; if $x \le n-c$ then $x + c \le n$, so that $x+c\in X$ and $x = 0 + x \in \{0,c\} + X\cap(X-c)$.
%If $x \ge n - c$ then $x - c \ge n - c  \ge c$ by assumption, meaning that $\max(S) + 1 \le x - c \le n$, so $x-c\in X$.
%Thus $x-c\in X\cap (X-c)$ and we have $x = c + (x-c) \in \{0,c\} + X\cap (X-c)$, which is what we needed to show.
%\end{proof}
%
%\begin{lemma}\label{reflection}
%Let $r:\PN \to \PN$ be given by $r(X) = \max(X) - X$.
%Then, for any $X\in \PN$, $r$ induces a bijection $\Z_\PN(X) \to \Z_\PN(r(X))$.
%In particular, $X$ is divisible by some $\{0,c\}$ if and only if $\max(X) - X$ is also divisible by $\{0,c\}$.
%\end{lemma}
%
%\begin{proof}
%We will prove that $X = Y + Z$ if and only if $r(X) = r(Y) + r(Z)$.
%This will imply that $X$ is an atom if and only if so is $r(X)$ and, by an inductive extension of the argument, will imply the desired result.
%Actually it will suffice to show only one implication, since $r(r(X)) = \max(X) - (\max(X) -X) = \max(X) - \max(X) + X = X$.
%
%Suppose $X = Y+Z$ for some $Y,Z\in \PN$. 
%Then
%\[ r(X) = \max(X) - X = (\max(Y) + \max(Z)) - (Y+Z) = \max(Y) -Y + \max(Z) -Z = r(Y) + r(Z) \]
%which is all we needed to see.
%\end{proof}
%
%Now we will see some examples in support of the conjecture made at the beginning of this section, which will motivate our work going forward.  
%These will also demonstrate how we wish to use the above lemmas.
%
%\begin{eg}
%\begin{enumerate}[(i)]
%\item If $n\ge 6$ then $\llb 0, n \rrb \setminus \{ k \}$ is divisible by some $\{0,c\}$ for any $k \in \llb 1,n-1 \rrb$.
%\item If $n\ge 18$ then $\llb 0,n \rrb \setminus \{ k , \ell \}$ is divisible by some $\{0,c\}$ for any $k\in \llb 1, n-1 \rrb$.
%\end{enumerate}
%Example (i) is easy enough to verify by hand; since (ii) takes a little more effort, we give an outline here.
%For convenience, suppose $1 \le k < \ell < n - k$, where the very last inequality comes at no loss of generality by Lemma \ref{reflection}.
%Let $X = \llb 0,n \rrb \setminus \{k,\ell\}$; we wish to show that $\{0,c\}$ divides $X$.
%
%We begin first by ruling out the cases when $k>1$ and $\ell-k > 2$, where we can see that $X$ is divisible by $\{0,1\}$.
%The leftover possibilities are that $k=1$ or $\ell - k \le 2$.
%
%\noindent\underline{Case 1A}: If $k = 1$ and $\ell \le 5$, one can see that $\{0,\ell+1\}$ divides $X$ by Lemma \ref{first-third}. \\
%\underline{Case 1B}: If $k = 1$ and $6 \le \ell \le n-4$, $\{0,2\}$ divides $X$. \\
%\underline{Case 1C}: If $k = 1$ and $n-3 \le \ell \le n-1$, the cases $\ell = n-3, n-2$, and $n-1$ can be handled by $c = 4,2$, and $2$, respectively.
%
%\noindent\underline{Case 2A}: If $\ell - k =1$ and $k>1$ then $\{0,1\}$ divides $X$. \\
%\underline{Case 2B}: If $k=1$ and $\ell=2$ then $\{0,3\}$ divides $X$. \\
%\underline{Case 2C}: If $\ell-k = 2$ and $k\ge 4$, $\{0,c\}$ divides $X$. \\ 
%\underline{Case 2D}: If $\{k,\ell\} =\{2,4\}$ or $\{3,5\}$, one can see that $\{0,5\}$ and $\{0,6\}$ divide $X$, respectively (by Lemma \ref{first-third}).
%In particular, the latter of these cases forces the requirement that $n\ge 18$.
%\end{eg}
%This example shows us a small sample of the ways in which removing a small set $S$ of points from $\llb 0,n \rrb$ can thwart the divisibility of $\llb 0,n \rrb\setminus S$ by $\{0,c\}$ for all small values of $c$, if the points of $S$ are chosen carefully.  
%In what lies ahead, we seek to anticipate all ``worst possible" configurations of $S$ to work toward our conjecture.
%
%In addition to determining the threshold value of $n$ beyond which $\llb 0,n \rrb\setminus S$ is divisible by some $\{0,c\}$ for a fixed $|S|$, we might also benefit from investigating the values of $c$ which are viable as divisors of $\llb 0,n \rrb\setminus S$.
%To aid in this, we define some constants.




\newpage
\nocite{*}
\bibliography{bib}
\bibliographystyle{plain}




\end{document}