
\chapter{Techniques in Abelian Groups and Applications} \label{ch:applications}
%%%%%%
%%%%%%
\section{Passage Between Power Monoids}\label{sec:passage}


The natural power monoid $\PN$ is connected to the study of many other power monoids.
In this section we will mention some ways relating the study of $\PN$ to other classes of power monoids.
In some cases, we will be able to \textit{locally transfer} the factorization behavior between $\PN$ and other power monoids, (the meaning of this is made precise in Definition \ref{def:local transfer}).
This yields especially powerful results when we consider $\NN^d$; as we will see in Theorem \ref{thm:passage-to-Nd} that the study of factorizations in $\PN$ is essentially the same as that of $\P_\fon(\NN^d)$.
Highlighting these relationships between $\PN$ and other monoids serves to further motivate the study of both $\PN$ and its relatives.


%\subsection*{Cyclic Groups}

%Abelian groups are a classical setting for combinatorial sumset problems \textcolor{red}{[CITE SOME PAPERS]}.
%By the Fundamental Theorem of Finitely Generated Abelian Groups, all finitely-generated abelian groups can be constructed as direct sums of cyclic groups, so studying the power monoid of a cyclic group can be motivated by the hope to fully understand sumset arithmetic in all abelian groups.

%For any abelian group $G$, $\P_\fin(G)  = \P_\funt(G)$, and we have by Lemma \ref{prop:comm-pm} that the embedding $\P_\fun(G) \hookrightarrow \P_\funt(G)$ is an essentially surjective equimorphism.
%Thus the study of $\P_\fun(G)$ actually encompasses the full study of $\P_\fin(G)$. 

%Section \ref{sec:cyclic-case} tells us about the factorization theory of $\P_\fon(\ZZ/n\ZZ)$, establishing a foothold in the study of subset arithmetic of finite cyclic groups.  
%By analogy, we should study $\P_\fon(\ZZ)$ to complete our understanding of cyclic groups.
%However, it suffices to study $\PN$ by the following:

%\begin{prop}
%	The inclusion $i: \P_\fon(\NN) \hookrightarrow \P_\fon(\ZZ)$ is an essentially surjective equimorphism.
%\end{prop}

%\begin{proof}
%	We can see without much effort that $i$ is essentially surjective; for any $X\in \P_\fon(\ZZ)$, $X - \min(X) \in \PN$.
%	It remains to verify properties \ref{def:equimorphism(E1)}, \ref{def:equimorphism(E2)}, and \ref{def:equimorphism(E3)} of Definition \ref{def:equimorphism}.
%	\ref{def:equimorphism(E1)} is immediate since $i$ is an inclusion map, the other properties follow from Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(iii)} (that is, from the fact that $\PN$ is divisor-closed in $\P_\fon(\ZZ)$).
%\end{proof}


%We have seen just above that studying $\PN$ is sufficient for studying the subset arithmetic of $\ZZ$.



As Fan and Tringali prove in \cite[Theorem 3.8, Theorem 4.11]{fan-tringali18}, all of the factorization information of $\PN$ embeds into \textit{any} non-torsion monoid $H$.
We briefly recall the basic ideas underpinning this fact below.

\begin{prop}\label{prop:natural-to-non-tors}
	Let $H$ be a non-torsion monoid.
	Then there is an equimorphism from $\PN \to \P_\fun(H)$.
\end{prop}
\begin{proof}
	If $H$ is a non-torsion monoid, let $x\in H$ be an element with infinite multiplicative order.  
	Then the map $f: \NN \to \gen{x}$ given by $n\mapsto x^n$ is an isomorphism (specifically, from $(\NN,+)\to (\gen{x},\cdot)$).
	On the level of sets, this yields an isomorphism $f: \PN \to \P_\fun(\gen{x})$.
	In turn, this isomorphism induces an isomorphism $f^*: \F(\A(\PN)) \to \F(\A(\P_\fun(\gen{x})))$.
	As a consequence, for any $X \in \PN$, we have a bijection $f^*: \Z_{\PN}(X) \to \Z_{\P_\fun(\gen{x})}(f(X)) = \Z_{\P_\fun(H)}(f(X))$, where the last inequality follows from Proposition \ref{prop:pm-arith} \ref{it:prop:pm-arith(ii)} (that is, $\P_\fun(\gen{x})$ is divisor-closed in $\P_\fun(H)$).
\end{proof}

Thus the study of factorizations of $\PN$ actually tells us about the factorization of certain subsets of $H$.
Of course, there is much more to be studied in $\P_\fun(H)$ when we include subsets of $\gen{x,y}\subseteq H$, especially when $x$ and $y$ do not commute.
At a minimum, what we have observed above does tell us that every behavior encountered in $\PN$ actually occurs in many more power monoids.

It is not always possible to find a large-scale structural embedding of the factorization behavior of one monoid into another.  
However, it is possible for the study of factorizations of two monoids to be closely linked in a somewhat weaker sense.

\begin{defn} \label{def:local transfer}
Let $H$ and $K$ be monoids. 
We will say that $H$ is \textbf{locally transferrable} to $K$ if, for every non-unit $x\in H$, there is a homomorphism $f: H \to K$ such that 
\begin{enumerate}[label={\rm (\roman{*})}]
	\item $f$ is atom-preserving; for every $a\in \A(H)$, $f(a)\in \A(K)$.
	\item $f^*:\Z_H(x) \to \Z_K(f(x))$ is a bijection (here $f^*$ is identified with the restriction to $\Z_H(x)$ of the induced map $f^*: \F^*(\A(H)) \to \F^*(\A(K))$).
\end{enumerate}
We will refer to $f$ as an $x$-\textbf{transfer} to $K$.
One may also note that, by construction, $f^*:\Z_H(x) \to \Z_K(f(x))$ preserves factorization lengths.
\end{defn}

The remaining results in this section highlight the motivating example for the definition of local transferrability; namely, the monoids $\P_\fon(\NN^d)$ for $d>1$.

\begin{lemma}\label{lem:local-transport}
Let $\varphi: H \to K$ be a homomorphism of (additively written) commutative monoids. 
If $W\subseteq H$ is a subset with the property:
\begin{itemize}
\item[$(*)$] For all $x,y,z\in W$, $\varphi(x) = \varphi(y) + \varphi(z)$ if and only if $x = y + z$.
\end{itemize}
Then we have that
\begin{enumerate}[label={\rm (\roman{*})}]
\item The restriction $\varphi|_W$ is injective.
\item $\varphi:\P_\fon(H) \to \P_\fon(K)$ is an atom-preserving map.
\item The induced map $\varphi:\Z_{\P_\fon(H)}(W) \to \Z_{\P_\fon(K)}(\varphi(W))$ is a length-preserving bijection.
\end{enumerate}
\end{lemma}

\begin{proof}
Point (i) is clear by taking $z = 0$ in property $(*)$.
To see (ii), suppose $A\subseteq W$ and $\varphi(A) = Y+Z$.
Then, since $Y,Z\subseteq \varphi(A)$, we may write $Y = \varphi(B)$ and $Z = \varphi(C)$ for some $B,C\subseteq A$.
For any $a\in A$, $\varphi(a) \in \varphi(B) + \varphi(C)$, so there are $b\in B$ and $c\in C$ with $\varphi(a) = \varphi(b) + \varphi(c)$.
By $(*)$, $a = b + c \in B+C$, so $A \subseteq B + C$.
A nearly identical argument yields the other inclusion, so that $A = B+C$.
Thus, if $A$ is an atom, so too must be $\varphi(A)$. 

For (iii), we wish to see that $\Phi$ is a bijection; we will show that $\Phi$ has an inverse.
Let $\bb = B_1 * \cdots * B_k\in \Z(\varphi(W))$.
Each $B_i = \varphi(A_i)$ for some $A_i\subseteq W$ and, by (i), $\varphi^{-1}(\varphi(A_i)) = A_i$.
This implies that the map sending $\bb \mapsto \varphi^{-1}(B_1) * \cdots * \varphi^{-1}(B_k)$ is inverse to $\varphi^*$, which is all we needed to show.
\end{proof}

\begin{rk}
Note that the property $(*)$ in Lemma \ref{lem:local-transport} is \textit{not} equivalent to the restriction $\varphi|_W$ being injective, because we have not made any assumption of algebraic structure on $W$; in particular, $W$ is not necessarily closed under addition. 
\end{rk}

\begin{prop}\label{prop:flattening}
Let $r \ge 1$ and $W\in \P_\fon(\NN^{r+1})$.
Let $N > 2 \max\{\pi_r(w): w\in W\}$, where $\pi_r: \NN^{r+1} \to \NN$ is the projection map from the $r$th coordinate.
Define $\varphi: \NN^{r+1} \to \NN^r$ by $\varphi(w_1,\dots, w_{r+1}) = (w_1,\dots, w_{r-1},w_r + N w_{r+1})$.
Then
\begin{enumerate}[label={\rm (\roman{*})}]
	\item $\varphi$ is a homomorphism.
	\item For all $x,y,z\in W$, $\varphi(x) = \varphi(y) + \varphi(z)$ if and only if $x = y + z$.
	\item $\varphi*:\Z_{\P_\fon(\NN^{r+1})}(W) \to \Z_{\P_\fon(\NN^r)}(\varphi(W))$ is a bijection.
\end{enumerate}
\end{prop}
\begin{proof}
It is easy to see (i), for this follows from the distributivity of multiplication in $\ZZ$.

Point (ii) will follow from our choice of $N$ (Recall that $N > 2m$, where $m = \max\{\pi_r(w): w\in W\}$).
Let $x,y,z\in W$, writing $x = (x_1,\dots, x_{r+1})$ (and so on), and suppose tha$\varphi(x) = \varphi(y) + \varphi(z)$.
Then we immediately have $x_i = y_i + z_i$ for all $i < r$.
For the $r$th component, we have $x_r + Nx_{r+1} = y_r + Ny_{r+1} + z_r + Nz_{r+1}$, so
$x_r -y_r - z_r = N(y_{r+1}+z_{r+1}-x_{r+1})$.
Since 
\[|x_r - y_r - z_r| \le | |x_r - y_r| - |z_r| | \le |x_r-y_r| + |z_r| \le 2m < N,\]
it must be that both sides of this last equation are equal to zero, so that $x_r = y_r + z_r$ and $x_{r+1} = y_{r+1}+z_{r+1}$.
Now we have $x = y+z$, as we wished.

Finally, (iii) follows from (i) and (ii) by Lemma \ref{lem:local-transport}.
\end{proof}

\begin{thm}\label{thm:passage-to-Nd}
Let $d > 1$. 
Then $\P_\fon(\NN^d)$ is locally transferrable to $\PN$.
\end{thm}
\begin{proof}
We can prove this by inducting on $d$.
Begin with the case $d=2$ and let $X\in \P_\fon(\NN^2)$.
Proposition \ref{prop:flattening} gives us an $X$-transfer to $\varphi:\P_\fon(\NN^2) \to \PN$, so we are done.

Now suppose $d>2$ and assume by way of induction that $\P_\fon(\NN^{d-1})$ is locally transferrable to $\PN$.
Let $X\in \P_\fon(\NN^{d})$.
As above, Proposition \ref{prop:flattening} yields an $X$-transfer $\varphi$ to $\P_\fon(\NN^{d-1})$.
Since we have assumed $\P_\fon(\NN^{d-1})$ to be locally transferrable to $\PN$, there is a $\varphi(X)$-transfer $\psi: \P_\fon(\NN^{d-1}) \to \PN$.
Then $\psi\circ\varphi: \P_\fon(\NN^d) \to \PN$ is an $X$-transfer, so we conclude that $\P_\fon(\NN^d)$ is locally transferrable to $\PN$.
\end{proof}

We will revisit the connection between $\PN$ and the natural lattice in the next section.
For now, we will mention some more connections to other power monoids.

%In this section, we give several reasons which motivate the study of $\PN$, mention some known facts about this monoid, and outline some techniques which can hopefully help us learn more about all aspects of this monoid (and which help us recover some results of Y. Fan and S. Tringali from a different viewpoint).

%We begin by outlining several reasons that, certainly within the scope of power monoids, $\PN$ is a well-motivated and natural setting in which to study factorizations.








\section{Independence Arguments in the Natural Lattice}

Theorem \ref{thm:passage-to-Nd} states that the factorization theory of $\P_\fon(\NN^d)$ is locally included in that of $\PN$.
Thus, to study $\P_\fon(\NN^d)$, we need only look inside $\PN$. 
Another perspective is the following: to study factorizations in $\PN$, we now have access to the space and geometric intuition afforded to us by working inside the $d$-dimensional lattice $\NN^d$.
To make effective use of this intuition, we will formulate and exploit some techniques suitable to this setting.

Throughout this section, all subsets of $\NN^d$ that we instantiate will be assumed to be finite and to contain $0$ (that is, they will be assumed to be elements of $\P_\fon(\NN^d)$).
Furthermore, we will drop the subscripts from the sets of factorizations (resp., lengths) of elements of $\P_\fon(\NN^d)$, as in $\Z(X)$ (resp., $\mathsf{L}(X)$).

\begin{defn}
First we set the notation that, for any subset $X \subseteq \ZZ^d$, $\ZZ X := \gen{X}_{\ZZ^d}$ is the subgroup of $\ZZ^d$ generated by $X$.
We say that subsets $U$ and $V$ of $\NN^d$ are \textbf{$\ZZ$-independent (or $V$ is $\ZZ$-independent from $U$)} if $\ZZ U \cap \ZZ V = \{0\}$.

We will say that subsets $U_1,\dots, U_n\subseteq \NN^d$ are \textbf{(totally) $\ZZ$-independent} if, for every pair of disjoint subsets $I,J\subseteq\llb 1,n \rrb$, $\sum_{i\in I} U_i$ and $\sum_{j\in J} U_j$ are $\ZZ$-independent.
\end{defn}

We begin by outlining some basic properties of $\ZZ$-independence.  
More often than not, we will use these without mention, or by simply citing ``$\ZZ$-independence."
\begin{prop} \label{prop:eltwise-indep}
Let $u_1,\dots, u_k\in \NN^d$ be nonzero elements.
\begin{enumerate}[label={\rm (\roman{*})}]
	\item $\{u_1,\dots,u_k\}$ is a $\ZZ$-linearly independent set if and only if $\{0,u_1\},\dots,\{0,u_k\}$ are totally $\ZZ$-independent.
	
	\item If $\sum_i u_i = 0$ then $u_i = 0$ for all $i=1,\dots, k$.
	
	\item If $U_1,\dots, U_k$ are totally $\ZZ$-independent and $u_i, v_i\in U_i$ for each $i\in \llb 1,k \rrb$,
	then $\sum_i u_i = \sum_i v_i$ implies that $u_i = v_i$ for $i = 1,\dots, k$.
\end{enumerate}
\end{prop}

\begin{proof}
(i) is a straightforward exercise in the definition of total $\ZZ$-independence and (ii) is simply a consequence of $H$ being a reduced monoid.

For (iii), we can induct on $k$.
The result is trivial if $k = 1$, so let $k=2$.
$u_1 + v_1 = u_2 + v_2$ implies that $u_1 - v-1 = v_2 - u_2 \in \ZZ U_1 \cap \ZZ U_2 = \{0\}$, so $u_1 = v_1$ and $u_2 = v_2$.

For the inductive step, suppose $k>2$ and that the result holds for integers smaller than $k$.
The equation $\sum_i u_i = \sum_i v_i$ implies that $u_1 - v_1 = \sum_{i\ge 2} (v_i - u_i)$, and we have that 
\[u_1 - v_1 \in \ZZ U_1 \cap \ZZ(U_2+\cdots+U_k) = \{0\},\]
yielding that $u_1 = v_1$ and $\sum_{i\ge 2} u_i = \sum_{i\ge 2} v_i$.
By induction, the last equation implies that $u_i = v_i$ for all $i$ and we are done.
\end{proof}

\begin{prop} \label{prop:indep-decomp}
Let $U,V \subseteq \NN^d$ be $\ZZ$-independent and let $A_1,\dots, A_k$ be nonzero subsets with $U+V = \sum_{i=1}^k A_i$.
\begin{enumerate}[label={\rm (\roman{*})}]
	\item $U_j = \sum_{i=1}^k U_j\cap A_i$.
	\item If $U \cap A_i = \{0\}$ then, for any $V'\subseteq V$, $(U+V')\cap A_i = V'\cap A_i$.
	\item For each $i$, $U\cap A_i \neq \{0\}$ or $V \cap A_i \neq \{0\}$.
	\item $k \le \max \mathsf{L}(U) + \max \mathsf{L}(V)$.
\end{enumerate}
\end{prop}

\begin{proof}
(i) For each $i$, let $u_i\in U\cap A_i$.
Then $\sum_i u_i \in \sum_i A_i = U+V$, and there are $u\in U$ and $v\in V$ with $\sum_i u_i = u+v$.
By Proposition \ref{prop:eltwise-indep}(ii), $v = 0$ and $\sum_i u_i = u \in U$

The other inclusion is similar; for any $u\in U \subseteq \sum_i A_i$, we can find $u_1,\dots,u_k\in U$ and $v_1,\dots, v_k\in V$ such that $u_i+v_i\in A_i$ for each $i$ and $u = \sum_i (u_i + v_i)$.
Again by Proposition \ref{prop:eltwise-indep}(ii), $\sum_i v_i = 0$, and each $v_i = 0$ by Proposition \ref{prop:eltwise-indep}(i).

Moving on to (ii), it is sufficient to prove the result for $i=1$ by renumbering the $A_i$ if necessary.
Suppose $u\in U$, $v\in V'$, and $u+v\in A_1$.
Since $U\cap A_1 = \{0\}$, we know from (i) that
\[ U = \sum_{i\ge 1} U\cap A_i = \sum_{i\ge 2} U\cap A_i, \]
so $u+v + U \subseteq A_1 + \sum_{i\ge 2} A_i \subseteq U+V$.
Thus, for any $w\in U$, there are $u'\in U$ and $v'\in V$ so that $u+v+w = u'+v'$.
By the $\ZZ$-independence of $U$ and $V$, $v' = v$ and so we actually have that $u+v+U \subseteq U + v$.
We can cancel $v$ to get $u+U \subseteq U$.
Since $|u+U| = |U| <\infty$, we must actually have $u+U = U$; however, this implies that $u = 0$.
We now have that $v = u+v \in A_1$, so $(U+V')\cap A_1 \subseteq V' \cap A_1$.
The reverse inclusion is trivial since $0\in U$, so we are done.

(iii) follows quickly from (ii); suppose $U\cap A_i = \{0\} = V\cap A_i$.
Then $A_i = (U+V)\cap A_i = V\cap A_i = \{0\}$ (we used (ii) at the second equal sign).

Finally, for (iv): let $\ell = \max \mathsf{L}(U)$ and $m = \max\mathsf{L}(V)$.
Without loss of generality, say $\llb 1,s \rrb = \{i: U\cap A_i \neq \{0\} \}$ and $\llb t,k \rrb = \{i: V\cap A_i \neq \{0\} \}$.
Since, by (i), $U = \sum_i U\cap A_i = \sum_{i\le s} U \cap A_i$, $| \llb 1,s \rrb | \le \ell$ (similarly, $|\llb t,k \rrb| \le m$).
By (iii), $\llb 1,k \rrb = \llb 1,s \rrb \cup \llb t,k \rrb$, so $k \le \ell + m$ as we wished.
\end{proof}

\begin{lemma} \label{lem:indep-atom-decomp}
Let $U, V_1,\dots, V_m\subseteq \NN^d$ be totally $\ZZ$-independent.
Suppose each $V_j$ is an atom, and let $V := \sum_j V_j$.
Further suppose that $A_1,\dots, A_k$ are nonzero subsets with $U+V = \sum_{i=1}^k A_i$.
\begin{enumerate}[label={\rm (\roman{*})}]
	\item There is a function $f: \llb 1,m \rrb \to \llb 1,k \rrb$ with $V_j \subset A_{f(j)}$ for each $j\in \llb 1,m\rrb$.
	\item For each $h\in \llb 1,k\rrb$, $V\cap A_h = \sum\limits_{j\in f^{-1}(h)} V_j$.
	\item For each $h\in \llb 1,k\rrb$, $\left( \sum\limits_{j\notin f^{-1}(h)} V_j \right) \cap A_h = \{0\}$.
\end{enumerate}
\end{lemma}

\begin{proof}
For (i), fix $j\in \llb 1,m \rrb$.
Then, by Proposition \ref{prop:indep-decomp}(i), $V_j = \sum_i V_j \cap A_i$.
Since $V_j$ is an atom, only one summand on the right side of this equation can be zero; let $f(j)$ denote the index of that summand.
Then we have $V_j = V_j \cap A_{f(j)} \subseteq A_{f(j)}$.

To prove (ii), let $J := f^{-1}(h) = \{j: V_j \subseteq A_h\}$ and call $V' = \sum_{j\in J} V_j$.
Similarly, let $K = \llb 1,m \rrb \setminus J$ and call $V'' = \sum_{j\in K} V_j$.
Because $V_1,\dots, V_m$ are totally $\ZZ$-independent, $V'$ and $V''$ are $\ZZ$-independent.

For each $j\in J$ and each $i\neq h$, $V_j\cap A_i = \{0\}$. 
An easy induction on $|J|$ then yields that $V' \cap A_i = \{0\}$ for each $i\neq h$.
As a result, we have (using Proposition \ref{prop:indep-decomp}(i)) that $V' = \sum_i V'\cap A_i = V' \cap A_h$.

On the other hand, for $j\in K$, $V_j\cap A_h = \{0\}$, so $(V' + V_j) \cap A_h = V' \cap A_h$ (using Prop \ref{prop:indep-decomp} (ii)).
By induction on $|K|$, we can see that $V'' \cap A_h$ = 0, so that $A_h = V\cap A_h = (V' + V'')\cap A_h = V' \cap A_h = V'$, completing the proofs of both (ii) and (iii).
\end{proof}

\begin{thm} \label{thm:ind-atoms}
If $V_1,\dots,V_m\subseteq \NN^d$ are totally $\ZZ$-independent then $V_1+\cdots+V_m$ factors uniquely (up to reordering of factors).
\end{thm}

\begin{proof}
Let $V = V_1+\cdots + V_m$.
The result will essentially follow from Lemma \ref{lem:indep-atom-decomp}, taking $U = \{0\}$.

Let $A_1,\dots, A_k$ be atoms with $V = \sum_i A_i$.
As in Lemma \ref{lem:indep-atom-decomp}(i), there is $f:\llb 1,m \rrb \to \llb 1,k\rrb$ with $V_j \subseteq A_{f(j)}$ for each $j\in \llb 1,m\rrb$.
We wish to show that $f$ is injective; let $h\in \llb 1,k \rrb$ and let $J = f^{-1}(h)$.
By Lemma \ref{lem:indep-atom-decomp}(ii), $A_h = V \cap A_h = \sum_{j\in J} V_j$, which is only an atom if $|J|=1$, making $f$ injective.  

We have shown more; we in fact have, for each $j\in \llb 1,m \rrb$, $V_j = A_{f(j)}$.
All that remains to see is that $f$ is a surjection.
To see this, suppose $A_i \notin f(\llb 1,m \rrb)$.
Then $V_j \cap A_i = \{0\}$ for all $j\in  \llb 1,m \rrb$, and we have by Proposition \ref{prop:indep-decomp}(ii) and induction that $A_i = \{0\}$.
However, this is impossible since $A_i$ is an atom.  

We conclude that $f$ is a bijection and that the only factorization of $V$ (up to reordering) is $V_1*\cdots*V_m$.
\end{proof}

\begin{eg} \label{eg:recover-flat-unique-fac}
Theorem \ref{thm:ind-atoms} allows us to partially recover \cite[Proposition 4.9]{fan-tringali18}.
We recall here the content of Fan and Tringali's result: Let $a_1,\dots, a_\ell \in \NN$ such that $a_1 + \cdots + a_i < \frac{1}{2} a_{i+1}$ for $i\in \llb 1,\ell-2 \rrb$ and (if $\ell \ge 2$) $a_1+\cdots + a_{\ell-1} < a_\ell - a_{\ell-1}$.
Then $\Z(\{0,a_1\}+\cdots+\{0,a_\ell\}) = \{ \{0,a_1\}*\cdots*\{0,a_\ell\}\}$.

There are many sequences of integers $a_1,\dots,a_\ell$ satisfying the specified properties; for simplicity, let us use the sequence given by $a_i = b^{i-1}$, for some integer $b \ge 3$.

For $i\in \llb 1,\ell \rrb$, let $e_i \in \NN^\ell$ be the $i$th standard basis vector (whose entries are all zero, except for a $1$ in the $i$th coordinate).
Let $V = \{0,e_1\} + \cdots + \{0,e_\ell\}$; by Theorem \ref{thm:ind-atoms}, $V$ factors uniquely.
We will follow the procedure given in Theorem \ref{thm:passage-to-Nd} to ``flatten" $V$ into a subset of $\NN$ which still factors uniquely.
According to this procedure, we need maps $\NN^\ell \to \NN^{\ell-1} \to \dots \to \NN$.

For $i\in \llb 1,\ell-1 \rrb$, define $\varphi_i: \NN^{i+1} \to \NN^{i}$ by $v \mapsto \hat{v} + be_{i}$ (where $\hat{v}$ is the vector consisting of the first $i$ components of $v$, and we have identified $e_i$ with the $i$th standard basis vector in $\NN^i$).
Let $V_\ell = V$ and $V_i = \varphi_i(V_i+1)$ for $i <\ell$.
By Proposition \ref{prop:flattening}, $\varphi_i$ is a homomorphism which essentially preserves the set of factorizations of $V_{i+1}$.
Letting $\varphi := \varphi_1\circ \cdots \circ \varphi_{\ell-1}$, we have that $U := \varphi(V)$ factors uniquely.

To see what elements actually comprise $U$, it is enough to check the value of $\varphi$ on $e_1,\dots, e_\ell$ (since $\varphi$ is a homomorpism).
It is not too difficult to see that $\varphi(e_i) = b^{i-1}$, so that $U = \{0,1\}+\{0,b\}+\cdots+\{0,b^{\ell-1}\}$ which is indeed already known to factor uniquely by Fan and Tringali's result.
\end{eg}

We the end this section with a result with a result asserting some degree of compatibility between uniqueness of factorization and $\ZZ$-independence.

\begin{thm} \label{thm:unique longest factorization}
Let $U\in \P_\fon(\NN^d)$ be an element whose two longest factorizations have lengths $\ell < N$.
Suppose $V_1,\dots,V_m\subseteq \NN^d$ are atoms so that $U,V_1,\dots, V_k$ are totally $\ZZ$-independent.
Further assume that $U$ has a unique longest factorization (of length $N$).
Then $\mathsf{L}(U+V_1+\cdots+V_k) \cap \llb \ell+1,\infty \rrb = \{N+m\}$.
\end{thm}

\begin{proof}
For convenience, let $V := V_1 + \cdots + V_m$.
Suppose that $k > \ell + m$ and that there are atoms $A_1,\dots,A_k$ with $U+V = A_1 + \cdots + A_k$.
By Proposition \ref{prop:indep-decomp}(iv), we know that $k \le N+m$.

By Proposition \ref{prop:indep-decomp}(iii), we can say (renumbering if necessary)
\[ \llb 1,s \rrb =  \{ i: U\cap A_i \neq\{0\}\} \quad \textrm{and} \quad \llb t,k \rrb = \{i: V\cap A_i \neq \{0\}\}. \]
Since we know that $\llb 1,k \rrb = \llb 1,s \rrb \cup \llb t,k \rrb$, we know that $t \le s+1$.
The arguments to follow hinge on whether these two intervals overlap.  
First suppose that the intervals overlap; i.e., that $t \le s$.
We will show that this cannot happen by showing that, in this case, $A_s$ is not an atom.

Let $J = \{ j: V_j \subseteq A_s \}$ and set $V' = \sum_{j\in J} V_j$; we know by Lemma \ref{lem:indep-atom-decomp} that $V' = V \cap A_s$.
Also let $K = \llb 1,m \rrb \setminus J$ and $V'' = \sum_{j\in K} V_j$.

\noindent\underline{Claim A}: $V' = V\cap A_s$ and $V'' \cap A_s = \{0\}$. \label{cla}

This follows directly from Lemma \ref{lem:indep-atom-decomp}(ii),(iii).

\noindent\underline{Claim B}: $A_i \subseteq U$ for $i<t$ and $A_i \subseteq V$ for $i > s$. \label{clb}

Proposition \ref{prop:indep-decomp}(ii) implies both statements since $V \cap A_i = \{0\}$ for $i<t$ (and $U\cap A_i = \{0\}$ for $i>s$).

\noindent\underline{Claim C} For $v\in V$, $U+v = \sum\limits_{i<s} U\cap A_i + (U+v)\cap A_s$. \label{clc}

We move to show both inclusions.
First suppose $u\in U$. 
Then $u+v \in \sum_{i=1}^\ell A_i$, and we can find $u_1,\dots, u_s\in U$ and $v_t,\dots, v_k\in V$ so that
$u_i\in A_i$ if $i < t$, $u_i + v_i \in A_i$ if $t\le i \le s$, and $v_i \in A_i$ if $i > s$.
Then we will have
\[u+v = \sum_{i<t} u_i + \sum_{i=t}^{s} (u_i+v_i) + \sum_{i > s} v_i, \]
whence the $\ZZ$-independence of $U,V_1,\dots,V_m$ implies that $u = \sum_{i\le s} u_i$, $v_s = v$, and $v_i = 0$ for all $i\neq s$.
Now $u+v = \sum_{i<s} u_i + (u_s+v)\in \sum_{i<s} U\cap A_i + (U+v)\cap A_s$.

For the other inclusion, let $u_1,\dots, u_s\in U$ with $u_i\in A_i$ for all $i<s$ and $u_s + v\in A_s$.
Then $\sum_{i\le s} u_i +v \in \sum_{i\le s} A_i \subseteq U+V$, so we can find $u'\in U$ and $v'\in V$ with 
\[\sum_{i\le s}u_i + v = u' + v',\]
at which point we can use $\ZZ$-independence again to see that $v' = v$, so that $\sum_{i\le s} u_i + v\in U+v$.

\noindent\underline{Claim D}: $(U+v)\cap A_s = U\cap A_s + v$. \label{cld}

We can write $(U+v)\cap A_s = A + v$ for some $A \subseteq U$.
Now $U+v = \sum_{i<s} U\cap A_i + (U+v)\cap A_s = \sum_{i<s} U\cap A_i + A + v$.
We can cancel $v$ from both sides of this set equality (since $v$ is a unit in $\P_\fon(\ZZ^n)$), yielding
\[ U = \sum_{i<s} U\cap A_i + A. \tag{D1}\]
On the other hand, we also have that
\[ U = \sum_{i<s} U\cap A_i + U\cap A_s. \tag{D2}\]
We will now show that we can cancel the common factors that appear in these two decompositions.

First, as an aside, note that $t > \ell$.
If this were not the case and $t \le \ell$, then $k = | \llb 1,s \rrb \cup \llb t,k \rrb | \le \ell + | \llb t,k \rrb | \le \ell+m$, which contradicts our intial assumption about $k$.

This is significant because $\sum_{i<t} U\cap A_i = \sum_{i<t} A_i$ is a sum of at least $\ell+1$ atoms, and $U$ has only one factorization consisting of more than $\ell$ atoms.
Say $B_1,\dots, B_{N}$ are the atoms with $U = \sum_{i=1}^{N} B_i$.
Then, by renumbering if needed, there is some $h$ for which $\sum_{i<s} U\cap A_i = B_1 + \cdots + B_h$.

Consequently, by the uniqueness of the atoms $B_i$, it must be that $B_1 +\cdots + B_h$ can be cancelled in the decompositions (D1) and (D2), leaving
\[ A = B_{h+1} +\cdots+ B_{N} = U\cap A_s, \]
and we have proved the claim.

\noindent\underline{Claim E}: $A_s$ is not an atom. \label{cle}

To see this, we compute
\begin{align*}
A_s = (U+V)\cap A_s 
&= (U+V'+V'') \cap A_s \\
&= (U+V') \cap A_s \tag{by Claim A and Proposition \ref{prop:indep-decomp}} \\
&= \bigcup_{v\in V'} (U+v)\cap A_s \\
&= \bigcup_{v\in V'} (U\cap A_s + v) \tag{by Claim D} \\
&= U\cap A_s + V'.
\end{align*}
Since $U\cap A_s$ and $V' = V\cap A_s$ are both nonzero, $A_s$ is not an atom.
This is a contradiction which followed from our assumption that some of the $A_i$ may intersect nontrivially with \textit{both} $U$ and $V$.

Now suppose this does not occur; necessarily, $s < t$ and we in fact have that $t = s+1$ by Proposition \ref{prop:indep-decomp}(iii).
For $i \le s$, since $V\cap A_i  = \{0\}$, Proposition \ref{prop:indep-decomp}(ii) implies that $A_i = (U+V)\cap A_i = U\cap A_i \subseteq U$.
Then we have, by Proposition \ref{prop:indep-decomp}(i), that $U = \sum_{i\le s} U\cap A_i = \sum_{i\le s} A_i$.
This means that $s\in \mathsf{L}(U)$ and, by identical reasoning for $V$, that $| \llb t,k \rrb| = m$.
We conclude that $k \in \mathsf{L}(U) + m$ and, due to the assumption that $k>\ell+m$, it must be the case that $k = N + m$.
\end{proof}


\section{Length Sets in High-Dimensional Lattices}
In this section, we wish to show that certain prescribed sets occur as sets of lengths of elements of $\P_\fon(\NN^d)$ (and hence as sets of lengths of elements of $\PN$).
First, we will recover a version of \cite[Proposition 4.10]{fan-tringali18} which says that, for any $n\ge 2$, there is an element $U$ which has exactly two factorizations: one of length $2$, and one of length $n+1$.
Then we will extend this construction to a class of constructions which realizes some new sets of lengths.

We will be working with a particular construction for most of this section, so we take a moment to set some notation.

\begin{defn} \label{def:two-fac-construction}
Fix an integer $n\ge 2$ and let $d\ge n$.
For $i\in \llb 1,n\rrb$, let $e_i \in \NN^d$ be the $i$th standard basis vector, whose components are all zero except for a single $1$ in the $i$th coordinate.

For any $I \subseteq \llb 1,n \rrb$, we will let $e_I := \sum_{i\in I} e_i$.
Further, let $f := e_{\llb 1,n \rrb} = \sum_{i=1}^n e_i$ and let $g := f + e_n$.
Finally, we set
\[U_{n+1} := \sum_{i=1}^n \{0,e_i\} + \{0,g\}.\]
\end{defn}

We will show (in Theorem \ref{thm:2n-length-set}) that $U_{n+1}$ has exactly two factorizations. 
Before proving this fact or making use of it, we construct a class of atoms which will continue to appear through the remainder of the section.

\begin{lemma} \label{lem:large-atom-two-fac}
Let $U_{n+1}$ be as in Definition \ref{def:two-fac-construction}, and let $V\subseteq \NN^d$ be $\ZZ$-independent from $U_{n+1}$.
Then the set
\[ B:= \left( \sum_{i=1}^{n-1} \{0,e_i\} + \{0,g\} + V \right) \cup \{f\} \]
is an atom.
\end{lemma}

\begin{proof}
Suppose that $B = X + Y$.
It will suffice to prove that one of $X$ or $Y$ is equal to $\{0\}$.
Observe first that $f$ cannot be written as a sum of two or more elements of $B$, since $f\notin \operatorname{span}_\ZZ (\{e_1,\dots, e_{n-1}\}\cup V)$ and the $e_n$ coefficient of $g$ is larger than that of $f$.

One can also see that $g$ cannot be written as a sum of two or more elements of $B$.
As above, $g\notin \operatorname{span}_\ZZ (\{e_1,\dots, e_{n-1}\}\cup V)$.
The only remaining possibility is that $f$ is included at least twice in the sum so that $g = 2f + b$ for some $b\in B$.
This is impossible, as the $e_1$ coefficient of $2f+b$ is at least $2$, whereas that of $g$ is $1$.

We conclude from these observations that $f,g\in X \cup Y$.
Noting that $f+g \notin B$, we may say (without loss of generality) that $f,g\in X$.
Now we aim to show that $Y = \{0\}$.
Suppose $b := \varepsilon g + e_I +v \in Y$ for some $\varepsilon \in \{0,1\}$, $I\subseteq \llb 1,n-1\rrb$, and $v\in V$.
Then we must have $f + b \in X+Y = B \subseteq U_{n+1} + V$, so choose some $u'\in U_{n+1}$ and $v'\in V$ with $f + b = u' + v'$.
By the $\ZZ$-independence of $U_{n+1}$ and $V$, it must be that $v' = v$ and $f + \varepsilon g + e_I = u' \in U_{n+1} \cap B$.

We can finish the proof by noting that the only element of $U_{n+1}\cap B$ with an odd $e_n$ coefficient is $f$, meaning that $\varepsilon=0$ and $I = \emptyset$.
Then $f+b = f+v \in B$, at which point we see that $v = 0$.
Thus $Y = \{0\}$ as we wished.
\end{proof}

\begin{thm} \label{thm:2n-length-set}
Let $n\ge 2$ and let $e_1,\dots, e_n\in \NN^n$ be $\ZZ$-linearly independent.
Set $f = \sum_{i=1}^n e_i$, $g=f+e_n$.
Letting $U = \sum_{i=1}^n \{0,e_i\} + \{0,g\}$, we have 
\[\Z_{\P_\fon(\NN^n)}(U) = \left\{ \{0,e_1\}*\cdots*\{0,e_n\}*\{0,g\}, \left[\sum_{i=1}^{n-1}\{0,e_i\}+\{0,g\}\right]\cup\{f\} * \{0,e_n\} \right\}. \]
\end{thm}

\begin{proof}
Suppose $U = X + Y$ for some $X,Y\subseteq U$ with $X,Y\neq \{0\}$.
First we set some notation by analogy with the proof of \cite[Theorem 4.10]{fan-tringali18}: $I_X := \{i\in \llb 1,n \rrb: e_i\in X\}$, $I_Y := \{i\in \llb1,n \rrb: e_i\in Y \}$.
For further convenience and compactness, we let $e_I := \sum_{i\in I}e_i$ for any $I\subseteq \llb 1,n \rrb$.

Begin by noting that $\llb 1,n \rrb = I_X \sqcup I_Y$; indeed, for each $i\in\llb 1,n \rrb$, $e_i\in X+Y$, and it must be that $e_i\in X\cup Y$ since all the $e_i$ are linearly independent.  
Moreover, we cannot have $e_i\in X\cap Y$ since $2e_i \notin C = \{e_I : I\subseteq \llb 1,n \rrb \}$.

To prove some of the claims which follow, we will use a basic understanding of which linear combinations of the $e_i$ appear as elements of $U$.
Every element of $U$ has one of the following forms:
\begin{enumerate}[label={\rm (F\arabic{*})}]
\item $e_I$: the coefficient to each $e_i$ is either $0$ or $1$.
\item $g+e_I$: the $e_n$ coefficient is either $2$ or $3$, and all other $e_i$-coefficients are either $1$ or $2$.
\end{enumerate}

We now wish to determine the structure of $X$ and $Y$.
For the ease of understanding the argument, we state and prove several small claims about $X$ (which will also hold for $Y$ by symmetry).

\noindent\underline{Claim A}: If $I\subseteq I_X$ then $e_I\in X$. 

Suppose $I = J\sqcup K$ with $e_J\in X$ and $e_K\in Y$.
If $K\neq \emptyset$ then let $k\in K\subseteq I_X$; we have $2e_k + e_{K\setminus\{k\}} = e_k + e_K\in X+Y$, which is impossible unless $K = \llb 1,n\rrb$, so that $e_K = f$.
However, since $1\in K\subseteq I\subseteq I_X$, this implies that $2e_1 + e_{K\setminus\{k\}} = e_1 + e_K\in X+Y$, a contradiction.

\noindent\underline{Claim B}: For $I\subsetneqq \llb 1,n \rrb$, $e_I\in X$ only if $I\subseteq I_X$.

Suppose $K := I \cap I_Y$ is nonempty (otherwise, we are done).
Then $e_{I\setminus K} + 2e_K = e_I + e_K \in X +Y$ has at least one coefficient equal to $0$ and at least one coefficient $\ge 2$, which is a contradiction.

\noindent\underline{Claim C}: If $g + e_I\in X$ then $e_I\in X$. 

Let $K := I\cap I_Y$; then $g + e_{I\setminus K} + 2e_K = (g+e_I) + e_K \in X+Y$, which is not possible unless $K=\emptyset$ (since no element of $U$ has more than one coefficient $>2$).
This implies the desired conclusion.

\noindent\underline{Claim D}: Exactly one of $X$ or $Y$ has an element of the form $g + e_I$. 

This is easy to see; if neither $X$ nor $Y$ has such an element then no element of $X+Y$ has a coefficient larger than two.
On the other hand, if $g+e_J\in X$ and $g+e_K\in Y$ then $2g + e_J + e_K \in X+Y$, which is a contradiction since this element has an $e_n$-coefficient $\ge 4$.

\noindent\underline{Claim E}: If $g+ e_H\in X$ for some $H\subseteq \llb 1,n \rrb$ then $g + e_I \in X$ for every $I\subseteq I_X$ with $I\subsetneqq \llb 1,n\rrb$. 

%First note that if $H = \llb 1,n \rrb$ then $g+f\in X$ and so $Y = \{0\}$.
%It must be that $H\subsetneqq \llb 1,n \rrb$.
Let $I \subseteq I_X$ with $I\subsetneqq \llb1,n\rrb$.
Since $g+e_I\in U = X+Y$, we may write $g+e_I = x +y$ with $x = \delta g + e_J\in X$ (for $\delta\in \{0,1\}$) and $y=e_K\in Y$ by (D).
Now $g + e_I = \delta g + e_J + e_K$.
\begin{itemize}
\item[\underline{Case 1}:] If $\delta = 1$ then $e_I = e_J + e_K$, hence $I = J\sqcup K$. 
Since $I\neq \llb1,n\rrb$, $K\subsetneqq \llb 1,n \rrb$ and so $K\subseteq I_Y$ by (B).
However, we now have that $K = \emptyset$ since $K\subseteq I \subseteq I_X$.
Thus $g + e_I = g + e_J \in X$, as we wished.
\item[\underline{Case 2}:] If $\delta = 0$ then $g + e_I = e_J + e_K$, and the only possibility is that $I = \llb 1,n-1\rrb$ and $J = K = \llb 1,n\rrb$ (so $e_J = e_K = f$).
However, since $\llb 1,n-1 \rrb \subseteq I_X$, we have $e_1 + f \in X+Y$, which is a contradiction (no element of $U$ has an $e_n$-coefficient of $1$ and an $e_1$-coefficient of $2$), finishing the proof of the claim.
\end{itemize}

Assume without loss of generality that $g\in X$.
If $I_X = \emptyset$ then $X = \{0,g\}$ and $Y = \sum_{i=1}^n \{0,e_i\}$ by Claim A.
By Theorem \ref{thm:ind-atoms}, $Y$ factors uniquely and we have $\{0,e_1\}*\cdots \{0,e_n\}*\{0,g\}\in \Z_{\P_\fon(\NN^n)}(U)$.

Now suppose $I_X \neq \emptyset$.
Then, by Claims (C) and (E), 
\[X \supseteq \{0,g\} + \sum_{i\in I_X} \{0,e_i\} \tag{1} \label{factor-includes} \]
We can completely determine the structure of $Y$.
First observe that we cannot have $f=e_{\llb1,n\rrb}\in Y$ since we would then have $(g+e_{I_X})+f \in X+Y$, but this is not an element of $U$.
This allows us to use Claim (B), as well as (A) and (D), to say that $Y = \sum_{i\in I_Y} \{0,e_i\}$.

With this, we can say more about the structure of $X$.
By Proposition \ref{prop:cofactors}, we have 
\[X \subseteq U\:Y = \bigcap_{y\in Y}(U-y) = \bigcap_{K\subseteq I_Y} \underbrace{\{e_I - e_K, g+e_I - e_K : I\subseteq \llb 1,n \rrb \}}_{=:U_K} \]

Recalling the forms (F1) and (F2) of all elements of $U$ that we outlined earlier, we can similarly express the forms of elements of $U\:Y$:
\begin{enumerate}[label={\rm (F\arabic{*}$'$)}]
\item $e_I$ for $I\subseteq I_X$. 
To see this, observe that $e_I = e_{I\cup K}-e_K\in U_K$ for any $K\subseteq I_Y$.
On the other hand note that, for $H \subseteq \llb 1,n \rrb$ with $H\cap I_Y\neq \emptyset$, $g+e_H\notin U_{H\cap I_Y}$, so these are the only elements of form (F1) which remain in $U\:Y$.
%
%for each $k\in I_Y$, every element of the form $e_I - e_k\in U_{\{k\}}\cap U$ has $e_k$ coefficient of zero.
%In the intersection of the $U_K$ over all $K\subseteq I_Y$, we are left only with the elements whose $e_i$ coefficients are $0$ for all $i\in I_Y$.
\item $g+e_I$ for $I\subseteq I_X$.
For this, we observe $g+e_{I\cup K} - e_K\in U_K$. 
Similar to the argument just above, we see that $g+e_H\notin U_{H\cap I_Y}$ whenever $H\cap I_Y\neq\emptyset$.
\item $f\in U\:Y$ only if $I_Y = \{n\}$.
First, it is clear that $f = e_{\llb 1,n \rrb} \in U_\emptyset$.
For any $K\subseteq I_Y$ with $n\in K$, $f = g+ e_{K\setminus\{n\}} - e_K\in U_K$.
However, if $n\notin K$ but $K$ is non-empty, then $f\notin U_K = \{e_I, g+e_I-e_K: I\subseteq \llb1,n\rrb\}$.
This is because $e_I - e_K \neq f$ (since $K$ is non-empty), and $g+e_I-e_K$ has an $e_n$ coefficient larger than $1$ (since $n\notin K$).
\end{enumerate}
We now have, combining our work here with (\ref{factor-includes}) above, that
\[ \{0,g\} + \sum_{i\in I_X}\{0,e_i\} \subseteq X \subseteq U\:Y \subseteq \left[\{0,g\}+\sum_{i\in I_X} \{0,e_i\} \right]\cup\{f\},\]
so we have determined $X$ almost exactly, up to the choice of whether $f\in X$.

Before discussing the possible factorizations of $X$, recall that $Y = \sum_{i\in I_Y} \{0,e_i\}$ and so $Y$ factors uniquely (by Theorem \ref{thm:ind-atoms}) as the sum of the $\{0,e_i\}$ for $i\in I_Y$.

Now we turn to $X$; first suppose $f\notin X$.
Then $X = \{0,g\} +\sum_{i\in I_X} \{0,e_i\}$, which has a unique factorization (by Theorem \ref{thm:ind-atoms}) as the sum of $\{0,g\}$ and the $\{0,e_i\}$ for $i\in I_X$.
This can only produce -- up to reordering, of course -- the factorization $\{0,g\}*\{0,e_1\}*\cdots*\{0,e_n\}\in \Z_{\P_\fon(\NN^n)}(U)$.

If $f\in X$, then $X = \left[\{0,g\}+\sum_{i\in I_X} \{0,e_i\} \right]\cup\{f\}$ (and $Y = \{0,e_n\}$ per our considerations in (F3$'$)).
By Lemma \ref{lem:large-atom-two-fac}, $X$ is an atom, producing the factorization $X*\{0,e_n\}\in \Z_{\P_\fon(\NN^n)}(U)$ and completing the proof.
\end{proof}


\begin{rk}
In the same vein as Example \ref{eg:recover-flat-unique-fac}, one may use Theorem \ref{thm:2n-length-set} to recover some cases of \cite[Proposition 4.8]{fan-tringali18}.
\end{rk}


\begin{cor} \label{thm:int-point-construction}
Fix $n\ge 2$ and $m\ge 1$, and let $V_1,\dots, V_m \subseteq \NN^d$ be atoms such that $U_{n+1},V_1,\dots, V_m$ are totally $\ZZ$-independent.
Then $\mathsf{L}(U_{n+1}+V_1+\cdots+V_m) = \llb 2,m+2 \rrb \cup \{m+n+1\}$.
\end{cor}

\begin{proof}
For convenience, let $U := U_{n+1}$ and $V := V_1 + \cdots + V_m$.
We will start by verifying the values that most clearly belong to $\mathsf{L}(U+V)$.
It is easiest to see that $m+n+1 =\max\mathsf{L}(V)+\max\mathsf{L}(U) \in \mathsf{L}(U+V)$.
For the rest, suppose $0\le h \le m$.
Then, by Lemma \ref{lem:large-atom-two-fac}, 
\[B_h := \left( \sum_{i=1}^{n-1} \{0,e_i\} + \{0,g\} + \sum_{j\in \llb h+1,m \rrb} V_j \right) \cup \{f\} \]
is an atom.
From here, it is straightforward to check that
\[ U+ V = \{0,e_n\} + B_h + V_1 + \cdots + V_h \]
so $h+2 \in \mathsf{L}(U+V)$.
As we allow $h$ to range over $\llb 0,m \rrb$, we get that $\llb 2,m+2 \rrb \in \mathsf{L}(U+V)$.

For the other inclusion, we need to show that no other values are included in $\mathsf{L}(U+V)$.
To do this, we note that $U$ has a unique longest factorization by Theorem \ref{thm:2n-length-set} and hence, using Theorem \ref{thm:unique longest factorization}, $\mathsf{L}(U+V) \cap \llb m+3, m+n+1 \rrb = \{m+n+1\}$.
\end{proof}



