\chapter{Minimal Factorizations and Applications to Power Monoids} \label{ch:minimal factorizations}
\section{Fundamentals of Minimal Factorizations}
\label{sec:minimal-factorizations}
%
	
%
Example \ref{unbounded-fzn} indicates that, in the presence of torsion in the ground monoid $H$, sets of lengths in $\P_\fun(H)$ blow up in a predictable fashion, with the result that most of the invariants classically studied in Factorization Theory lose their significance. 
In the case of Example \ref{unbounded-fzn}, this phenomenon is due to the existence of non-trivial idempotents and has been previously addressed by many authors in the literature on \emph{commutative} rings and monoids (see Remarks \ref{rem:chun&anderson} and \ref{rem:geroldinger&lettl}).
Here we strive for a ``natural approach'' that applies to \emph{arbitrary} monoids, spurring us to consider a refinement of the notions introduced in \S{ }\ref{subsec:factorizations} and to investigate some of their fundamental properties (see, in particular, Definition \ref{def:min-fac} and Proposition \ref{prop:min-equi}), before focusing on the special case of power monoids.

\label{subsec:min-factorizations}
We start with the definition of a binary relation (in fact, a preorder) on the $\A(H)$-words of a monoid $H$ that we shall use to ``filter out the redundant factors'' that may contribute to the factorizations of an element of $H$
(recall that, given a set $X$, we denote by $\F^\ast(X)$ the free monoid with basis $X$ and by $\varepsilon_X$ the identity of $\F^\ast(X)$).
%
\begin{defn}\label{def:preorder}
	Let $H$ be a monoid. We denote by $\preceq_H$ 
	the binary relation on $\F^\ast(\A(H))$ determined by taking $\mathfrak a \preceq_H \mathfrak b$, for some  
	$\A(H)$-words $\mathfrak a$ and $\mathfrak b$ of length $h$ and $k$ respectively, if and only if one of the following conditions holds:
	\begin{enumerate}[label=$\bullet$]
	\item $\mathfrak a = \varepsilon_{\A(H)}$ and $\mathfrak b$ is arbitrary;
	%$\pi_H(\mathfrak a) = 1_H$;
	\item $\mathfrak a$ and $\mathfrak b$ are non-empty words, say $\mathfrak a = a_1 \ast \cdots \ast a_h$ and $\mathfrak b = b_1 \ast \cdots \ast b_k$, and
	there is an injection $\sigma: [ 1, h ] \to [ 1, k ]$ such that $b_i \simeq_H a_{\sigma(i)}$ for every $i \in [ 1, h ]$. 
	\end{enumerate}
	We shall write $\mathfrak{a} \prec_H \mathfrak{b}$ if $\mathfrak{a} \preceq_H \mathfrak{b}$ but $\mathfrak{b} \not\preceq_H \mathfrak{a}$, and say that a word $\mathfrak{a} \in \F^\ast(\A(H))$ is \emph{$\preceq_H$-minimal} (or simply \emph{minimal}) if there does not exist any $\\A(H)$-word $\mathfrak{b}$ such that $\mathfrak{b} \prec_H \mathfrak{a}$.
\end{defn}
%
The next result highlights a few basic properties of the relation introduced in Definition \ref{def:preorder}.
%
\begin{prop}\label{preorder-facts}
Let $H$ be a monoid, and let $\mathfrak{a},\mathfrak{b}\in \F^*(\\A(H))$. The following hold:
\begin{enumerate}[label = {\textup{(\roman{*})}}]
%
\item\label{it:prop:preorder-facts(0)} $\preceq_H$ is a preorder \textup{(}i.e., a reflexive and transitive binary relation\textup{)} on $\F^\ast(\A(H))$.
%
\item\label{it:prop:preorder-facts(ii)} If $\mathfrak{a} \preceq_H \mathfrak{b}$ then $\| \mathfrak{a} \|_H \le \| \mathfrak{b} \|_H$.
%
\item\label{it:prop:preorder-facts(iv)} $\mathfrak{a} \preceq_H \mathfrak{b}$ and $\mathfrak{b} \preceq_H \mathfrak{a}$ if and only if $\mathfrak a \preceq_H \mathfrak b$ and $\|\mathfrak a\|_H = \|\mathfrak b\|_H$, if and only if $(\mathfrak{a},\mathfrak{b}) \in \C_H$.
\end{enumerate}
\end{prop}
%
\begin{proof}
Points \ref{it:prop:preorder-facts(0)} and \ref{it:prop:preorder-facts(ii)} are straightforward from our definitions.

As for \ref{it:prop:preorder-facts(iv)}, set $h := \|\mathfrak a\|_H$ and $k := \|\mathfrak b\|_H$. 
By part \ref{it:prop:preorder-facts(ii)}, $\mathfrak{a} \preceq_H \mathfrak{b}$ and $\mathfrak{b} \preceq_H \mathfrak{a}$ only if  $\mathfrak a \preceq_H \mathfrak b$ and $h = k$; and it is immediate to check that $(\mathfrak{a},\mathfrak{b}) \in \C_H$ implies $\mathfrak{a} \preceq_H \mathfrak{b}$ and $\mathfrak{b} \preceq_H \mathfrak{a}$. 
So, to finish the proof, assume that $\mathfrak a \preceq_H \mathfrak b$ and $h = k$. We only need to show that $(\mathfrak a, \mathfrak b) \in \C_H$. 
For, we have (by definition) that $\mathfrak a \preceq_H \mathfrak b$ if and only if $\pi_H(\mathfrak a) = \pi_H(\mathfrak b)$ and there is an injection $\sigma: [ 1, h ] \to [ 1, k ]$ 
such that $a_i \simeq_H b_{\sigma(i)}$ for every $i \in [ 1, h ]$. But $\sigma$ is actually a bijection (because $h = k$), and we can thus conclude that $(\mathfrak a, \mathfrak b) \in \C_H$.
\end{proof}
%
\begin{defn}\label{def:min-fac}
Let $H$ be a monoid and $x \in H$. An $H$-word $\mathfrak{a}$ is a \emph{$\preceq_H$-minimal factorization} of $x$, or simply a \emph{minimal factorization} of $x$ (in or relative to $H$), if $\mathfrak a \in \mathcal Z_H(x)$ and $\mathfrak a$ is $\preceq_H$-minimal. Accordingly, 
\[
\mathcal{Z}_{H}^\m(x) := \left\{ \mathfrak{a}\in \mathcal{Z}_H(x): \mathfrak{a} \textrm{ is $\preceq_H$-minimal} \right\}
\quad\text{and}\quad
\mathsf{Z}_{H}^\m(x):= \mathcal{Z}_{H}^\m(x)/\C_H
\]
shall denote, respectively, the set of $\preceq_H$-minimal factorizations and the set of $\preceq_H$-minimal factorization classes of $x$ (cf. the definitions from \S{ }\ref{subsec:factorizations}). In addition, we take 
\[
\mathsf{L}_{H}^\m(x) := \left\{ \|\mathfrak{a}\|_H : \mathfrak{a} \in \mathcal{Z}_{H}^\m(x) \right\} \subseteq \NN
\]
to be the set of \emph{$\preceq_H$-minimal factorization lengths} of $x$, and
\[
	\mathcal{L}^\m(H) := \left\{ \mathsf{L}_{H}^\m(x) : x\in H \right\} \subseteq \mathcal P(\NN)
\]
to be the \emph{system of sets of $\preceq_H$-minimal lengths} of $H$. Lastly, we say that the monoid $H$ is
\begin{itemize}
	\item \textup{BmF} or \emph{bounded-minimally-factorial} (respectively, \textup{FmF} or \emph{finite-minimally-factorial}) if $\mathsf{L}_{H}^\m(x)$ (respectively, $\mathsf{Z}_{H}^\m(x)$) is finite and non-empty for every $x\in H\setminus H^\times$;
	
	\item \textup{HmF} or \emph{half-minimally-factorial} (respectively, \emph{minimally factorial}) if $\mathsf{L}_{H}^\m(x)$ (respectively, $\mathsf{Z}_{H}^\m(x)$) is a singleton for all $x \in H \setminus H^\times$.
		%
\end{itemize}
%
Note that we may write $\mathcal{Z}^\m(x)$ for $\mathcal{Z}_{H}^\m(x)$, $\mathsf {L}^\m(x)$ for $\mathsf {L}_{H}^\m(x)$, etc. if there is no likelihood of confusion.
\end{defn}
%

\begin{rk} \label{rem:chun&anderson}
To the best of our knowledge, analogues of the notions introduced in Definition \ref{def:min-fac} have only been considered so far in a \emph{commutative} setting, with one significant example being offered by the work of S. Chun, D.D. Anderson, and S. Valdes-Leon \cite{chun-anderson-vl11} on ``reduced factorizations''.

In detail, let $H$ be the multiplicative monoid of a (unital) ring $R$ and fix a set $\mathcal A \subseteq R$.
We say that a non-empty $\mathcal A$-word $a_1 \ast \cdots \ast a_n$ of length $n$ is a \emph{minimal $\mathcal A$-factorization} of an element $x \in R$ if $\pi_H(\mathfrak a) = x$ but $x \ne \pi_H(\mathfrak b)$ for every non-empty $\mathcal A$-word $\mathfrak b = b_1 \ast \cdots \ast b_m$ of length $m \le n-1$ for which there exists an injection $\sigma: [ 1, m ] \to [ 1, n ]$ such that $b_i \simeq_H a_{\sigma(i)}$ for each $i \in [ 1, m ]$. 

A minimal $\A(H)$-factorization of a non-unit $x \in R$ is the same as a $\preceq_H$-minimal factorization of $x$ (as per Definition \ref{def:min-fac}). Moreover, it follows from \S{ }\ref{sub:other-factorizations} and Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(ii)} that, if $R$ is a \emph{commutative} ring and $x$ is not the zero of $R$, then a minimal $\A(H)$-factorization of $x$ is, in the parlance of \cite[Definition 2.1 and \S{ }3]{chun-anderson-vl11}, essentially the same as a \emph{strongly $\mu$-reduced $\mu$-factorization} of $x$ into very strongly irreducible elements of $R$. 
Insofar as the discussion is restricted to commutative rings, one can thus refer to \cite{chun-anderson-vl11} and \cite{axtell-et-al03} for a comparison of our approach to the study of ``minimal factorizations'' with others in the literature, including the one by C.R. Fletcher \cite{fletcher69} and generalizations thereof where the set $\mathcal A$ in the above consists of various types of ``irreducible elements'' of $R$ (cf. \S{ }\ref{sub:other-factorizations}).
\end{rk}

\begin{rk}\label{rem:geroldinger&lettl}
Another approach for managing the ``excess factorizations'' arising from the presence of torsion (though still in a commutative setting), was outlined by A. Geroldinger and G. Lettl in \cite{geroldinger-lettl90}. 

In short, let $H$ be a \emph{commutative} monoid and denote by $\mathcal A$ the set of all $a \in H \setminus H^\times$ such that $b \mid_H a$ only if $b \in H^\times$ or $aH = bH$. Given $u \in H$, we define 
\[
\textrm{ind}_H^{\rm GL}(u) := \inf \{r\in \NN: u^i H = u^j H \textrm{ for all } i, j \ge r\}.
\]
Accordingly, we take a \emph{\textup{GL}-factorization} of a non-unit $x \in H$ to be a non-empty $\mathcal A$-word $\mathfrak a = a_1 \ast \cdots \ast a_n$ such that $\pi_H(\mathfrak a) = x$ and $\mathsf v_a^H(\mathfrak a) \le \text{ind}_H^{\rm GL}(a)$ for every $a \in \mathcal A$, where
\[
\mathsf v_a^H(\mathfrak a) := \bigl|\{i \in [ 1, n ]: a_i = a\}\bigr|.
\]
A \textup{GL}-factorization is fundamentally the same as the ``canonical form'' of a factorization in the sense of \cite{geroldinger-lettl90}; and since it is easily checked that $\A(H) \subseteq \mathcal A$, every $\preceq_H$-minimal factorization is also a \textup{GL}-factorization. Moreover, the two notions coincide on the level of commutative, unit-cancellative monoids, in which case $\mathcal A = \A(H)$ and $\text{ind}_H^{\rm GL}(u) = \infty$ for every non-unit $u \in H$.
However, big differences exist in general. E.g., it follows from Lemma \ref{lem:2-elt-atoms}\ref{it:lem:2-elt-atoms(i)} and the above that $\{\bar{0}, \bar{1}\} \ast \{\bar{0}, \bar{2}\} \ast \{\bar{0}, \bar{3}\} \ast \{\bar{0}, \bar{4}\}$ is an essential factorization of $\ZZ/5\ZZ$ in the reduced power monoid of the cyclic group $(\ZZ/5\ZZ, +)$; but is not a minimal factorization as per Definition \ref{def:min-fac}, because $\ZZ/p\ZZ = \{\bar{0}, \bar{1}\} + \{\bar{0}, \bar{2}\} + \{\bar{0}, \bar{3}\}$.
\end{rk}
%
It is helpful, at this juncture, to observe some fundamental features of minimal factorizations.
%
\begin{prop}\label{prop:min-basics}
	Let $H$ be a monoid and let $x\in H$. The following hold:
	%
	\begin{enumerate}[label = {\rm (\roman{*})}]
		\item\label{it:prop:min-basics(i)} Any $\\A(H)$-word of length $0$, $1$, or $2$ is minimal.
		\item\label{it:prop:min-basics(ii)} $\Z_H(x) \ne \emptyset$ if and only if  $\Z_H^\m(x) \ne \emptyset$.
		%
		\item\label{it:prop:min-basics(iib)} If $\mathfrak a \in \mathcal Z_H^\m(x)$ and $(\mathfrak a, \mathfrak b) \in \C_H$, then $\mathfrak b \in \mathcal Z_H^\m(x)$.
		%
		\item\label{it:prop:min-basics(iii)} If $K$ is a divisor-closed submonoid of $H$ and $x \in K$, then $\Z_K^\m(x) = \Z_H^\m(x)$ and $\mathsf L_K^\m(x) = \mathsf L_H^\m(x)$.
		\item\label{it:prop:min-basics(iv)} If $H$ is commutative and unit-cancellative, then $\Z_H^\m(x) = \Z_H(x)$, and hence $\mathsf L_H^\m(x) = \mathsf L_H(x)$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	\ref{it:prop:min-basics(i)}, \ref{it:prop:min-basics(ii)}, and \ref{it:prop:min-basics(iib)} are an immediate consequence of parts \ref{it:prop:preorder-facts(ii)}-\ref{it:prop:preorder-facts(iv)} of Proposition \ref{preorder-facts} (in particular, note that, if $\mathfrak a$  is an $\A(H)$-word of length $1$, then $\pi_H(\mathfrak a)$ is an atom of $H$, and therefore $\pi_H(\mathfrak a) \ne \pi_H(\mathfrak b)$ for every  $\A(H)$-words $\mathfrak b$ of length $\ge 2$); and \ref{it:prop:min-basics(iii)} follows at once from considering that, if $K$ is a divisor-closed submonoid of $H$ and $x \in K$, then $\mathcal Z_K(x) = \mathcal Z_H(x)$ and $\mathsf L_K(x) = \mathsf L_H(x)$, see \cite[Proposition 2.21(ii)]{fan-tringali18}.
	
	\ref{it:prop:min-basics(iv)} Assume $H$ is commutative and unit-cancellative. It suffices to check that no non-empty $\A(H)$-word has a proper subword with the same product.
	For, suppose to the contrary that there exist  $a_1,\dots,a_n \in \A(H)$ with $\prod_{i \in I} a_i = a_1\cdots a_n$ for some $I \subsetneq [ 1, n ]$. Since $H$ is commutative, we can assume without loss of generality that $I = [ 1, k ]$ for some $k \in [ 0, n-1 ]$. Then unit-cancellativity implies $a_{k+1}\cdots a_n \in H^\times$, and we get from parts \ref{it:prop:unit-adjust(0)} and \ref{it:prop:unit-adjust(0b)} of Proposition \ref{prop:unit-adjust} that $a_{k+1},\dots,a_n \in H^\times$, which is however impossible (by definition of an atom).	
%	
\end{proof}
%
To further elucidate the behavior of minimal factorizations, we give an analogue of Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(ii)} showing that multiplying a non-unit by units does not change its set of minimal factorizations.
%
\begin{lemma}\label{lem:min-unit-adjust}
	Let $H$ be a monoid, and fix $x\in H\setminus H^\times$ and $u,v\in H^\times$.
	Then there is a length-preserving bijection $\mathcal{Z}_H^\m(x)\to\mathcal{Z}_H^\m(uxv)$, and in particular $\mathsf L_H^\m(x) = \mathsf L_H^\m(uxv)$.
\end{lemma}
\begin{proof}
	Given $w, z \in H$ and a non-empty word $\mathfrak{z} = y_1 \ast \cdots \ast y_n \in \F^\ast(H)$ of length $n$, denote by $w\mathfrak{z}z$ the length-$n$ word $\bar{y}_1 \ast \cdots \ast \bar{y}_n \in \F^\ast(H)$ defined by taking $\bar{y}_1 := w y_1 z$ if $n = 1$, and $\bar{y}_1:= wy_1$, $\bar{y}_n := y_nz$, and $\bar{y}_i := y_i$ for all $i\in [ 2,n-1]$ otherwise. 
	We claim that the function 
	$$
	f: \mathcal{Z}_H^\m(x) \to \mathcal{Z}_H^\m(uxv): \mathfrak a \mapsto u\mathfrak a v
	$$
	is a well-defined length-preserving bijection. 
	In fact, it is sufficient to show that $f$ is well-defined, since this will in turn imply that the map $g: \mathcal{Z}_H^\m(uxv)\to\mathcal{Z}_H^\m(x):\mathfrak{b}\mapsto u^{-1}\mathfrak{b}v^{-1}$ is also well-defined (observe that $uxv \in H \setminus H^\times$ and $x = u^{-1} uxv v^{-1}$), and then it is easy to check that $g$ is the inverse of $f$.
	
	For the claim, let $\mathfrak a \in \mathcal{Z}_H^\m(x)$, and note that, by parts \ref{it:prop:unit-adjust(0)} and \ref{it:prop:unit-adjust(0b)} of Proposition \ref{prop:unit-adjust}, $\|\mathfrak a\|_H$ is a positive integer, so that  $\mathfrak a = a_1 \ast \cdots \ast a_n$ for some $a_1, \ldots, a_n \in \A(H)$. 
	In view of Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(i)}, $u\mathfrak{a}v$ is a factorization of $uxv$, and we only need to verify that it is also $\preceq_H$-minimal. For,
suppose to the contrary that $\mathfrak b \prec_H u\mathfrak av$ for some $\mathfrak b \in \F^\ast(\A(H))$.
	Then $\pi_H(\mathfrak b) = \pi_H(u\mathfrak a v) = uxv$ and, by Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)},
	$
	k := \|\mathfrak b\|_H \in [ 1, n-1 ]
	$
	(recall that $uxv \notin H^\times$). So, $\mathfrak b = b_1 \ast \cdots \ast b_k$ for some atoms  $b_1, \ldots, b_k \in H$, and there exists an injection $\sigma: [ 1, k ] \to [ 1, n ]$ such that $b_i \simeq_H a_{\sigma(i)}$ for each $i \in [ 1, k ]$.
	Define
	$
	\mathfrak{c} := u^{-1} \mathfrak b v^{-1}$. 
	
	By construction and Proposition \ref{prop:unit-adjust}\ref{it:prop:unit-adjust(i)}, there are  $c_1, \ldots, c_k \in \A(H)$ such that $\mathfrak c = c_1 \ast \cdots \ast c_k$; and it follows from the above that $\pi_H(\mathfrak c) = u^{-1} \pi_H(\mathfrak b) v^{-1} = x$ and $c_i \simeq_H a_{\sigma(i)}$ for every $i \in [ 1, k ]$. Since $k < n$, we can thus conclude from Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)} that $\mathfrak c \prec_H \mathfrak a$, contradicting the $\preceq_H$-minimality of $\mathfrak{a}$.
\end{proof}
%
We saw in the previous section that equimorphisms transfer factorizations between monoids (Proposition \ref{prop:equimorphism}).  
Equimorphisms have a similar compatibility with minimal factorizations, in the sense that an equimorphism also satisfies a ``minimal version'' of condition \ref{def:equimorphism(E3)} from Definition \ref{def:equimorphism}.
%
%
%
\begin{prop}\label{prop:min-equi}
	Let $H$ and $K$ be monoids and $\varphi: H\to K$ an equimorphism. The following hold: 
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:prop:min-equi(i)} If $x\in H \setminus H^\times$ and $\mathfrak{b}\in \mathcal{Z}_K^\m(\varphi(x))$, then there is $\mathfrak{a}\in \mathcal{Z}_H^\m(x)$ with $\varphi^*(\mathfrak{a})\in [ \mathfrak{b} ]_{\C_K}$.
		%
		\item\label{it:prop:min-equi(ii)} $\mathsf{L}_K^\m(\varphi(x)) \subseteq \mathsf{L}_H^\m(x)$ for every $x\in H\setminus H^\times$.
		\item\label{it:prop:min-equi(iii)} If $\varphi$ is essentially surjective then, for all $y\in K\setminus K^\times$, there is $x\in H\setminus H^\times$ with $\mathsf{L}_K^\m(y) \subseteq \mathsf{L}_H^\m(x)$. 
	\end{enumerate}
\end{prop}
%
\begin{proof}
	\ref{it:prop:min-equi(i)}
	Pick $x\in H \setminus H^\times$, and let $\mathfrak b \in \mathcal{Z}_K^\m(\varphi(x))$. Then $\mathfrak b \ne \varepsilon_{\A(K)}$, otherwise $\varphi(x) = \pi_K(\mathfrak b) = 1_K$ and, by \ref{def:equimorphism(E1)}, $x \in \varphi^{-1}(\varphi(x)) = \varphi^{-1}(1_K) \subseteq H^\times$ (a contradiction). Consequently, \ref{def:equimorphism(E3)} yields the existence of a factorization $\mathfrak{a}\in \mathcal{Z}_H(x)$ with $\varphi^*(\mathfrak{a}) \in [ \mathfrak{b} ]_{\C_K}$, and it only remains to show that $\mathfrak a$ is $\preceq_H$-minimal. 
	
	{Note that} $n := \|\mathfrak a\|_H = \|\varphi^\ast(\mathfrak a)\|_K = \|\mathfrak b\|_K \ge 1$, and write $\mathfrak a = a_1 \ast \cdots \ast a_n$ and $\mathfrak b = b_1 \ast \cdots \ast b_n$, with $a_1, \ldots, a_n \in \A(H)$ and $b_1, \ldots, b_n \in \A(K)$. Then suppose to the contrary that $\mathfrak a$ is not $\preceq_H$-minimal, i.e., there exist a (necessarily non-empty) $\A(H)$-word $\mathfrak{c} = c_1 \ast \cdots \ast c_m$ and an injection $\sigma: [ 1, m ] \to [ 1, n ]$ such that $\pi_H(\mathfrak c) = \pi_H(\mathfrak a) = x$ and $c_i \simeq_H a_{\sigma(i)}$ for every $i \in [ 1, m ]$. Then
	\[
	\pi_K(\varphi^\ast(\mathfrak c)) = \varphi(c_1) \cdots \varphi(c_m) = \varphi(x)
	\quad\text{and}\quad
	\varphi(c_1) \simeq_K \varphi(a_{\sigma(1)}), \ldots, \varphi(c_m) \simeq_K \varphi(a_{\sigma(m)})
	\]
	(recall that monoid hom\-o\-mor\-phisms map units to units; so, if $u \simeq_H v$, then $\varphi(u) \simeq_K \varphi(v)$); and together with Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(iib)}, this proves that 
	$\varphi^\ast(\mathfrak c) \prec_K \mathfrak b$, contradicting the $\preceq_K$-minimality of $\mathfrak b$.
	
	\ref{it:prop:min-equi(ii)} Fix $x \in H \setminus H^\times$, and suppose $\mathsf{L}_K^\m(\varphi(x)) \ne \emptyset$ (otherwise there is nothing to prove). Accordingly, let $k \in \mathsf{L}_K^\m(\varphi(x))$ and $\mathfrak b \in \mathcal Z_K^\m(\varphi(x))$ such that $k = \|\mathfrak b\|_K$. It is sufficient to check that $k \in \mathsf L_H^\m(x)$, and this is straightforward: Indeed, we have by \ref{it:prop:min-equi(i)} that $\varphi^\ast(\mathfrak a)$ is $\C_K$-congruent to $\mathfrak b$ for some $\mathfrak a \in \mathcal Z_H^\m(x)$, which implies in particular that $k = \|\varphi^\ast(\mathfrak a)\|_K = \|\mathfrak a\|_H \in \mathsf L_H^\m(x)$.
	
	\ref{it:prop:min-equi(iii)} Assume $\varphi$ is essentially surjective, and let $y \in K \setminus K^\times$. Then $y = u \varphi(x) v$ for some $u,v\in K^\times$ and $x\in H$, and neither $x$ is a unit of $H$ nor $\varphi(x)$ is a unit of $K$ (because $\varphi(H^\times) \subseteq K^\times$ and $y \notin K^\times$). Accordingly, we have by Lemma \ref{lem:min-unit-adjust} and part \ref{it:prop:min-equi(ii)} that $\mathsf{L}_K^\m(y) = \mathsf{L}_K^\m(\varphi(x)) \subseteq \mathsf{L}_H^\m(x)$.
\end{proof}
%

\section{Minimal Factorizations in Power Monoids}
\label{subsec:min-factorization-in-PMs}
%
Let $H$ be a monoid. Similarly as in \S{ }\ref{sec:atomicity}, we would like to simplify the study of minimal factorizations in $\P_\funt(H)$ as much as possible by passing to consideration of the reduced monoid $\P_\fun(H)$. For, it is of primary importance to make clear the nature of the relationship between minimal factorizations in $\P_\funt(H)$ and those in $\P_\fun(H)$.
We shall see that this is possible under \emph{some} circumstances. 
%
\begin{prop}\label{prop:comm-pm}
	Let $H$ be a commutative monoid, and let $X\in \P_{\fin,1}(H)$. The following hold:
	\begin{enumerate}[label = {\rm (\roman{*})}]
		\item\label{it:prop:comm-pm(i)} $\Z_{\P_{\fin,1}(H)}^\m(X) \subseteq \Z_{\P_{\funt}(H)}^\m(X)$.
		\item\label{it:prop:comm-pm(ii)} $\mathsf{L}_{\P_{\fin,1}(H)}^\m(X) = \mathsf{L}_{\P_\funt(H)}^\m(X)$.
		\item\label{it:prop:comm-pm(iii)} $\mathcal{L}^\m(\P_{\fin,1}(H)) = \mathcal{L}^\m(\P_\funt(H))$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	\ref{it:prop:comm-pm(i)} Let $\mathfrak{a}$ be a minimal factorization of $X$ relative to $\P_{\fin,1}(H)$. In light of Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, $\mathfrak{a}$ is a non-empty $\A(\mathcal P_{\fin,1}(H))$-word, i.e., $\mathfrak a = A_1 \ast \cdots \ast A_n$ for some atoms $A_1, \ldots, A_n \in \mathcal P_{\fin,1}(H)$. 
	
	Assume for the sake of contradiction that $\mathfrak a$ is not a minimal factorization relative to $\P_{\fin,\times}(H)$. Then there exist a non-empty $\A(\mathcal P_{\fin,\times}(H))$-word $\mathfrak b = B_1 * \cdots * B_m$ and an injection $\sigma: [ 1, m ] \to [ 1, n ]$ with 
	\[
	X = A_1 \cdots A_n = B_1 \cdots B_m
	\quad\text{and}\quad
	B_1 \simeq_{\mathcal P_{\fin,\times}(H)} A_{\sigma(1)}, \ldots, B_m \simeq_{\mathcal P_{\fin,\times}(H)} A_{\sigma(m)},
	\]
	and on account of Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)} we must have $1 \le m < n$.
	Since $H$ is a commutative monoid, this means in particular that, for each $i \in [ 1, m ]$, there is $u_i \in H^\times$ such that $B_i = u_i A_{\sigma(i)}$. Thus we have
	\[
	A_1 \cdots A_n = B_1 \cdots B_m = (u_1 A_{\sigma(1)}) \cdots (u_m A_{\sigma(m)}) = u \cdot A_{\sigma(1)} \cdots A_{\sigma(m)},
	\]
	where $u := u_1 \cdots u_m \in H^\times$. In view of Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(ii)}, it follows that
	\[
	\left| A_1 \cdots A_n \right| = \left|A_{\sigma(1)} \cdots A_{\sigma(m)} \right|,
	\]
	which is only possible if 
	\[
	X = A_1 \cdots A_n = A_{\sigma(1)} \cdots A_{\sigma(m)}, 
	\]
	because $1_H \in A_i$ for every $i \in [ 1, n ]$, and hence $A_{\sigma(1)} \cdots A_{\sigma(m)} \subseteq A_1 \cdots A_n$ (note that here we use again that $H$ is commutative). So, letting $\mathfrak a^\prime$ be the $\A(\mathcal P_{\fin,1}(H))$-word $ A_{\sigma(1)} \ast \cdots \ast A_{\sigma(m)}$ and recalling from the above that $m \le n-1$, we see by Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)} that $\mathfrak a^\prime \prec_{\mathcal P_{\fin,1}(H)} \mathfrak a$, which contradicts the hypothesis that $\mathfrak a$ is a minimal factorization of $X$ in $\mathcal P_{\fin,1}(H)$.
	
	\ref{it:prop:comm-pm(ii)} It is an immediate consequence of part \ref{it:prop:comm-pm(i)} and Propositions \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} and \ref{prop:min-equi}\ref{it:prop:min-equi(ii)}, when considering that every commutative monoid is Dedekind-finite.
	
	\ref{it:prop:comm-pm(iii)} We already know from part \ref{it:prop:comm-pm(ii)} that $\mathcal{L}^\m(\mathcal P_{\fin,1}(H)) \subseteq \mathcal{L}^\m(\mathcal P_\funt(H))$. For the opposite inclusion, fix $X \in \P_\funt(H)$. We claim that there exists $Y \in \mathcal P_{\fin,1}(H)$ with 
	$\mathsf L_{\P_\funt(H)}^\m(X) = \mathsf L_{\P_{\fin,1}(H)}^\m(Y)$.
Indeed, pick $x \in X \cap H^\times$. Then $x^{-1} X\in \P_{\fin,1}(H)$, and we derive from Lemma \ref{lem:min-unit-adjust} and part \ref{it:prop:comm-pm(ii)} that 
	\[
	\mathsf{L}_{\P_\funt(H)}^\m(X) = \mathsf{L}_{\P_\funt(H)}^\m(x^{-1}X) = \mathsf{L}_{\P_{\fin,1}(H)}^\m(x^{-1} X),
	\]
	which proves our claim and suffices to finish the proof (since $X$ was arbitrary).
\end{proof}
%
We will now discuss an instance in which equality in Proposition \ref{prop:comm-pm}\ref{it:prop:comm-pm(ii)} does not necessarily hold true in the absence of commutativity, and the best we can hope for is the containment relation implied by Proposition \ref{prop:min-equi}\ref{it:prop:min-equi(ii)} when $\varphi$ is the natural embedding of  Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)}.
%
\begin{eg}\label{exa:strict-inclusion}
	Let $n$ be a (positive) multiple of $105$, and $p$ a (positive) prime dividing $n^2 + n + 1$; note that $p \ge 11$ and $3 \le n \bmod p \le p-3$ (where $n \bmod p$ is the smallest non-negative integer $\equiv r \bmod p$). Following \cite[p. 27]{gorenstein80}, we take $H$ to be the metacyclic group generated by the $2$-element set $\{r, s\}$ subject to $\ord_H(r) = p$, $\ord_H(s) = 3$, and $s^{-1} r s = r^n$. 
	Then $H$ is a non-abelian group of (odd) order $3p$, and by Theorem \ref{th:atomicity} and Propositions \ref{prop:equimorphism}\ref{it:prop:equimorphism(ii)} and \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)}, $\mathcal P_{\fin,1}(H)$ and $\mathcal P_{\fin,\times}(H)$ are both atomic monoids. 
	
We claim that $X := \langle r \rangle_H$ has minimal factorizations of length $p-1$ in $\mathcal P_{\fin,1}(H)$ but not in $\mathcal P_{\fin,\times}(H)$.
	{Pick $g \in X \setminus \{1_H\}$.} Clearly $\ord_H(g) = p$, and thus we get from Lemma \ref{lem:2-elt-atoms}\ref{it:lem:2-elt-atoms(i)} that $\{1_H, g\}$ is an atom of $\mathcal P_{\fin,1}(H)$. Then it is immediate to see that $\mathfrak a_g := \{1_H, g\}^{\ast (p-1)}$ is a minimal factorization of $X$ in $\mathcal P_{\fin,1}(H)$; most notably, $\mathfrak a_g$ is minimal since otherwise there should exist an exponent $k \in [ 1, p-2 ]$ such that $g^{p-1} = g^k$, contradicting that $\ord_H(g) = p$. Yet, $\mathfrak a_g$ is not a minimal factorization of $X$ in $\mathcal P_{\fin,\times}(H)$.
	Indeed, Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(ii)} and Lemma \ref{lem:2-elt-atoms}\ref{it:lem:2-elt-atoms(i)} guarantee that $\{1_H, g\}$ and $\{1_H, g^n\}$ are associate atoms of $\mathcal P_{\fin,\times}(H)$, because $s^{-1} g^n s = g$ and, hence, $s^{-1} \{1, g\} s = \{1_H, g^n\}$. So, in view of Proposition \ref{preorder-facts}\ref{it:prop:preorder-facts(iv)}, it is straightforward that 
	\[
	\{1_H, g\}^{\ast (p-2)} \ast \{1_H, g^n\} \prec_{\mathcal P_{\fin,\times}(H)} \mathfrak a_g,
	\]
	In particular, note here that we have used that $3 \le n \bmod p \le p-3$ to obtain
	\[
	\{1_H, g, \ldots, g^{p-2}\} \cup \{g^n, g^{n+1}, \ldots, g^{n+p-2}\} = \{1_H, g, \ldots, g^{p-1}\} = X.
	\]
	Given that, suppose for a contradiction that $X$ has a minimal factorization $\mathfrak c$ of length $p-1$ in $\mathcal P_{\fin,\times}(H)$. Then by Propositions \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} and \ref{prop:min-equi}\ref{it:prop:min-equi(i)}, $\mathfrak c$ is $\C_{\mathcal P_{\fin,\times}(H)}$-congruent to a $\preceq_{\mathcal P_{\fin,1}(H)}$-minimal fac\-tor\-ization $\mathfrak a = A_1 \ast \cdots \ast A_{p-1}$ of $X$ of length $p-1$; and we aim to show that $\mathfrak a$ is $\C_{\mathcal P_{\fin,1}(H)}$-congruent to $\mathfrak a_g$ for some $g \in X \setminus \{1_H\}$, which is however impossible as it would mean that $\mathfrak a_g$ is a minimal factorization of $X$ in $\mathcal P_{\fin,\times}(H)$, in contradiction to what established in the above.
	
	Indeed, let $B_i$ be, for $i \in [ 1, p-1 ]$, the image of $\{k \in [ 0, p-1 ]: r^k \in A_i\} \subseteq \bf Z$ under the canonical map $\ZZ \to \ZZ/p\ZZ$. Then $\mathfrak a$ is a minimal factorization of $X$ in $\mathcal P_{\fin,1}(H)$ only if $\mathfrak b := B_1 \ast \cdots \ast B_{p-1}$ is a minimal factorization of $\ZZ/p\ZZ$ in the reduced power monoid of $(\ZZ/p\ZZ, +)$, herein denoted by $\mathcal P_{\fin,0}(\ZZ/p\ZZ)$.
	
	We want to show that $\mathfrak b$ is $\preceq_{\mathcal P_{\fin,0}(H)}$-minimal only if there is a non-zero $x \in \ZZ/p\ZZ$ such that $B_i = \{\overline{0}, x\}$ or $B_i = \{\overline{0}, -x\}$, or equivalently $A_i = \{1_H, r^{\hat{x}}\}$ or $A_i = \{1_H, r^{-\hat{x}}\}$, for every $i \in [ 1, p-1 ]$ (for notation, see \S{ }\ref{subsec:generalities}). By the preceding arguments, this will suffice to conclude that $p-1 \notin \mathsf L^\m_{\mathcal P_\funt(H)}(X)$, because it implies at once that $\mathfrak a$ is $\mathcal C_{\mathcal P_\fun(H)}$-congruent to $\mathfrak a_g$ with $g := r^{\hat{x}} \in X \setminus \{1_H\}$.
	
	To begin, let $K$ be a subset of $[ 1, p-1 ]$, and define $\mathcal{S}_K := \sum_{k \in K} B_k$ and $s_K := \{k \in K: |B_k| \ge 3\}$. Then we have by the Cauchy-Davenport inequality (see, e.g., \cite[Theorem 6.2]{grynkiewicz13}) that
	%
	\begin{equation}\label{equ:cauchy-davenport-application}
	\mathcal{S}_K = \ZZ/p\ZZ 
	\quad\text{or}\quad
	|\mathcal{S}_K| \ge 1 + {\sum}_{k \in K} \bigl(|B_k| - 1\bigr) \ge 1 + |K| + s_K.
	\end{equation}
	Now, let $I$ and $J$ be disjoint subsets of $[ 1, p-1 ]$ with $|I \cup J| = |I| + |J| = p-2$. We claim $s_I = s_J = 0$. Indeed, it is clear that $\mathcal{S}_{I \cup J} \ne \ZZ/p\ZZ$, otherwise $\mathfrak b$ would not be a minimal factorization in $\mathcal P_{\fin,0}(\ZZ/p\ZZ)$. So, another application of the Cauchy-Davenport inequality, combined with \eqref{equ:cauchy-davenport-application}, yields
	%
	\begin{equation}\label{equ:another-cauchy-davenport-application}
	|S_{I \cup J}| = |S_I + S_J| \ge |S_I| + |S_J| - 1 \ge 1 + |I| + |J| + s_I + s_J = p-1 + s_I + s_J.
	\end{equation}
	%
	This suffices to prove that $|S_I + S_J| = p-1$ and $s_I = s_J = 0$, or else $S_{I \cup J} = \ZZ/p\ZZ$ (a contradiction). 
	
	It follows $|B_1| = \cdots = |B_{p-1}| = 2$. So, taking $I$ in \eqref{equ:another-cauchy-davenport-application} to range over all $1$-element subsets of $[ 1, p-1 ]$ and observing that, consequently, $|S_J| \ge p-1-|S_I| = p-3 \ge 8 > |S_I|$, we infer from Vosper's theorem (see, e.g., \cite[Theorem 8.1]{grynkiewicz13}) that there exists a non-zero $x \in \ZZ/p\ZZ$ such that, for every $i \in [ 1, p-1 ]$, $B_i$ is an arithmetic progression of $\ZZ/p\ZZ$ with difference $x$, i.e., $B_i = \{\overline{0}, x\}$ or $B_i = \{\overline{0}, -x\}$ (as wished).
\end{eg}



We proceed with an analogue of Theorem \ref{thm:BF-torsion}\ref{it:thm:BF-torsion(i)} and then prove the main results of the section.

\begin{prop}\label{prop:bounded-minimal-fzn}
	Let $H$ be a monoid and $X \in \P_\funt(H)$. The following hold:
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item\label{it:prop:bounded-minimal-fzn(i)} If $X\in \P_\fun(H)$, then a minimal factorization of $X$ in $\P_\fun(H)$ has length $\le |X|-1$.
		\item\label{it:prop:bounded-minimal-fzn(ii)} If $H$ is Dedekind-finite, then a minimal factorization of $X$ in $\P_\funt(H)$ has length $\le |X|-1$.
	\end{enumerate}
\end{prop}
%
\begin{proof}
	 \ref{it:prop:bounded-minimal-fzn(i)} The claim is trivial if $X = \{1_H\}$, when the only factorization of $X$ is the empty word; or if $X \in \A(\P_{\fin,1}(H))$, in which case $|X| \ge 2$ and $X$ has a unique factorization (of length $1$). So, assume that $X$ is neither the identity nor an atom of $\mathcal P_{\fin,1}(H)$, and let $\mathfrak a$ be a minimal factorization of $X$ (relative to $\P_{\fin,1}(H)$). Then $\mathfrak a = A_1*\cdots* A_n$, where $A_1, \ldots, A_n \in \A(\mathcal P_{\fin,1}(H))$ and $n \ge 2$; and we claim that
	 \[
	 A_1\cdots A_i \subsetneq A_1\cdots A_{i+1}, \quad \text{for every }i \in [ 1, n-1 ].
	 \]
	 In fact, let $i \in [ 1, n-1 ]$. Since $1_H \in A_{i+1}$, it is clear that $A_1\cdots A_i \subsetneq A_1\cdots A_{i+1}$; and the inclusion must be strict, or else $A_1 \ast \cdots \ast A_i \ast \mathfrak b \prec_{\mathcal P_{\fin,1}(H)} \mathfrak a$, where $\mathfrak b := \varepsilon_{\A(\mathcal P_{\fin,1}(H))}$ if $i = n-1$ and $\mathfrak b := A_{i+2} \ast \cdots \ast A_n$ otherwise (contradicting the minimality of $\mathfrak a$). Consequently, we see that
	 $
	 2 \le |A_1\cdots A_i | < |A_1\cdots A_{i+1}| \le |X|$ for all $i \in [ 1, n-1 ]$, and this implies at once that $n\le |X|-1$.
	
	\ref{it:prop:bounded-minimal-fzn(ii)} The conclusion is immediate from part \ref{it:prop:bounded-minimal-fzn(i)} and Propositions \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} and \ref{prop:min-equi}\ref{it:prop:min-equi(iii)}.
\end{proof}
%
\begin{thm}\label{BmF-char}
	Let $H$ be a monoid. Then the following are equivalent:
	%
	\begin{enumerate}[label={\rm (\alph{*})}]
		\item\label{it:BmF-char(a)} $1_H \ne x^2 \ne x$ for every $x \in H \setminus \{1_H\}$.
		\item\label{it:BmF-char(b)} $\P_\fun(H)$ is atomic.
		\item\label{it:BmF-char(c)} $\P_\fun(H)$ is \textup{BmF}.
		\item\label{it:BmF-char(d)} $\P_\fun(H)$ is \textup{FmF}.
		\item\label{it:BmF-char(e)} Every $2$-element subset $X$ of $H$ with $1_H \in X$ is an atom of $\mathcal P_\fun(H)$.
		\item\label{it:BmF-char(f)} $\P_\funt(H)$ is atomic.
		\item\label{it:BmF-char(g)} $\P_\funt(H)$ is \textup{BmF}.
		\item\label{it:BmF-char(h)} $\P_\funt(H)$ is \textup{FmF}.
		\item\label{it:BmF-char(i)} Every $2$-element subset $X$ of $H$ with $X \cap H^\times \ne \emptyset$ is an atom of $\mathcal P_\funt(H)$.
	\end{enumerate}
	%
\end{thm}
%
\begin{proof}
	We already know from Theorem \ref{th:atomicity} and Lemma \ref{lem:2-elt-atoms} that \ref{it:BmF-char(b)} $\Leftrightarrow$ \ref{it:BmF-char(a)} $\Leftrightarrow$ \ref{it:BmF-char(e)} and \ref{it:BmF-char(i)} $\Rightarrow$ \ref{it:BmF-char(a)}; while it is straightforward from our definitions that \ref{it:BmF-char(h)} $\Rightarrow$ \ref{it:BmF-char(g)} $\Rightarrow$ \ref{it:BmF-char(f)}. So, it will suffice to prove that \ref{it:BmF-char(b)}
	$\Rightarrow$ \ref{it:BmF-char(c)} $\Rightarrow$ \ref{it:BmF-char(d)} $\Rightarrow$ \ref{it:BmF-char(h)}
 and \ref{it:BmF-char(f)} $\Rightarrow$
	\ref{it:BmF-char(i)}.
	
	\ref{it:BmF-char(b)} $\Rightarrow$ \ref{it:BmF-char(c)}: If $X \in \mathcal P_\fun(H)$ is a non-unit, then $\mathcal{Z}_{\mathcal P_\fun(H)}(X)$ is non-empty, and by Propositions \ref{prop:min-basics}\ref{it:prop:min-basics(ii)} and \ref{prop:bounded-minimal-fzn}\ref{it:prop:bounded-minimal-fzn(i)} we have that $\emptyset \ne \mathsf{L}_{\mathcal P_\fun(H)}^\m(X) \subseteq [ 1, |X|-1]$. So, $\mathcal P_\fun(H)$ is BmF.
	
	\ref{it:BmF-char(c)} $\Rightarrow$ \ref{it:BmF-char(d)}: Let $X \in \mathcal P_\fun(H)$ be a non-unit. 
	By Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(i)}, any atom of $\mathcal P_\fun(H)$ dividing $X$ must be a subset of $X$, and there are only finitely many of these (since $X$ is finite).
	Because a minimal factorization of $X$ is a bounded $\A(\mathcal P_\fun(H))$-word (by the assumption that $H$ is BmF), it follows that $X$ has finitely many minimal factorizations, and hence $\mathcal P_\fun(H)$ is FmF (since $X$ was arbitrary).
	
	\ref{it:BmF-char(d)} $\Rightarrow$ \ref{it:BmF-char(h)}: Pick a non-unit $X \in \mathcal P_{\fin,\times}(H)$, and let $u \in H^\times$ such that $uX \in \mathcal P_{\fin,1}(H)$. Since $\mathcal P_{\fin,1}(H)$ is FmF (by hypothesis), it is also atomic. Hence, by Theorem \ref{th:atomicity} and Lemma \ref{lem:no-non-id-elts-of-small-order-implies-structure}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(i)}, $H$ is Dedekind-finite, and so we have by Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(i)} that the natural embedding $\mathcal P_{\fin,1}(H) \hookrightarrow \mathcal P_{\fin,\times}(H)$ is an essentially surjective equimorphism.  
	In particular, we infer from Proposition \ref{prop:min-equi}\ref{it:prop:min-equi(i)} that any minimal factorization of $uX$ in $\mathcal P_{\fin,\times}(H)$ is $\C_{\mathcal P_{\fin,\times}(H)}$-congruent to a minimal factorization of $uX$ in $\mathcal P_{\fin,1}(H)$.
	However, this makes $\mathsf{Z}_{\mathcal P_{\fin,\times}(H)}^\m(uX)$ finite, whence $\mathsf{Z}_{\mathcal P_{\fin,\times}(H)}^\m(X)$ must also be finite as a consequence of Lemma \ref{lem:min-unit-adjust}.
	
	
	
	\ref{it:BmF-char(f)} $\Rightarrow$ \ref{it:BmF-char(i)}: Let $X$ be a $2$-element subset of $H$ with $X \cap H^\times \ne \emptyset$. Then $X = uA$ for some unit $u \in H^\times$, where $A := u^{-1}X$ is a $2$-element subset of $H$ with $1_H \in H$; and since $\mathcal P_{\fin,\times}(H)$ is atomic (by hypothesis), we are guaranteed by Lemmas \ref{lem:2-elt-atoms} and \ref{lem:no-non-id-elts-of-small-order-implies-structure}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(i)} that $A$ is an atom of $\mathcal P_\fun(H)$ and $H$ is Dedekind-finite. Therefore, we conclude from Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths}\ref{it:prop:funt&fun-have-the-same-system-of-lengths(ii)} that $X \in \A(\mathcal P_\funt(H))$.
\end{proof}

\begin{thm}\label{prop:HF-exp-3}
	Let $H$ be a monoid. Then $\mathcal P_\fun(H)$ is \textup{HmF} if and only if $H$ is trivial or a cyclic group of order $3$.
%
\end{thm}

\begin{proof}
	The ``if'' part is an easy consequence of Theorem \ref{BmF-char} and Propositions \ref{prop:bounded-minimal-fzn}\ref{it:prop:bounded-minimal-fzn(i)} and \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, when considering that, if $H$ is trivial or a cyclic group of order $3$, then $1_H \ne x^2 \ne x$ for all $x \in H \setminus \{1_H\}$ and every non-empty subset of $H$ has at most $3$ elements.
		
		
	As for the other direction, suppose $\mathcal P_\fun(H)$ is HmF and $H$ is non-trivial. Then $\mathcal P_\fun(H)$ is atomic, and we claim that $H$ is a $3$-group. By Theorem \ref{th:atomicity} and Lemma \ref{lem:no-non-id-elts-of-small-order-implies-structure}\ref{it:lem:no-non-id-elts-of-small-order-implies-structure(ii)}, it suffices to show that
	$
	x^3 \in \{1_H, x, x^2\}$ for every $x \in H$, since this in turn implies (by induction) that $\langle x \rangle_H \subseteq \{1_H, x, x^2\}$ and $\ord_H(x) \le 3$.
	
	{Assume to the contrary} that $x^3 \notin \{1_H, x, x^3\}$ for some $x \in H$, and set $X := \{1_H, x, x^2, x^3\}$. By Theorem \ref{BmF-char}, $\mathfrak a := \{1_H, x\}^{\ast 3}$ and $\mathfrak b := \{1_H, x\} \ast \{1_H, x^2\}$ are both factorizations of $X$ in $\mathcal P_\fun(H)$; and in light of Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, $\mathfrak b$ is in fact a minimal factorization (of length $2$). Then $\mathfrak a$ cannot be minimal, because $\mathcal P_\fun(H)$ is HmF and $\mathfrak a$ has length $3$. However, since $\mathcal P_\fun(H)$ is a reduced monoid (and $X$ is not an atom), this is only possible if $x^3 \in X = \{1_H, x\}^2$, a contradiction.
	
	So, $H$ is a $3$-group, and as such it has a non-trivial center $Z(H)$, see e.g. \cite[Theorem 2.11(i)]{gorenstein80}. Let $z$ be an element in $Z(H) \setminus \{1_H\}$, and suppose for a contradiction that $H$ is not cyclic. Then we can choose some element $y \in H \setminus \gen{z}_H$, and it follows from the above that $K := \gen{y,z}_H$ is an abelian subgroup of $H$ with $\ord_H(y) = \ord_H(z) = 3$ and $|K| = 9$. 
	We will prove that $K$ has $\preceq_{\mathcal P_\fun(H)}$-minimal factorizations of more than one length, which is a contradiction and finishes the proof.
	
	Indeed, we are guaranteed by Theorem \ref{BmF-char} that $\mathfrak c := \{1_H,y\}^{\ast 2} \ast \{1_H,z\}^{\ast 2}$ is a length-$4$ factorization of $K$ in $\P_\fun(H)$; and it is actually a minimal factorization, because removing one or more atoms from $\mathfrak c$ yields an $\A(\mathcal P_\fun(H))$-word whose image under $\pi_{\mathcal P_\fun(H)}$ has cardinality at most $8$ (whereas we have already noted that $|K| = 9$).
	On the other hand, it is not difficult to check that $A := \{1_H, y, z\}$ is an atom of $\mathcal P_\fun(H)$: If $\{1_H, y, z\} = YZ$ for some $Y, Z \in \mathcal P_\fun(H)$ with $|Y|, |Z| \ge 2$, then $Y, Z \subseteq \{1_H, y, z\}$ and $Y \cap Z = \{1_H\}$, whence $YZ = \{1_H, y\}\cdot\{1_H, z\} = K \ne A$. This in turn implies that $A^{\ast 2}$ is a length-$2$ factorization of $K$ in $\P_\fun(H)$, and it is minimal by Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}.
	So, we are done.
\end{proof}

\begin{cor}\label{cor:when-reduced-pm-is-minimally-factorial}
	Let $H$ be a monoid. Then $\mathcal P_\fun(H)$ is minimally factorial if and only if $H$ is trivial.
\end{cor}

\begin{proof}
	The ``if'' part is obvious. For the other direction, assume by way of contradiction that $\mathcal P_\fun(H)$ is minimally factorial but $H$ is non-trivial. Then $\mathcal P_\fun(H)$ is HmF, and we obtain from Theorem \ref{prop:HF-exp-3} that $H$ is a cyclic group of order $3$. Accordingly, let $x$ be a generator of $H$. By Lemma \ref{lem:2-elt-atoms}\ref{it:lem:2-elt-atoms(i)} and Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, $\mathfrak a := \{1_H, x\}^{\ast 2}$ and $\mathfrak b := \{1_H, x^2\}^{\ast 2}$ are both minimal factorizations of $H$ in $\mathcal P_{\fin,1}(H)$. However, $(\mathfrak a, \mathfrak b) \notin \C_{\mathcal P_\fun}(H)$, because $\mathcal P_\fun(H)$ is a reduced monoid. Therefore, $\mathcal P_\fun(H)$ is not minimally factorial, so leading to a contradiction and completing the proof.
\end{proof}
%
At this point, we have completely characterized the correlation between the ground monoid $H$ and whether $\P_\fun(H)$ has factorization properties such as atomicity, BFness, etc., and their minimal counterparts.
In most cases, this extends to a characterization of whether the same properties hold for $\P_\funt(H)$, with the exception of the gap suggested by Theorem \ref{prop:HF-exp-3} and Corollary \ref{cor:when-reduced-pm-is-minimally-factorial}.
In particular, it still remains to determine the monoids $H$ which make $\P_\funt(H)$ HmF or minimally factorial.
However, what we have shown indicates, we believe, that the arithmetic of $\P_\fun(H)$ and $\P_\funt(H)$ is robust and ripe for more focused study.

\section{Cyclic Monoids and Interval Length Sets}
\label{sec:cyclic-case} 
For those monoids $H$ with $\P_\fun(H)$ atomic, we have by Proposition \ref{lem:no-non-id-elts-of-small-order-implies-structure} that the semigroup generated by an element $x\in H$ is isomorphic either to $\ZZ/n\ZZ$ or to $\NN$ under addition.
As such, we will concentrate throughout on factorizations in $\P_{\fin,0}(\ZZ/n\ZZ)$ and also mention some results on $\P_{\fin,0}(\NN)$ which are discussed in detail in \cite[\S{ }4]{fan-tringali18}.
At the end we will return to the general case, where the preceding discussion will culminate in a realization result (Theorem \ref{th:interval-lengths}) for sets of minimal lengths of $\P_\fun(H)$.

We invite the reader to review \S{ }\ref{subsec:generalities} before reading further. Also, note that, through the whole section, we have replaced the notation $\P_\fun(H)$ with $\P_{\fin,0}(H)$ when $H$ is written additively (cf. Example \ref{exa:strict-inclusion}).


\begin{defn}\label{NR-factorization}
	Let $X \in \mathcal P_{\fin,0}(\ZZ/n\ZZ)$. We say that a non-empty factorization $\mathfrak a = A_1 \ast \cdots \ast A_\ell \in \mathcal{Z}(X)$ is a \emph{non-reducible factorization} (or, shortly, an \emph{\textup{NR}-factorization}) if $ \max\hat{A}_1 + \dots + \max\hat{A}_\ell = \max \hat{X}$.
\end{defn}

This condition on factorizations will allow us to bring calculations up to the integers, where sumsets are more easily understood.
More importantly, NR-factorizations are very immediately relevant to our investigation of minimal factorizations.

\begin{lemma}\label{NR-factorizations-are-minimal}
Any \textup{NR}-factorization in $\P_{\fin,0}(\ZZ/n\ZZ)$ is a minimal factorization.
\end{lemma}

\begin{proof}
Let $\mathfrak{a} = A_1 \ast \cdots \ast A_\ell$ be an NR-factorization in $\mathcal P_{\fin,0}(\ZZ/n\ZZ)$ of length $\ell$, and assume for the sake of contradiction that $\mathfrak a$ is not minimal. Since
$\P_{\fin,0}(\ZZ/n\ZZ)$ is reduced and commutative, the factorizations which are $\C_{\P_{\fin,0}(\ZZ/n\ZZ)}$-congruent to $\mathfrak{a}$ are exactly the words $A_{\sigma(1)} \ast \cdots \ast A_{\sigma(\ell)}$, where $\sigma$ is an arbitrary permutation of the interval $[ 1, \ell ]$.
So, on account of Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(i)}, the non-minimality of $\mathfrak{a}$ implies without loss of generality that $\ell \ge 3$ and $
X := A_1 + \cdots + A_\ell = A_1 + \cdots + A_k$ for some $k \in [ 1, \ell-1 ]$. 

Now, let $x \in X$ such that $\hat{x} = \max \hat{X}$. Using that $\mathfrak a$ is an NR-factorization, and considering that, for each $i \in [ 1, \ell ]$, $A_i$ is an atom of $\mathcal P_{\fin,0}(\ZZ/n\ZZ)$ and hence $\max \hat{A}_i \ge 1$, it follows from the above that
\begin{equation}\label{equ:inequ-with-maxima}
\hat{x} = \max\hat{A}_1+\max\hat{A}_2+\cdots+\max\hat{A}_\ell > \max\hat{A}_1 + \dots + \max\hat{A}_k,
\end{equation}
On the other hand, since $X = A_1 + \cdots + A_k$, there are $a_1 \in A_1,\dots, a_k \in A_k$ such that $a_1+\dots+ a_k = x$, from which we see that $\hat{x} \equiv \hat{a}_1 + \cdots + \hat{a}_k \bmod n$. But it follows from \eqref{equ:inequ-with-maxima} that
$
0 \le \hat{a}_1+\dots+ \hat{a}_k < \hat{x} < n$, and this implies $\hat{x} \not\equiv \hat{a}_1 + \cdots + \hat{a}_k \bmod n$ (recall that, by definition, $\hat{X} \subseteq [ 0, n-1 ]$). So we got a contradiction, showing that $\mathfrak a$ was minimal and completing the proof.
\end{proof}


We are aiming to find, for every $k\in[ 2, n-1]$, a set $X_k\in\P_{\fin,0}(\ZZ/n\ZZ)$ for which $\mathsf{L}^\m(X_k) = [ 2, k ]$, on the assumption that $n\ge 5$ is odd:
Surprisingly, most of the difficulty lies in showing that $2\in \mathsf{L}^\m(X_k)$.
To do this, we first need to produce some large atoms.

\begin{prop}\label{large-atom-construction}
Let $n\ge 5$ be odd.
Then the following sets are atoms of $\mathcal P_{\fin,0}(\ZZ/n\ZZ)$:
\begin{enumerate}[label={\rm (\roman{*})}]
\item\label{it:large-atom-construction(i)} $B_h := \bigl\{\overline{0}\} \cup \{\overline{1},\overline{3},\dots, \overline{h}\bigr\}$ for odd $h\in [ 1,(n-1)/2 ]$.
\item\label{it:large-atom-construction(ii)} $C_1 := \bigl\{\overline{0}, \overline{2}\bigr\}$, $C_3 := \bigl\{\overline{0},\overline{2},\overline{3},\overline{4}\bigr\}$, and $C_\ell := B_\ell\cup\bigl\{\overline{\ell+1}\bigr\}$ for odd $\ell\in [ 5, (n-1)/2 ]$.
\end{enumerate}
\end{prop}

\begin{proof}
\ref{it:large-atom-construction(i)} Let $h \in [ 1, (n-1)/2 ]$ be odd, and suppose that $B_h = X + Y$ for some $X,Y\in \mathcal P_{\fin,0}(\ZZ/n\ZZ)$.
Then $X$ and $Y$ are subsets of $B_h$, so
\[
\max\hat{X} + \max\hat{Y} \le 2\max\hat{B}_h = 2h \le n-1.
\]
Because $\overline{1}\in B_h$, we must have $\overline{1}\in X\cup Y$.
However, if $\overline{1}\in X$ and $a\in Y$ for some $a \in B_h\setminus\{\overline{0}\}$, then  $1+\hat{a} \in \hat{X} + \hat{Y}$ is even, which is impossible since $\max\hat{X} + \max\hat{Y} < n$ and $\hat{B}_h \setminus\{0\}$ consists only of odd numbers.
Thus $Y = \{\overline{0}\}$, and hence $B_h$ is an atom.

\ref{it:large-atom-construction(ii)}
$C_1$ is an atom by Lemma \ref{lem:2-elt-atoms}\ref{it:lem:2-elt-atoms(i)} and it is not too difficult to see that so is $C_3$. Therefore, let $\ell\ge 5$ and suppose $C_\ell = X+Y$ for some $X,Y\in \mathcal P_{\fin,0}(\ZZ/n\ZZ)$ with $X,Y\neq\bigl\{\overline{0}\bigr\}$.

First assume that $\overline{\ell+1}\notin X\cup Y$. Then $\hat{X}$ and $\hat{Y}$ consist only of odd integers, so $\hat{x}+\hat{y}$ is an even integer in the interval $[ 2, n-1 ]$ for all $x\in X\setminus\bigl\{\overline{0}\bigr\}$ and $y\in Y\setminus\bigl\{\overline{0}\bigr\}$.
However, $\hat{X}+\hat{Y} = \hat{C}_\ell$ and the only non-zero even element of $\hat{C}_\ell$ is $\ell+1$. Thus, it must be that $X = \bigl\{\overline{0},x\bigr\}$ and $Y = \bigl\{\overline{0},y\bigr\}$ for some non-zero $x, y \in \ZZ/n\ZZ$, with the result that $|X+Y| \le 4 < |C_\ell|$, a contradiction.

It follows (without loss of generality) that $\overline{\ell+1}\in Y$.
Then $X \subseteq \bigl\{\overline{0},\overline{\ell},\overline{\ell+1}\bigr\}$, for, if $x\in X$ with $0 < \hat{x} < \ell$, then $\hat{x} + \ell+1 \in \hat{C}_\ell$, which is impossible since $\hat{x}+\ell+1 \in [ \max\hat{C}_\ell+1 , n-1 ]$.
This in turn implies that $Y \subseteq \bigl\{\overline{0},\overline{1},\overline{\ell},\overline{\ell+1}\bigr\}$ for similar reasons. As a consequence,
\[
X+Y
\subseteq \bigl\{\overline{0},\overline{\ell},\overline{\ell+1}\bigr\}
+ \bigl\{\overline{0},\overline{1},\overline{\ell},\overline{\ell+1}\bigr\}
= \bigl\{ \overline{0}, \overline{1}, \overline{\ell}, \overline{\ell+1}, \overline{2\ell},\overline{2\ell+1}, \overline{2\ell+2} \bigr\}
\]
However, $\ell+1 < 2\ell \le n-1$, so we cannot have $\overline{2\ell}\in X+Y$. Then $2\ell+1 = n$, in which case $\overline{2\ell+1} = \overline{0}$ and $\overline{2\ell+2} = \overline{1}$; or $2\ell+1 < n$, so that $\overline{2\ell+1}, \overline{2\ell+2} \notin C_h$ (recall that $\ell \le (n-1)/2$). In either case, we get $X+Y \subseteq \bigl\{ \overline{0}, \overline{1}, \overline{\ell}, \overline{\ell+1}\bigr\}$, hence $|X+Y| \le 4 < |C_\ell|$, which is a contradiction and leads us to conclude that $C_\ell$ is an atom.
\end{proof}

Now that we have found large atoms in $\P_{\fin,0}(\ZZ/n\ZZ)$, we can explicitly give, for each $k\in [ 2,n-1]$, an element $X_k\in \P_{\fin,0}(\ZZ/n\ZZ)$ which has a (minimal) factorization of length $2$.

\begin{lemma}\label{2-atom-factorization}
Fix an odd integer $n\ge 5$ and let $k\in [ 2, n-1 ]$.
Then the set $X_k = \{\overline{0},\overline{1},\dots, \overline{k}\}$ has an \textup{NR}-factorization into two atoms in $\P_{\fin,0}(\ZZ/n\ZZ)$.
\end{lemma}

\begin{proof}
We will use the atoms $B_h$ and $C_\ell$ as defined in Proposition \ref{large-atom-construction}. We claim that, for every $r\in\{0,1\}$ and all odd $h\in [ 1, (n-1)/2 ]$,
%
\[
\hat{B}_{h+2r}+\hat{C}_h = [ 0, 2h+2r+1 ]
\quad\text{and}\quad
\hat{C}_{h+2r} + \hat{C}_{h} = [ 0, 2r+2h+2].
\]
We will only demonstrate that $\hat{B}_h + \hat{C}_h = [ 0, 2h+1 ]$ (the other cases are an easy consequence).
The claim is trivial if $h=1$ or $h=3$, so suppose $h \ge 5$.
Then
\[
\hat{B}_h + \hat{C}_h \supseteq \{1,3,\dots,h\} + \{0, h+1\} = \{1,3,\dots, 2h+1\}
\]
and
\[
\hat{B}_h + \hat{C}_h \supseteq \{1,3,\dots,h\} + \{1, h\} = \{2,4,\dots, 2h\},
\]
so $\hat{B}_h +\hat{C}_h \supseteq [ 0 , 2h+1 ]$.
This gives that $\hat{B}_h +\hat{C}_h = [ 0 , 2h+1 ]$, since $\max\hat{B}_h+\max\hat{C}_h = h+(h+1)$.

Accordingly, we now prove that $X_k$ can be expressed as a two-term sum involving $B_h$ and $C_\ell$, for some suitable choices of $h$ and $\ell$ depending on the parity of $k$.
\begin{enumerate}[leftmargin=1.8cm,label={\textsc{Case }\arabic{*}:}]
	\item $k = 2m+1$ (i.e., $k$ is odd). Then it is immediate to verify that $X_k = B_m+C_m$ if $m$ is odd, and $X_k = B_{m+1} +C_{m-1}$ if $m$ is even.
	\item $k = 2m$ (i.e., $k$ is even). Since $X_2 = B_1+B_1$ and $X_4 = B_1+B_3$, we may assume $m\ge3$. Then it is seen that $X_k = C_{m} + C_{m-2}$ if $m$ is odd, and $X_k = C_{m-1}+C_{m-1}$ if $m$ is even.
\end{enumerate}
We are left to show that the decompositions given above do in fact correspond to minimal factorizations. As an example, consider the case when $k=2m+1$ and $m$ is odd (the computation will be essentially identical in the other cases).
Then $\max\hat{B}_{m}+\max\hat{C}_m = 2m+1$, so that $B_m \ast C_m$ is an NR-factorization of $X_k$, and is hence minimal by Proposition \ref{NR-factorizations-are-minimal}.
\end{proof}



\begin{lemma}\label{lem:interval-minimal-length-sets}
Fix an odd integer $n\ge 3$ and, for each $k\in [2,n-1]$, let $X_k := \{\overline{0},\overline{1}, \dots, \overline{k} \} \in  \P_{\fin,0}(\ZZ/n\ZZ)$.
Then $\mathsf{L}^\m(X_k) = [ 2,k ]$.
\end{lemma}

\begin{proof}
We have already established in Lemma \ref{2-atom-factorization} that $X_2$ has an NR-factorization of length $2$.
Now fix $k \in [ 3, n-1 ]$ and suppose that, for all $h \in [ 2, k-1 ]$ and $\ell \in [ 2,h ]$, $X_h$ has an NR-factorization of length $\ell$.
Choose some $\ell \in [ 2,k-1 ]$; $X_{k-1}$ has an NR-factorization $\mathfrak{a}$, and it is straightforward to see that $\{\overline{0},\overline{1}\}*\mathfrak{a}$ is an NR-factorization of $X_k$.
Letting $\ell$ range over $[ 2,k-1]$, this argument, Lemma \ref{NR-factorizations-are-minimal}, and Lemma \ref{2-atom-factorization} imply that $\mathsf{L}^\m(X_k) \supseteq [ 2, k ]$.
Moreover, Proposition \ref{prop:bounded-minimal-fzn}\ref{it:prop:bounded-minimal-fzn(i)} yields the other inclusion and so we have  $\mathsf{L}^\m(X_k) = [ 2,k ]$.
\end{proof}


\begin{lemma}\label{prop:intervals-in-N}
Let $H$ be a non-torsion monoid.
Then $\mathcal{L}(\P_{\fin,0}(\NN)) \subseteq \mathcal{L}^\m(\P_\fun(H))$, and for every $k\ge 2$ there exists $Y_k\in \P_\fun(H)$ with $\mathsf{L}^\m(Y_k) = [ 2, k ]$.
\end{lemma}

\begin{proof}
Suppose that $y\in H$ has infinite order, and set $Y := \{y^k: k \in \NN\}$. Clearly, $Y$ is a submonoid of $H$, and the (monoid) homomorphism $(\NN,+) \to Y: k \mapsto y^k$ determined by sending $1$ to $y$ induces an iso\-morphism $\P_{\fin,0}(\NN) \to \P_\fun(Y)$.
Since, by Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(iii)}, $\P_\fun(Y)$ is a divisor-closed submonoid of $\P_\fun(H)$, we thus have by parts \ref{it:prop:min-basics(iii)} and \ref{it:prop:min-basics(iv)} of Proposition \ref{prop:min-basics} that
\[
\mathcal{L}(\P_{\fin,0}(\NN)) = \mathcal{L}^\m(\P_{\fin,0}(\NN)) = \mathcal{L}^\m(\P_\fun(Y)) \subseteq \mathcal{L}^\m(\P_\fun(H)).
\]
The rest of the statement now follows from the above and \cite[Proposition 4.8]{fan-tringali18}.
\end{proof}




\begin{thm}\label{th:interval-lengths}
Assume $H$ is a monoid such that $1_H \neq x^2 \neq x$ for all $x\in H\setminus\{1_H\}$, and set $N := \sup\{\ord_H(x) : x\in H \}$.
Then $[ 2, k ] \in \mathcal{L}^\m(\P_\fun(H))$ for every $k \in [ 2, N-1 ]$.
\end{thm}

\begin{proof}
If $H$ is non-torsion, this follows immediately from Lemma \ref{prop:intervals-in-N}.
Otherwise, let $k\in [ 2, N-1 ]$ and $y\in H$ with $n := \ord_H(x) > k$.
Then $Y :=\gen{y}_H \cong \ZZ/n\ZZ$, so we have by Proposition \ref{prop:pm-arith}\ref{it:prop:pm-arith(iii)}, Lemma \ref{lem:interval-minimal-length-sets}, and Proposition \ref{prop:min-basics}\ref{it:prop:min-basics(iii)} that
$[ 2, k ] \in \mathcal{L}^\m(\P_\fun(Y)) \subseteq \mathcal{L}^\m(\P_\fun(H))$.
\end{proof}
