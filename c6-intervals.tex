%\chapter{Atoms and Intervals in the Natural Power Monoid}
\chapter{Enumerating Factorizations of Intervals} \label{ch:intervals}

This chapter will continue to focus on the natural power monoid $\PN$ and on the intervals $[0,n]$.
We saw in Theorem \ref{thm:good types} that intervals have factorizations of almost every partition type, which already implies the cardinality of $\mathsf{Z}_\PN([0,n])$ is at least about as large as $p(n)$, which is asmpytotic to $\frac{1}{4n\sqrt{3}} \exp\left(\pi\sqrt{\frac{2n}{3}}\right)$ (see \cite{hardy-ram18}, \cite{erdos42}, or \cite{nathanson02}).
Thus the cardinality of $\mathsf{Z}_\PN([0,n])$ grows at least sub-exponentially in $n$; we show here that it in fact grows exponentially (Theorem \ref{thm:exponential intervals}).
We will build toward this goal in several steps, beginning with the construction of a large and easily parameterizable family of atoms.


\section{Construction of Residually Concentrated Atoms}

%As one finds when studying $\PN$, determining whether a given subset of $\NN$ is an atom can be difficult.
%Section \ref{sec:algorithms} indicates some ways of thinking about subset arithmetic which make this task simpler when given a particular subset.  
%A separate challenge is to systematically generate large collections of atoms; this is our primary undertaking in this section.

\begin{defn} \label{def:resid concentrated}
Let $m\ge 2$, $r\in [0,m-1]$.
We will say that $S\in \PN$ is \textbf{$r$-concentrated (modulo $m$)} if
\[ |S_{>0} \cap (\NN m + t)| \le 1 \textrm{ for all $t\in [0,m-1]\setminus\{r\}$.} \tag{$*$} \]
%\[|\{s\in S_{>0}: s\equiv t \mod m\}|\le 1 \quad \textrm{for all $t\in [0,m-1]\setminus\{r\}$.}  \tag{$*$}\]
Equivalently, if $S$ is $r$-concentrated, then there are (unique) $R,B\subseteq \NN$ such that
\begin{itemize}
	\item $0\notin R \subseteq \NN m + r$;
	\item $0\notin B \subseteq \NN \setminus (\NN m + r)$;
	\item $S = \{0\} \cup R \cup B$;
	\item For each $b\in B$ and $s\in S_{>0}$, $s\equiv b \mod m$ implies that $s = b$.
\end{itemize}
%Suppose $B\subseteq \NN \setminus (\NN m + r)$ with $0\notin B$.
%We will say $\{0\}\cup R \cup B$ is \textbf{$r$-concentrated (modulo $m$)} if
%\[|\{b\in B: b\equiv c \mod m\}| \le 1 \quad \textrm{for all } c\in [0,m-1] \tag{$*$} \]
%(Of course, we already have $\{b\in B: b\equiv r \mod m\}=\emptyset$).

For our later convenience, let $\mathcal{X}_{m,r}$ be the collection of all subsets of $\NN$ which are $r$-concentrated modulo $m$.
\end{defn}

We claim that many elements of the collection $\mathcal{X}_{m,r}$ are atoms of $\PN$.
Toward proving this, we give the following lemmas.
Throughout what follows, $m$, $r$, $R$, and $B$ are all assumed to be as in Definition \ref{def:resid concentrated} unless otherwise specified.

\begin{lemma} \label{lem:other summand small}
Let $Z := \{0\}\cup R \cup B\in \mathcal{X}_{m,r}$ and suppose that $Z = X+Y$.
If there is $x\in X$ with $x\not\equiv 0 \mod m$ then $|Y\cap R| \le 1$.
\end{lemma}

\begin{proof}
If $Y\cap R=\emptyset$ then the result is trivial, so suppose $y,y'\in Y\cap R$.
Then $x+y \equiv x+y' \not\equiv r \mod m$ so, by the $r$-concentratedness of $Z$ (condition ($*$) in Definition \ref{def:resid concentrated}), $x+y = x+y'$.
From here it is clear that $y=y'$ and the result follows.
\end{proof}

The next lemma amounts merely to unpacking a sum decomposition of an $r$-concentrated set, but a special case of this result will serve us several times in constructing atoms out of members of $\mathcal{X}_{m,r}$.

\begin{lemma} \label{lem:both summands small}
Let $Z := \{0\}\cup R \cup B\in \mathcal{X}_{m,r}$, suppose that $Z = X + Y$, and say $n_1 = |X\cap R|$ and $n_2 = |Y\cap R|$.
\begin{enumerate}[label={\rm (\roman{*})}]
\item Then $|R| \le (1+\delta_{\bar{0}}(Y\cap B))n_1 + (1+\delta_{\bar{0}}(X\cap B))n_2 + \delta_{\bar{0}}(R)n_1n_2 + |2B \cap R|$,
where 
\[\delta_{\bar{0}}(S) = 
\begin{cases}
1& \textrm{if $S$ has an element $s \equiv 0 \mod m$} \\
0& \textrm{otherwise}.
\end{cases}\]
\item If $n_1,n_2 \le 1$ then $|R| \le 3 + |2B\cap R|$.
\end{enumerate}
\end{lemma}

\begin{proof}
For (i): first observe that $X = \{0\}\cup (X\cap R) \cup (X\cap B)$ and $Y = \{0\}\cup (Y\cap R) \cup (Y\cap B)$.
Then, since each of $X$ and $Y$ is the union of $3$ sets, $X+Y$ can be written as a union of $9$ sets; namely, the sums of each pair chosen from $\{\{0\}, X\cap R, X\cap B\} \times \{ \{0\}, Y\cap R, Y\cap B\}$, as in:
\begin{align*}
X+Y &= \{0\}\cup (X\cap R) \cup (X\cap B) + \{0\} \cup (Y\cap R) \cup (Y\cap B) \\
&= \{0\}\cup (X\cap R) \cup (X\cap B) \cup (Y\cap R) \cup (Y\cap B) \\
& \quad\; \cup (X\cap R + Y\cap B) \cup (X\cap B + Y\cap R)\\
& \quad\; \cup (X\cap R + Y\cap R) \cup (X\cap B + Y\cap B).
\end{align*}
To bound the size of $R = R\cap (X+Y)$, we will look at the intersection of $R$ with each of these $9$ sets.  
Fortunately, it is easy to see that $\{0\}$, $X\cap B$, and $Y\cap B$ have trivial intersection with $R$ and that $X\cap R$ and $Y\cap R$ are already subsets of $R$.
In total, these contribute $|X\cap R| + |Y\cap R| = n_1+n_2$ to our running estimate for $|R|$.

We turn toward examining the remaining sets; first look at $R \cap (X\cap R + Y\cap B)$.
Suppose $x\in X\cap R$ and $y\in Y\cap B$ with $x+y\in R$; then we must have $y\equiv 0 \mod m$.
If $B$ has such a $y$ then
\[|R\cap (X\cap R + Y\cap B)| \le |X\cap R + \{y\}| = |X\cap R|=n_1. \]
Otherwise, $X\cap R + Y\cap B$ does not intersect $R$, so we have $|R\cap (X\cap R + Y\cap B)| \le  \delta_{\bar{0}}(Y\cap B) n_1$.

%There is at most one such $y\in Y\cap B$, so $|R\cap (X\cap R + Y\cap B)| =\delta_{\bar{0}}(Y\cap B)|X\cap R|=\delta_{\bar{0}}(Y\cap B)n_1$.
%Similarly, $|R\cap (X\cap B + Y\cap R)| = \delta_{\bar{0}}(X\cap B)n_2$.

If $r\not\equiv 0 \mod m$ then $R \cap (X\cap R + Y\cap R) =\emptyset$; on the other hand, if $r\equiv 0 \mod m$ then $(X\cap R+Y\cap R)\subseteq R$, so we may say that $|R\cap (X\cap R + Y\cap R)| \le \delta_{\bar{0}}(R) n_1n_2$.
Finally, we may note that $R\cap (X\cap B + Y\cap B) \subseteq R\cap 2B$.

Putting all of these observations together, we obtain our desired estimate that $|R| \le (1+\delta_{\bar{0}}(Y))n_1 + (1+\delta_{\bar{0}}(X))n_2 + \delta_{\bar{0}}(R)n_1n_2 + |2B \cap R|$.

We can see (ii) by using what we have just proved, and by showing that at most one of $\delta_{\bar{0}}(X\cap B)$, $\delta_{\bar{0}}(Y\cap B)$, and $\delta_{\bar{0}}(R)$ is nonzero.
Firstly, note that
\[\delta_{\bar{0}}(R) = \begin{cases}
1 & \textrm{if } r = 0 \\
0 & \textrm{if } r\neq 0
\end{cases}.\]
By construction, $B$ and $R$ don't share any residue classes modulo $m$, so $B$ cannot have any elements congruent to $0$ if $R$ does (and vice-versa).  
All that remains is to see that $X\cap B$ and $Y\cap B$ cannot both have an element congruent to $0$; if they do, then there is a single $b \equiv 0 \mod m$ (by $r$-concentratedness) with $b\in X\cap Y \cap B$.
However, we immediately see that this is impossible because we would have that $2b \in X+Y$, but $2b \equiv b$, which contradicts the $r$-concentratedness of $X+Y$.
Thus $\delta_{\bar{0}}(X\cap B) + \delta_{\bar{0}}(Y\cap B) + \delta_{\bar{0}}(R) \le 1$ and the inequality from (i) reduces to $|R| \le (1+\delta_{\bar{0}}(Y\cap B)+ (1+\delta_{\bar{0}}(X\cap B)) + \delta_{\bar{0}}(R) + |2B\cap R| \le 3 + |2B \cap R|$.
\end{proof}

\begin{prop} \label{prop:resid concentrated atoms}
Let $m\ge 2$, $r\in [0,m-1]$, and let $A := \{0\}\cup R \cup B$ with $R$ and $B$ as in Definition \ref{def:resid concentrated}.
If 
\begin{enumerate}[label={\rm (\arabic{*})}]
	\item $B\neq \emptyset$ or $r\neq 0$,
	\item $|R| > 3 + |R\cap 2B|$, and
	\item $B \neq \{b\}$ with $b\equiv 0 \mod m$ such that $\{0,b\}$ divides $A$,
\end{enumerate}
then $A$ is an atom in $\PN$.
\end{prop}

\begin{proof}
Suppose $A = X + Y$ with $X,Y\neq\{0\}$.

\noindent \underline{Case 1}: $\max(A)\in B$.

Then there exist $x\in X_{>0}$ and $y\in Y_{>0}$ such that $x+y = \max(A)$.
Since, by $r$-concentratedness, $\max(A)$ is the only element of $A$ of its residue class modulo $m$, $x,y\not\equiv 0 \mod m$.
Now, by two applications of Lemma \ref{lem:other summand small}, $|X\cap R|, |Y\cap R|\le 1$.
Using Lemma \ref{lem:both summands small}, we see that $|R| \le 3 + |R\cap 2B| < |R|$, a contradiction.

\noindent \underline{Case 2}: $\max(A) \in R$.

\noindent \underline{Subcase 2A}: There are $x\in X\cap B$ and $y\in Y\cap B$ so that $x+y = \max(A)$.

Then $x,y\not\equiv \max(A) \mod m$, so $x,y\not\equiv 0 \mod m$ and we may proceed as in the preceding case.

\noindent \underline{Subcase 2B}: There are $x\in X\cap R$ and $y\in Y\cap R$ so that $x+y = \max(A)$.

Now we have that $r+r\equiv r \mod m$, so $r = 0$.
Since $B\subseteq A = X+Y$ but $R+R \subseteq \NN m$, we must have $B \subseteq X \cup Y$.
However, if $b\in B\cap X$ then $b+y \equiv b \mod m$, which is a violation of the $r$-concentratedness of $A$ (since $y\neq 0$ and so $b+y\neq b$).
It must be that $X\cap B = \emptyset$ (and similarly, $Y\cap B = \emptyset$).
Now $A = X+Y = \{0\}\cup (X\cap R) + \{0\}\cup (Y\cap R) \subseteq \NN m$, from which we conclude that $B = \emptyset$.
This is a contradiction to condition (2) in the statment of the proposition.

\noindent \underline{Subcase 2C}: There are $b\in X\cap B$ and $y\in Y\cap R$ such that $b + y = \max(A)$.

Immediately, we have that $b + r \equiv r \mod m$, so $b \equiv 0 \mod m$ and $r \neq 0$.
By Lemma \ref{lem:other summand small}, $|X\cap R| \le 1$.
If $x\in X\setminus \{0,b\}$ then $x\not\equiv 0\mod m$ and so we also have $|Y\cap R| \le 1$, whence we may finish by using Lemma \ref{lem:both summands small} as in Case 1.

Let us suppose, instead, that $X = \{0,b\}$.
If $c\in Y\cap B$ then $b+c \equiv c \mod m$, which violates $r$-concentratedness.
Thus $Y\cap B = \emptyset$ and so $Y\subseteq \{0\}\cup R$.
From this, we can deduce that since the elements of $A = X+Y$ are either $b$ or congruent to $r$, $B = \{b\}$.
This yields a contradiction of condition (3), finishing the proof.
\end{proof}

\section{Nacci Numbers and Sets with Bounded Maximum Gap}

\begin{defn} \label{def:maxgap}
Let $S = \{s_0,\dots, s_k\} \subseteq \NN$ be a nonempty subset with $s_0 < \dots < s_k$.
We will say that, for each $i\in [1,k]$, $s_{i-1}$ and $s_i$ are \textit{consecutive} elements of $S$, and we define the \textbf{maximum gap} of $S$ $\maxgap(S) := \max \{s_i - s_{i-1} : i\in [1,k]\}$ to be the largest distance between consecutive elements of $S$.

For a fixed $h\ge 1$, let $\mathcal{G}_h := \{S\subseteq \NN: \maxgap(S) \le h\}$.
\end{defn}

For the sake of noting some concrete examples: we have $\maxgap([0,n]) = 1$ for every $n$, $\maxgap(\{0,2,4,6\}) = 2$, and $\maxgap(\{0,1,2,4,8\}) = 4$.
This is meant to be a rudimentary measure of how sparse a set $S$ is.

Our next goal, for a fixed $n$ and $h$, is to estimate the number of atoms with $\max(A) = n$ and $\maxgap(A) \le h$; that is, the size of the set $\A^{(n)}\cap \mathcal{G}_h$.
We have just shown the existence of a fairly sizable class of atoms (the residually concentrated atoms) with a specific structure.  
Our next step is to exploit this structure to gain a lower bound on the number of these atoms.
Specifically, we would like to give a lower estimate for the number of elements of $\mathcal{A}^{(n)}\cap \mathcal{X}_{m,r} \cap \mathcal{G}_h$, the collection of atoms with maximum equal to $n$, which are $r$-concentrated (modulo $m$), and have a maximum gap of at most $h$.

Given $S\in \mathcal{A}^{(n)}\cap \mathcal{X}_{m,r}$, we may write $S = \{0\}\cup R \cup B$, where $R \subseteq [1,n]\cap (\NN m+r)$ and $B\subseteq \NN\setminus (\NN m + r)$.
We first observe that if $\maxgap(R)\cup\{0,n\}\le h$ then $\maxgap(S)\le h$. 
This is because $R\subseteq S\subseteq [0,n]$, so the consecutive elements of $S$ are at least as close as those of $R\cup\{0,n\}$.
Thus, to find a lower bound on the number of possible $S\in \mathcal{P}^{(n)}\cap \mathcal{X}_{m,r}\cap \mathcal{G}_h$, it suffices to find a lower bound on the number of possible $R$ arising from such $S$.
We pivot now to characterizing such $R$ to answer this question.

%As a starting point, we will estimate the number of sets $R\subseteq \NN m+ r$ which have bounded maximum and maximum gap.

%Let $\A_{m,r}^{(n)} := \mathcal{A}^{(n)} \cap \mathcal{X}_{m,r}$ be the set of $r$-concentrated atoms (modulo $m$) with maximum equal to $n$.
%For our purposes, it will suffice to give an asymptotic lower bound for the size of $\mathcal{A}_{m,r}^{(n)}\cap \mathcal{G}_h$.

%We begin by estimating the size of $\mathcal{X}_{m,r}\cap \mathcal{G}_h$, with the intent of later estimating how many members of this collection are atoms.





\begin{lemma} \label{lem:concentration to tuples}
Let $m\ge 2$, $r\in [0,m-1]$, and $h\ge 2$.
Then the number of subsets $R\subseteq [1,n]\cap (\NN m +r)$ which satisfy $\maxgap(\{0,n\}\cup R) \le h$ is at least $|\mathcal{E}(\lfloor n/m \rfloor,\lfloor h/m \rfloor)|$, where
%Then the number $|\mathcal{P}^{(n)}\cap \mathcal{X}_{m,r}\cap \mathcal{G}_h|$ of sets $S$ which are $r$-concentrated (modulo $m$) with $\max(S) = n$ and $\maxgap(S)\le h$ is at least $|\mathcal{E}(\lfloor n/m \rfloor, \lfloor h/m \rfloor)|$, where
\[ \mathcal{E}(N,t) := \{ \vec{\e}\in \{0,1\}^{N+1}: \vec{\e} \textrm{ has no more than $t$ consecutive zeros}\}. \]
\end{lemma}
\begin{proof}
Begin by defining a map
\begin{align*}
\mathcal{E}(N,t)&\to\{R\subseteq[1,(N+1)m]\cap (\NN m +r): \maxgap(R\cup\{0,(N+1)m\}) \le tm\} \\
\vec{\e} &\to R_{\vec{\e}}
\end{align*}
where, for any $\vec{\e} = (\e_0,\dots,\e_N) \in \mathcal{E}(N,t)$, we set $R_{\vec{\e}} := \{\e_k(km+r): k\in[0,N]\}$.
We wish to show that this map is an injection, which will then prove the statement of the lemma when we take $N = \lfloor n/m \rfloor$ and $t = \lfloor h/m \rfloor$.

%We wish to show that the map $\vec{\e}\to R_{\vec{\e}}$ is an injection from $\mathcal{E}(N,t)$ to $\{R\subseteq[1,(N+1)m]\cap (\NN m +r): \maxgap(R\cup\{0,(N+1)m\}) \le tm\}$, which will then prove the statement of the lemma when we take $N = \lfloor n/m \rfloor$ and $t = \lfloor h/m \rfloor$.

Let $\vec{\e}\in \mathcal{E}(N,t)$.
It is immediate that $R_{\vec{\e}}\subseteq [1,(N+1)m]\cap (\NN m + r)$ since $\max(R_{\vec{\e}}) \le Nm+r$.
To see that $\maxgap(R\cup\{0,(N+1)m\}) \le tm$, suppose that $km+r$ and $(k+\ell)m+r$ are the consecutive elements of $R_{\vec{\e}}$ which are farthest apart.
Then, by the definition of $\mathcal{E}(N,t)$, $k\le t$, so $\maxgap(R\cup \{0,(N+1)m\})\le (k+\ell)m+r - (km+r) \le \ell m \le tm$.
What we have just observed amounts to showing that the map $\vec{\e} \to R_{\vec{\e}}$ is well-defined and, from here, it is not too difficult to see that the map is injective.
%
%We may write $R$ as $R = \{ \e_k(km+r): k\in [0,\lfloor n/m \rfloor] \}$ for some $\vec{\e}_R = (\e_0,\dots,\e_{\lfloor n/m \rfloor}) \in \{0,1\}^{\lfloor n/m \rfloor+1}$ (here we are essentially associating to $R$ an ``indicator function'').
%
%\underline{Claim}: if $\vec{\e}_R$ does not have more than $\lfloor h/m \rfloor$ consecutive zeros, then $\maxgap(R) \le h$.
%
%Suppose that $\vec{\e}_R$ does not have any string of more than $\lfloor h/m \rfloor$ zeros.
%If this is the case, then any consecutive elements of $R$ may be written as $km+r$ and $(k+t)m+r$, where $t\le h/m$.
%Then we have that $(k+t)m+r - (km+r) = tm \le \lfloor h/m \rfloor m \le h$, as we wished.
%
%Thus $R$ corresponds via $\vec{\e}_R$ to an element of $\mathcal{E}(\lfloor n/m \rfloor+1,\lfloor h/m \rfloor)$.
%Given another $R'\subseteq [1,n]\cap (\NN m+ r)$ and a similarly chosen $\vec{\e}_{R'}\in \mathcal{E}(\lfloor n/m \rfloor,\lfloor h/m \rfloor)$, it is not too difficult to see that $\vec{\e}_R = \vec{\e}_{R'}$ only if $R=R'$, so this correspondence is one-to-one.
%Thus we have that 
%\[ |\{ R\subseteq [1,n]\cap (\NN m + r): \maxgap(R)\le h\}| 
%\ge |\mathcal{E}(\lfloor n/m \rfloor, \lfloor h/m \rfloor)|, \]
%which is what we set out to show.
\end{proof}

Now that we can reframe our question in terms of counting special binary sequences, we make an aside on the natue of the growth $\mathcal{E}(N,t)$ as $N$ increases.

\begin{defn} \label{def:nacci numbers}
Let $t\ge 1$.
We will define a function $f_t: \NN \to \NN$ by $f_t(N) = 2^{N+1}$ if $N\le t$ and 
\[ f_t(N) = f_t(N-1) + \cdots + f_t(N-t-1) \]
for all $N>t$.
We shall call $f_t(1), f_t(2),\dots$ the sequence of \textbf{$t$-nacci numbers} (as $f_1$ produces the familiar sequence of \textit{Fibonacci numbers}).
\end{defn}
One notes that our notation differs from that of D. Wolfram in \cite{wolfram98}.
For instance, in his notation, $k=2$ corresponds to the ordinary Fibonacci numbers, leading us to conclude that our $t$ is the same as his $k+1$.
Our initial values are also different; in particular, the first few terms of ``traditional'' nacci sequences may be zero, with the first nonzero term being equal to $1$. 
Thus our $t$-nacci numbers are the same, up to some offset of indices, as the usual $(k+1)$-nacci numbers.
We keep our choice of notation here for the way in which it assists in counting binary sequences which avoid long strings of $0$s, which we will make precise now.

\begin{prop} \label{lem:nacci numbers count tuples}
Let $\mathcal{E}(N,t)$ be as in Lemma \ref{lem:concentration to tuples}. Then $|\mathcal{E}(N,t)| = f_t(N)$ (with $f_t$ as above).
\end{prop}
\begin{proof}
For $N\le t$, any sequence $\vec{\e}\in \{0,1\}^{N+1}$ trivially satisfies the condition of having no more than $t$ consecutive zeros, so we see easily that $|\mathcal{E}(N,t)| = 2^{N+1} = f_t(N)$.  
All that remains is to verify that $|\mathcal{E}(N,t)|$ satisfies the same recurrence relation as $f_t(N)$.
We set the notation, for each $s \in [0,t]$, that $\mathcal{E}_s(N,t) := \{\vec{\e}\in \mathcal{E}(N,t): \e_s = 1 \textrm{ and } \e_i = 0 \textrm{ for all $i\in [0,s-1]$} \}$ (note that these sets are all well-defined, for we adopt the convention that our sequences $\vec{\e}$ are zero-indexed; that is, of the form $\vec{\e} = (\e_0,\e_1,\dots, \e_N)$).

We can see that $\mathcal{E}(N,t) = \bigsqcup_{s=0}^t \mathcal{E}_s(N,t)$ for, given any $\vec{\e}\in \mathcal{E}(N,t)$, the number of leading zeros in $\vec{\e}$ is $s\le t$ (this shows the left-to-right inclusion, and the other is clear by construction).
To show the recurrence from here, we merely need to determine $|\mathcal{E}_s(N,t)|$.
We have that $\vec{\e}\in \mathcal{E}_s(N,t)$ if and only if 
\[\vec{\e} = (\!\!\!\!\!\underbrace{0,\dots,0}_{s \textrm{ leading zeros}}\!\!\!\!\!, 1, \vec{\e}_*),\]
 where $\vec{\e}_*$ has length $N+1 - (s+1) = N-s$, so $\vec{\e}_*\in \mathcal{E}(N-s-1,t)$.
 Thus $|\mathcal{E}_s(N,t)| = |\mathcal{E}(N-s-1,t)|=f_t(N-s-1)$ which, with the disjoint union above, implies that $|\mathcal{E}(N,t)| = f_t(N-1) + \cdots + f_t(N-t-1) = f_t(N)$.
\end{proof}

Now that we have shown the atoms we are concerned with are counted (in part) by $t$-nacci numbers, we borrow some general facts from \cite{wolfram98} about the rate of growth with respect to $N$ of $f_t(N)$.

\begin{prop} \label{prop:nacci growth}
Let $t\ge 1$.
\begin{enumerate}[label = {(\roman{*})}]
	\item The limit $r_t := \lim\limits_{N\to\infty} \frac{f_t(N+1)}{f_t(N)}$ exists;
	\item $2-2^{-t} < r_t < 2$.
\end{enumerate}
\end{prop}

\begin{proof}
Both of these facts (and others) are proved in \cite[Lemma 3.6 and Corollary 3.7]{wolfram98}.
\end{proof}

\section{Lower Bounds for Numbers of Atoms and Factorizations}

Here we return to our main task of determining lower bounds for (1) the number of atoms with a given maximum and (2) the number of factorizations of an interval. 
To aid us, we begin with a lemma that makes practical use of a bounded maximum gap as a ``density'' condition.

\begin{lemma} \label{lem:bounded gap but many elements}
	Let $m\ge 2$, $r\in[0,m-1]$ and $R\subseteq [1,n]\cap(\NN m + r)$ such that $\maxgap(\{0,n\}\cup R) \le h$.
	If $n \ge kh$ then $|R| \ge k$.
\end{lemma}

\begin{proof}
First observe that $\max(R) \ge \lfloor n/m \rfloor m$ and $\min(R) \le m$.
Now we note that $R$ has $|R|-1$ pairs of consecutive elements, each of which has a difference no larger than $h$.
Thus we get
\[ \lfloor n/m \rfloor m - m \le \max(R) - \min(R) \le (|R|-1)\maxgap(R) \le (|R|-1)h, \]
which in turn yields that 
\[|R| \ge \frac{(\lfloor n/m \rfloor -1)m}{h}+1 = \frac{\lfloor n/m \rfloor -1}{h/m}+1 \ge \frac{n/m-2}{h/m}+1 = \frac{n-2/m}{h}+1 \ge \frac{n}{h} \ge k.\qedhere\]
\end{proof}


Now we are in a position to give a lower estimate for the number of \textit{atoms} which are $r$-concentrated modulo $m$ and have fixed maximum and bounded maximum gap.  

\begin{lemma} \label{lem:R and B for atoms}
Let $m\ge 2$, $r\in [0,m-1]$, $R\subseteq [1,n]\cap (\NN m + r)$, and $B \subseteq \NN \setminus (\NN m + r)$ such that, for all $b,b'\in B$, $b\equiv b' \mod m$ only if $b=b'$.
Set $A := \{0\}\cup R \cup B$ and say that $n:=\max(A)$.
If $\maxgap(R) \le h$, $|B|\ge 2$, and $n > (|B|+3)h$ then $A$ is an atom.
\end{lemma}

\begin{proof}
By construction, $A$ is $r$-concentrated (modulo $m$). 
We can see that the assumption $|B|\ge 2$ satisfies conditions (1) and (3) of Proposition \ref{prop:resid concentrated atoms}.
To guarantee that $A$ is an atom, we need to show that $|R| > 3 + |R\cap 2B|$.

Here, we note that $R\cap 2B \subseteq (\NN m + r) \cap 2B$, so it suffices to estimate the number of possible pairs $(a,b)\in B\times B$ such that $a+b\equiv r\mod m$.
Because of the assumption that $B$ only has at most one element of each congruence class modulo $m$, for any $a\in B$ there is at most a single $b\in B$ with $a+b\equiv r$.  
Thus we have $|(\NN m + r)\cap 2B | \le |B|$ and so
\[|R| > |B|+3 \ge |(\NN m + r) \cap 2B| \ge |R\cap 2B| + 3,\]
where the first inequality follows from applying Lemma \ref{lem:bounded gap but many elements} and our assumption that $n\ge (|B|+3)h$.
\end{proof}

\begin{prop} \label{prop:exponential atoms}
Let $h\ge 2$.
Then, for sufficiently large $n$, the number $|\mathcal{A}^{(n)}\cap \mathcal{G}_h|$ of atoms with maximum equal to $n$ and maximum gap bounded by $h$ grows exponentially with respect to $n$, with a growth rate of at least $\sqrt{(2-2^{-\lfloor h/2 \rfloor})}$.
\end{prop}

\begin{proof}
First fix $m\in [2,h]$ and $r\in [0,m-1]$.
We can count the members of $\mathcal{A}^{(n)}\cap \mathcal{X}_{m,r}\cap \mathcal{G}_h$, which will in turn give a lower bound for $|\mathcal{A}^{(n)}\cap \mathcal{G}_h|$.
To enumerate members of the former, we have discovered (via Lemma \ref{lem:R and B for atoms}) that it is sufficient to count the number of 
\begin{itemize}
	\item subsets $B\subseteq [1,n]\setminus(\NN m + r)$ such that $|B\cap (\NN m + s)| \le 1$ for all $s\in [0,m-1]$ and
	\item subsets $R\subseteq [1,n]\cap (\NN m +r)$ such that $\maxgap(\{0,n\} \cup R) \le h$ and $|R| > |B|+3$.
\end{itemize}
To guarantee that the atoms we enumerate have maximum equal to $n$, let us also impose the restriction that $n\in R\cup B$.
Whether $n\in R$ or $n\in B$ depends on if $n\equiv r \mod m$, but in either case we may always ensure that $n\in R\cup B$.

Let us start by determining the number of feasible $B$.
Since $|B\cap (\NN m + s)|\le 1$ for all $s\in [0,m-1]$, we have $|[1,n]\cap (\NN m + s)| \ge \lfloor n/m \rfloor$ choices for each $s$.
Assuming (in the worst case) that $n\not\equiv r\mod m$, one of these choices is not free and we are forced to choose $n\in B$.
This still leaves at least $\lfloor n/m \rfloor ^{m-2}$ choices for $B$.

Now we turn to count the subsets $R$ fitting the specifications above.
Assume $n \ge (m+3)h$.
If $R\subseteq [1,n]\cap (\NN m + r)$ such that $\maxgap(\{0,n\}\cup R)\le h$ then Lemma \ref{lem:bounded gap but many elements} yields that $|R| > m+2 \ge |B| + 3$ (where the second inequality follows from the restriction that $B$ may have at most one element of any residue class $\not\equiv r$ modulo $m$).
This ensures, by Lemma \ref{lem:R and B for atoms}, that $A:= \{0\}\cup R \cup B$ is an atom.  

The number of such $R$ as specified above is at least $|\mathcal{E}(\lfloor n/m \rfloor,\lfloor h/m\rfloor)| = f_{\lfloor h/m \rfloor}(\lfloor n/m \rfloor)$ (Lemmas \ref{lem:concentration to tuples} and \ref{lem:nacci numbers count tuples}), whence Proposition \ref{prop:nacci growth} implies that the number of such $R$ grows exponentially as $n$ increases.
That is, there is some absolute constant $C_{h,m}$ which depends possibly on $m$ and $h$ (but not on $n$) such that 
\[|\{R\subseteq [1,n]\cap (\NN m +r): \maxgap(\{0,n\}\cup R)\}| \ge f_{\lfloor h/m \rfloor}(\lfloor n/m\rfloor) \ge C_{h,m} (2-2^{-\lfloor h/m\rfloor})^{\lfloor n/m \rfloor}. \]
We conclude then that $|\mathcal{A}^{(n)}\cap \mathcal{G}_h| \ge C_{h,m}(2-2^{-\lfloor h/m \rfloor})^{\lfloor n/m \rfloor}$, so $|\mathcal{A}^{(n)}\cap \mathcal{G}_h|$ has an exponential growth rate of at least $(2-2^{-\lfloor h/m\rfloor})^{1/m}$.
One can further maximize this quantity by choosing $m=2$ to obtain a growth factor of at least $\sqrt{(2-2^{-\lfloor h/2 \rfloor})}$.
\end{proof}

As a consequence of this, we may now produce many distinct factorizations of intervals into atoms.

\begin{thm} \label{thm:exponential intervals}
Let $n\ge 2$.
Then the number $|\mathsf{Z}([0,n])|$ of factorizations of the interval $[0,n]$ into atoms of $\PN$ grows exponentially with $n$.
Specifically, for every $\e>0$ there is a constant $C$  such that $|\mathsf{Z}([0,n])| \ge C \left(\sqrt[4]{2}-\e\right)^n$ for all sufficiently large $n$.
\end{thm}

\begin{proof}
Let $P = (m_1,\dots, m_k)$ be a partition of $n$ such that $m_1 > m_2$.
For notational hygiene, set $m_1$ and let $Q = (m_2,\dots, m_k)$ be the partition of $n-m$ obtained by removing the first part of $P$.

Observe that, if $A\in \mathcal{A}^{(m_1)}\cap \mathcal{G}_{n-m_1}$ and $\aa\in \Z^Q([0,n-m_1])$, then $A*\aa\in \Z^P([0,n])$.
Indeed, we can write $A = \{a_0,a_1,\dots, a_\ell\}$ with $0 =a_0 < a_1 <\dots < a_\ell = m_1$ such that $a_i - a_{i-1} \le n-m_1$ for all $i\in[1,\ell]$.
Then 
\[\pi_\PN(A*\aa) = A + [0,n-m_1] = \bigcup_{i=0}^\ell ([a_i,a_i+n-m_1]) = [0,n], \]
where the last inequality follows since $a_i \le a_{i-1} + n-m_1$ for each $i\in [1,\ell]$, by the assumption that $\maxgap(A) \le n-m_1$.

Also, suppose $A,B\in \A^{(m_1)}$ and $\aa,\bb\in \Z^Q([0,n-m_1])$.
Then, since $m_1 > m_2 \ge \cdots \ge m_k$, none of the factors in $\bb$ is equal to $A$ (and similarly, none of the factors in $\aa$ is equal to $B$).
Thus $A*\aa$ is equivalent to $B*\bb$ as a factorization in $\PN$ if and only if $A=B$ and $\aa$ and $\bb$ are equivalent factorizations, implying that $|\mathsf{Z}^P([0,n])| \ge |\A^{(m_1)} \cap \mathcal{G}_{n-m_1}| \cdot |\mathsf{Z}^Q([0,n-m_1])|$

From Proposition \ref{prop:exponential atoms} it follows that, for any $h\ge 2$, there is a constant $C_h$ such that $|\A^{(M)}\cap \mathcal{G}_h| \ge C_h \left(\sqrt{2-2^{-h/2}}\right)^M$.
Putting our observations together and using $M := m_1$, we find that
\[ |\mathsf{Z}^{P}([0,n])|
\ge |\A^{(m_1)}\cap \mathcal{G}_{n-m_1}| \cdot \underbrace{|\mathsf{Z}^Q([0,n-m_1])|}_{\ge 1 \textrm{for large $n$}} 
\ge C\left(\sqrt{2-2^{-(n-m_1)}}\right)^{m_1}. \tag{$*$}\]
Now we may guarantee the desired rate of growth by making more specific assumptions about the partitions $P$ and $Q$ involved above.

Assume $N$ is large enough that $2^{-\lfloor N/2 \rfloor} < \e$ and let $n\ge N$.
Choose a partition $P = (m_1,\dots, m_k)$ of $n$ such that $m_1 = \lceil n/2 \rceil$; then $Q = (m_2,\dots, m_k)$ is a partition of $\lfloor n/2 \rfloor$.
Note that $|\mathsf{Z}^Q([0,\lfloor n/2 \rfloor])|\ge1$ since $\mathsf{Z}^Q([0,\lfloor n/2\rfloor])\neq \emptyset$ by Theorem \ref{thm:good types}.
Thus, using ($*$) above for our specific choice of $P$, we obtain that
\[ |\mathsf{Z}([0,n])| 
\ge |\mathsf{Z}^P([0,n])| 
\overset{(*)}{\ge} C \left(\sqrt{2-2^{-\lfloor N/2 \rfloor}}\right)^{\lceil n/2 \rceil}
\ge C \left( \sqrt{2 -\e} \right)^{\lceil n/2 \rceil}
%\ge C \left(\sqrt[4]{2-\e}\right)^n 
\ge C\left(\sqrt[4]{2}-\e\right)^n
\]
%We conclude that, for large enough $n$ and for any $H \le \lfloor n/2 \rfloor$,
%\[|\mathsf{Z}([0,n])|\ge C_H\left(\sqrt{2-2^{-H}}\right)^{\lceil n/2 \rceil} \ge C_H \left(\sqrt[4]{2-2^{-H}}\right)^n,\]
which shows that $\mathsf{Z}([0,n])$ has at least the exponential growth rate we wished to demonstrate.
\end{proof}

In the above argument, there are many choices for partitions $P$ and $Q$ which could have yielded similar growth rates.
By the nature of partition types, different choices of $P$ or $Q$ in fact yield disjoint sets of factorizations.
This means we could increase our lower estimate of $|\mathsf{Z}([0,n])|$, possibly significantly.
Though we will not pursue this here, it is worth remarking that a more thorough probe into this topic and application of deeper analytic tools might yield a meaningfully higher rate of growth for $|\mathsf{Z}([0,n])|$.
