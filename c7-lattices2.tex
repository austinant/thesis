\chapter{Length Sets in High-Dimensional Integer Lattices} \label{ch:lattices}

From the point of view of geometry and other fields, setwise sums (also called \textit{Minkowski} sums) of integer lattice points are already well-studied.
A geometer might typically be concerned with the nature of Minkowski sum decompositions of polyhedra into convex polyhedra, or other questions with a similar geometric leaning (\cite{morelli93} and \cite{wang-gong07} are some -- but certainly not all -- of the writings on problems of this sort).
A arithmetic combinatorialist, on the other hand, might care about problems such as establishing size estimates on sumsets (comprehensive treatises on the subject include \cite{tao_vu_2006},\cite{grynkiewicz13}, or \cite{geroldinger-ruzsa09}).
While these are interesting questions on their own, they usually do not consider the algebraic aspects of setwise addition.  
For instance, when geometers consider decompositions into \textit{convex} polyhedra, one can effectively ignore the highly non-cancellative nature of Minkowsi sum.  
Working in this way has great practical implications for geometric problems, but leaves open many algebraic questions.
We wish to determine how the inherent geometry of the integer lattice interacts with algebraic and factorization theoretic questions.  

In particular, we will focus on sets of lengths in $\P_\fon(\NN^d)$.
Frisch et al. show in \cite{frisch13,frisch-al19} that rings of integer-valued polynomials realize all possible subsets of $\NN$ as sets of factorization lengths. 
Geroldinger and Schmid give a result of a similar flavor for numerical monoids in \cite{geroldinger-schmid18}.
Returning to the realm of sumsets and power monoids, Fan and Tringali show some first realization results for length sets in \cite{fan-tringali18}.
They further conjecture that $\PN$ realizes all possible subsets of $\NN$ as sets of factorization lengths.
That is:
\begin{conj} \label{conj:lengths}
For any finite $S \subseteq \NN_{\ge 2}$, there is $W\in\PN$ such that $\mathsf{L}_\PN(W)=S$.
\end{conj}
We aim to build toward to this conjecture by realizing new length sets in $\P_\fon(\NN^d)$ and by demonstrating some new methods for furthering research in this area.

\section{Passage Between Power Monoids}\label{sec:passage}
It is perhaps most natural to study $\P_\fin(G)$, for an abelian group $G$. 
In this section we will discuss why one can sensibly reduce to the study of $\PN$ and how we can incorporate $\P_\fon(\NN^d)$ to aid us in understanding $\PN$.
In broad terms, we will approach this reduction via the following steps:
\begin{enumerate}[label={\rm (\arabic{*})}]
	\item Reduce from $\P_\fin(G)$ to $\P_\fon(G)$; we have done this already in Proposition \ref{prop:funt&fun-have-the-same-system-of-lengths} and its minimal analogue, Proposition \ref{prop:comm-pm}.
	\item Understand subset arithmetic of direct summands of $G$; by the Fundamental Theorem of Finitely Generated Abelian Groups, this means understanding subset arithmetic in cyclic groups.
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item Study $\P_\fon(\ZZ/n\ZZ)$; a preliminary exploration into this topic can be found in Section \ref{sec:cyclic-case}.
		\item Study $\P_\fon(\ZZ)$; by Lemma \ref{lem:pass from N to Z} below, one can instead study $\PN$.  Much has been said about this case in Chapters \ref{ch:partitions} and \ref{ch:intervals} and in \cite[Section 4]{fan-tringali18}.
	\end{enumerate}
	\item Connect $\PN$ to $\P_\fon(\NN^d)$; this is the content of this section and, in particular, Theorem \ref{thm:passage-to-Nd}.
\end{enumerate}



\begin{lemma} \label{lem:pass from N to Z}
The embedding $\PN\hookrightarrow \P_\fon(\ZZ)$ induced by the embedding $\NN\hookrightarrow \ZZ$ is an essentially surjective equimorphism.
In particular, $\mathcal{L}(\P_\fon(\ZZ)) = \mathcal{L}(\PN)$.
\end{lemma}

\begin{proof}
The ``essentially surjective'' part is easily verified by noting that, for any $Y\in \P_\fon(\ZZ)$, $Y-\min(Y)\in \PN$.
Consequently, $Y = (Y-\min(Y))+\min(Y)$, so $Y$ is associate to an element of $\PN$.

Now we aim to verify the properties of an essentially surjective equimorphism laid forth in Section \ref{sec:monoids}.
that the only unit of $\P_\fon(\ZZ)$ is $\{0\}$, which does indeed pull back to $\{0\}\in \PN$, satisfying \ref{def:equimorphism(E1)}

To see \ref{def:equimorphism(E2)} -- that the embedding is atom-preserving -- suppose $A\in \PN$ is an atom and suppose that $A = X+Y$ for some $X,Y\in \P_\fon(\ZZ)$.
Then, letting $x = \min(X)$ and $y = \min(Y)$, there are $X',Y'\in \PN$ with $X = x+ X'$ and $Y=y+Y'$.
Since $x+y = \min(X)+\min(Y) = \min(A) = 0$, we have that $A = X+Y = (x+X')+(y+Y') = X' + Y'$ is a decomposition in $\PN$, so (with no loss of generality), $X' = \{0\}$.
Then $X = \{x\}$ is an invertible element of $\P_\fon(\ZZ)$ (so we actually have $x=0$), and $A$ is an atom of $\P_\fon(\ZZ)$.

Finally, we verify \ref{def:equimorphism(E3)}
Let $X\in \PN$ such that there is a nontrivial factorization $\bb=B_1*\cdots*B_k\in\Z_{\P_\fon(\ZZ)}(X)$.
Then, letting $b_i = \min(B_i)$ and $A_i = B_i - b_i$ for each $i\in[1,k]$, we have that $A_i \simeq_{\P_\fon(\ZZ)} B_i$ and so $A_i$ is an atom of $\P_\fon(\ZZ)$ for each $i\in[1,k]$.
Since $\PN$ is a divisor-closed submonoid of $\P_\fon(\ZZ)$, each $A_i$ is also an atom of $\PN$ (this is a straightforward exercise, or a consequence of \cite[Lemma 2.2]{fan-tringali18}).
Furthermore, since $\sum_{i=1}^k b_i = \min(A_i)=0$, we have that $X = A_1+\cdots+ A_k$, so $\aa:=A_1*\cdots*A_k\in \Z_{\PN}(X)$.
Since $A_i$ is associate to $B_i$, it is apparent that $\aa \simeq_{\P_\fon(\ZZ)} \bb$.
\end{proof}

The study of power monoids, in general, is vast and far transcends the already wild behavior of sumsets in $\NN$.
Indeed; the phenomena we discover in $\PN$ are, in some sense, a lower bound for how pathological we may expect factorization to be in power monoids.

\begin{prop}\label{prop:natural-to-non-tors}
Let $H$ be a non-torsion monoid.
Then there is an equimorphism from $\PN \hookrightarrow \P_\fun(H)$, the reduced power monoid of $H$.
In particular, $\mathcal{L}(\PN) \subseteq \mathcal{L}(\P_\fun(H))$.
\end{prop}
\begin{proof}
This is part of the content of \cite[Theorem 4.11]{fan-tringali18}. 
We do not prove all the details here, but one may start by considering the equimorphism induced by the embedding $\NN\hookrightarrow H$ which maps $1\mapsto x$ for some element $x\in H$ with infinite order.  
\end{proof}

%Thus the study of factorizations of $\PN$ actually tells us about the factorization of certain subsets of $H$.
Of course, there is much more to be studied in $\P_\fun(H)$ when we include subsets of $\gen{x,y}\subseteq H$, especially when $x$ and $y$ do not commute.
At a minimum, what we have observed above does tell us that every behavior encountered in $\PN$ actually occurs in many more power monoids.

It is not always possible to find a large-scale structural embedding of the factorization behavior of one monoid into another.  
However, it is possible for the study of factorizations of two monoids to be closely linked in a somewhat weaker sense.

\begin{defn} \label{def:local transfer}
	Let $H$ and $K$ be monoids. 
	We will say that $H$ is \textbf{locally transferrable} to $K$ if, for every non-unit $x\in H$, there is a homomorphism $f: H \to K$ such that 
	\begin{enumerate}[label={\rm ({\small LT}\arabic{*})}]
		\item $f$ is atom-preserving; for every $a\in \A(H)$, $f(a)\in \A(K)$. \label{LT1}
		\item $f^*:\Z_H(x) \to \Z_K(f(x))$ is a bijection (here $f^*$ is identified with the restriction to $\Z_H(x)$ of the induced map $f^*: \F^*(\A(H)) \to \F^*(\A(K))$). \label{LT2}
	\end{enumerate}
	We will refer to $f$ as an $x$-\textbf{transfer} to $K$.
	One may also note that, by \ref{LT1}, $f^*:\Z_H(x) \to \Z_K(f(x))$ preserves factorization lengths.
\end{defn}

The remaining results in this section highlight the motivating example for the definition of local transferrability; namely, the monoids $\P_\fon(\NN^d)$ for $d>1$.

\begin{lemma}\label{lem:local-transport}
	Let $\varphi: H \to K$ be a homomorphism of commutative monoids. 
	If $W\subseteq H$ is a subset with the property:
	\begin{itemize}
		\item[$(*)$] For all $x,y,z\in W$, $\varphi(x) = \varphi(y) + \varphi(z)$ if and only if $x = y + z$.
	\end{itemize}
	Then we have that
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item The restriction $\varphi|_W$ is injective.
		\item $\varphi:\P_\fon(H) \to \P_\fon(K)$ is an atom-preserving map.
		\item The induced map $\varphi^*:\Z_{\P_\fon(H)}(W) \to \Z_{\P_\fon(K)}(\varphi(W))$ is a (length-preserving) bijection.
		\item $\varphi$ is a $W$-transfer.
	\end{enumerate}
\end{lemma}

\begin{proof}
	Point (i) is clear by taking $z = 0$ in property $(*)$.
	To see (ii), suppose $A\subseteq W$ and $\varphi(A) = Y+Z$.
	Then, since $Y,Z\subseteq \varphi(A)$, we may write $Y = \varphi(B)$ and $Z = \varphi(C)$ for some $B,C\subseteq A$.
	For any $a\in A$, $\varphi(a) \in \varphi(B) + \varphi(C)$, so there are $b\in B$ and $c\in C$ with $\varphi(a) = \varphi(b) + \varphi(c)$.
	By $(*)$, $a = b + c \in B+C$, so $A \subseteq B + C$.
	A nearly identical argument yields the other inclusion, so that $A = B+C$.
	Thus, if $A$ is an atom, so too must be $\varphi(A)$. 
	
	For (iii), we wish to see that $\varphi^*$ is a bijection; we will show that $\varphi^*$ has an inverse.
	Let $\bb = B_1 * \cdots * B_k\in \Z_{\P_\fon(K)}(\varphi(W))$.
	Each $B_i = \varphi(A_i)$ for some $A_i\subseteq W$ and, by (i), $\varphi^{-1}(\varphi(A_i)) = A_i$.
	This implies that the map sending $\bb \mapsto \varphi^{-1}(B_1) * \cdots * \varphi^{-1}(B_k)$ is inverse to $\varphi^*$, which is all we needed to show.
	
	%The results (i)-(iii), in combination with Lemma \ref{lem:local-transport}.
	Item (iv) is immediate from (i)-(iii).
\end{proof}

\begin{rk}
	Note that the property $(*)$ in Lemma \ref{lem:local-transport} is \textit{not} equivalent to the restriction $\varphi|_W$ being injective, because we have not made any assumption of algebraic structure on $W$; in particular, $W$ is not necessarily closed under addition. 
\end{rk}

\begin{prop}\label{prop:flattening}
	Let $r \ge 1$ and $W\in \P_\fon(\NN^{r+1})$.
	Let $N > 2 \max\{\pi_r(w): w\in W\}$, where $\pi_r: \NN^{r+1} \to \NN$ is the projection map from the $r$th coordinate.
	Define $\varphi: \NN^{r+1} \to \NN^r$ by $\varphi(w_1,\dots, w_{r+1}) = (w_1,\dots, w_{r-1},w_r + N w_{r+1})$.
	Then
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item $\varphi$ is a homomorphism.
		\item For all $x,y,z\in W$, $\varphi(x) = \varphi(y) + \varphi(z)$ if and only if $x = y + z$.
		\item $\varphi^*:\Z_{\P_\fon(\NN^{r+1})}(W) \to \Z_{\P_\fon(\NN^r)}(\varphi(W))$ is a bijection.
	\end{enumerate}
\end{prop}
\begin{proof}
	It is easy to see (i), for this follows from the distributivity of multiplication in $\ZZ$.
	
	Point (ii) will follow from our choice of $N$ (Recall that $N > 2m$, where $m = \max\{\pi_r(w): w\in W\}$).
	Let $x,y,z\in W$, writing $x = (x_1,\dots, x_{r+1})$, $y=(y_1,\dots,y_{r+1})$, and $z=(z_1,\dots,z_{r+1})$.
	Suppose that $\varphi(x) = \varphi(y) + \varphi(z)$; we will make a coordinate-wise comparison of both sides.
	We immediately have $x_i = y_i + z_i$ for all $i < r$.
	For the $r$th component, we have $x_r + Nx_{r+1} = y_r + Ny_{r+1} + z_r + Nz_{r+1}$, so
	$x_r -y_r - z_r = N(y_{r+1}+z_{r+1}-x_{r+1})$.
	Since 
	\[|x_r - y_r - z_r| \le | |x_r - y_r| - |z_r| | \le |x_r-y_r| + |z_r| \le 2m < N,\]
	it must be that both sides of this last equation are equal to zero, so that $x_r = y_r + z_r$ and $x_{r+1} = y_{r+1}+z_{r+1}$.
	Now we have $x = y+z$, as we wished.
	
	Finally, (iii) follows from (i) and (ii) by Lemma \ref{lem:local-transport}.
\end{proof}

\begin{thm}\label{thm:passage-to-Nd}
	Let $d > 1$. 
	Then $\P_\fon(\NN^d)$ is locally transferrable to $\PN$.
\end{thm}
\begin{proof}
	We can prove this by inducting on $d$.
	Begin with the case $d=2$ and let $X\in \P_\fon(\NN^2)$ with $X \neq \{0\}$.
	Proposition \ref{prop:flattening} gives us an $X$-transfer to $\varphi:\P_\fon(\NN^2) \to \PN$, so we are done.
	
	Now suppose $d>2$ and assume by way of induction that $\P_\fon(\NN^{d-1})$ is locally transferrable to $\PN$.
	Let $X\in \P_\fon(\NN^{d})$.
	As above, Proposition \ref{prop:flattening} yields an $X$-transfer $\varphi$ to $\P_\fon(\NN^{d-1})$.
	Since we have assumed $\P_\fon(\NN^{d-1})$ to be locally transferrable to $\PN$, there is a $\varphi(X)$-transfer $\psi: \P_\fon(\NN^{d-1}) \to \PN$.
	Then $\psi\circ\varphi: \P_\fon(\NN^d) \to \PN$ is an $X$-transfer, so we conclude that $\P_\fon(\NN^d)$ is locally transferrable to $\PN$.
\end{proof}


\section{Independence Arguments in Integer Lattices} \label{sec:independence}

Theorem \ref{thm:passage-to-Nd} states that the factorization theory of $\P_\fon(\NN^d)$ is locally included in that of $\PN$.
Thus, to study $\P_\fon(\NN^d)$, we need only look inside $\PN$. 
Another perspective is the following: to study factorizations in $\PN$, we now have access to the space and geometric intuition afforded to us by working inside the $d$-dimensional lattice $\NN^d$.
To make effective use of this intuition, we will formulate and exploit some techniques suitable to this setting.

Throughout this section, all subsets of $\NN^d$ that we instantiate will be assumed to be finite and to contain $0$ (that is, they will be assumed to be elements of $\P_\fon(\NN^d)$).
Furthermore, we will drop the subscripts from the sets of factorizations (resp., lengths) of elements of $\P_\fon(\NN^d)$, as in $\Z(X)$ (resp., $\mathsf{L}(X)$).

\begin{defn}
	First we set the notation that, for any subset $X \subseteq \ZZ^d$, $\ZZ X := \gen{X}_{\ZZ^d}$ is the subgroup of $\ZZ^d$ generated by $X$.
	We say that subsets $U$ and $V$ of $\NN^d$ are \textbf{$\ZZ$-independent (or $V$ is $\ZZ$-independent from $U$)} if $\ZZ U \cap \ZZ V = \{0\}$.
	
	We will say that subsets $U_1,\dots, U_n\subseteq \NN^d$ are \textbf{(totally) $\ZZ$-independent} if, for every pair of disjoint subsets $I,J\subseteq[ 1,n ]$, $\sum_{i\in I} U_i$ and $\sum_{j\in J} U_j$ are $\ZZ$-independent.
\end{defn}

We begin by outlining some basic properties of $\ZZ$-independence.  
More often than not, we will use these without mention, or by simply citing ``$\ZZ$-independence."
\begin{prop} \label{prop:eltwise-indep}
	Let $u_1,\dots, u_k\in \NN^d$ be nonzero elements.
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item $\{u_1,\dots,u_k\}$ is a $\ZZ$-linearly independent set if and only if $\{0,u_1\},\dots,\{0,u_k\}$ are totally $\ZZ$-independent.
		
		\item If $\sum_i u_i = 0$ then $u_i = 0$ for all $i=1,\dots, k$.
		
		\item If $U_1,\dots, U_k$ are totally $\ZZ$-independent and $u_i, v_i\in U_i$ for each $i\in [ 1,k ]$,
		then $\sum_i u_i = \sum_i v_i$ implies that $u_i = v_i$ for $i = 1,\dots, k$.
	\end{enumerate}
\end{prop}

\begin{proof}
	(i) is a straightforward exercise in the definition of total $\ZZ$-independence and (ii) is simply a consequence of $\NN^d$ being a reduced monoid.
	
	For (iii), we can induct on $k$.
	The result is trivial if $k = 1$, so let $k=2$.
	$u_1 + v_1 = u_2 + v_2$ implies that $u_1 - v_1 = v_2 - u_2 \in \ZZ U_1 \cap \ZZ U_2 = \{0\}$, so $u_1 = v_1$ and $u_2 = v_2$.
	
	For the inductive step, suppose $k>2$ and that the result holds for integers smaller than $k$.
	The equation $\sum_i u_i = \sum_i v_i$ implies that $u_1 - v_1 = \sum_{i\ge 2} (v_i - u_i)$, and we have that 
	\[u_1 - v_1 \in \ZZ U_1 \cap \ZZ(U_2+\cdots+U_k) = \{0\},\]
	yielding that $u_1 = v_1$ and $\sum_{i\ge 2} u_i = \sum_{i\ge 2} v_i$.
	By induction, the last equation implies that $u_i = v_i$ for all $i$ and we are done.
\end{proof}

\begin{prop} \label{prop:indep-decomp}
	Let $U,V \subseteq \NN^d$ be $\ZZ$-independent and let $A_1,\dots, A_k$ be nonzero subsets with $U+V = \sum_{i=1}^k A_i$.
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item $U = \sum_{i=1}^k U\cap A_i$ and $V = \sum_{i=1}^k V\cap A_i$.
		\item If $U \cap A_i = \{0\}$ then, for any $V'\subseteq V$, $(U+V')\cap A_i = V'\cap A_i$.
		\item For each $i$, $U\cap A_i \neq \{0\}$ or $V \cap A_i \neq \{0\}$.
		\item $k \le \max \mathsf{L}(U) + \max \mathsf{L}(V)$.
	\end{enumerate}
\end{prop}

\begin{proof}
	(i) For each $i$, let $u_i\in U\cap A_i$.
	Then $\sum_i u_i \in \sum_i A_i = U+V$, and there are $u\in U$ and $v\in V$ with $\sum_i u_i = u+v$.
	By Proposition \ref{prop:eltwise-indep}(ii), $v = 0$ and $\sum_i u_i = u \in U$
	
	The other inclusion is similar; for any $u\in U \subseteq \sum_i A_i$, we can find $u_1,\dots,u_k\in U$ and $v_1,\dots, v_k\in V$ such that $u_i+v_i\in A_i$ for each $i$ and $u = \sum_i (u_i + v_i)$.
	Again by Proposition \ref{prop:eltwise-indep}(ii), $\sum_i v_i = 0$, and each $v_i = 0$ by Proposition \ref{prop:eltwise-indep}(i).
	
	Moving on to (ii), it is sufficient to prove the result for $i=1$ by renumbering the $A_i$ if necessary.
	Suppose $u\in U$, $v\in V'$, and $u+v\in A_1$.
	Since $U\cap A_1 = \{0\}$, we know from (i) that
	\[ U = \sum_{i\ge 1} U\cap A_i = \sum_{i\ge 2} U\cap A_i, \]
	so $u+v + U \subseteq A_1 + \sum_{i\ge 2} A_i \subseteq U+V$.
	Thus, for any $w\in U$, there are $u'\in U$ and $v'\in V$ so that $u+v+w = u'+v'$.
	By the $\ZZ$-independence of $U$ and $V$, $v' = v$ and so, since $w\in U$ was arbitrary, we actually have that $u+v+U \subseteq U + v$.
	We can cancel $v$ to get $u+U \subseteq U$.
	Since $|u+U| = |U| <\infty$, we must actually have $u+U = U$; however, this implies that $u = 0$.
	We now have that $v = u+v \in A_1$, so $(U+V')\cap A_1 \subseteq V' \cap A_1$.
	The reverse inclusion is trivial since $0\in U$, so we are done.
	
	(iii) follows quickly from (ii); suppose $U\cap A_i = \{0\} = V\cap A_i$.
	Then $A_i = (U+V)\cap A_i = V\cap A_i = \{0\}$, where we used (ii) at the second equal sign.
	This contradicts the assumption that the $A_i$ are nonzero subsets.
	
	Finally, for (iv): let $\ell = \max \mathsf{L}(U)$ and $m = \max\mathsf{L}(V)$.
	Without loss of generality, say $[ 1,s ] = \{i: U\cap A_i \neq \{0\} \}$ and $[ t,k ] = \{i: V\cap A_i \neq \{0\} \}$.
	Since, by (i), $U = \sum_i U\cap A_i = \sum_{i\le s} U \cap A_i$, $| [ 1,s ] | \le \ell$ (similarly, $|[ t,k ]| \le m$).
	By (iii), $[ 1,k ] = [ 1,s ] \cup [ t,k ]$, so $k \le \ell + m$ as we wished.
\end{proof}

\begin{lemma} \label{lem:indep-atom-decomp}
	Let $U, V_1,\dots, V_m\subseteq \NN^d$ be totally $\ZZ$-independent.
	Suppose each $V_j$ is an atom, and let $V := \sum_j V_j$.
	Further suppose that $A_1,\dots, A_k$ are nonzero subsets with $U+V = \sum_{i=1}^k A_i$.
	\begin{enumerate}[label={\rm (\roman{*})}]
		\item There is a function $f: [ 1,m ] \to [ 1,k ]$ with $V_j \subset A_{f(j)}$ for each $j\in [ 1,m]$.
		\item For each $h\in [ 1,k]$, $\left( \sum\limits_{j\notin f^{-1}(h)} V_j \right) \cap A_h = \{0\}$.
		\item For each $h\in [ 1,k]$, $V\cap A_h = \sum\limits_{j\in f^{-1}(h)} V_j$.
	\end{enumerate}
\end{lemma}

\begin{proof}
	For (i), fix $j\in [ 1,m ]$.
	Then, by Proposition \ref{prop:indep-decomp}(i), $V_j = \sum_i V_j \cap A_i$.
	Since $V_j$ is an atom, only one summand on the right side of this equation can be zero; let $f(j)$ denote the index of that summand.
	Then we have $V_j = V_j \cap A_{f(j)} \subseteq A_{f(j)}$.
	
	Now let $J := f^{-1}(h) = \{j: V_j \subseteq A_h\}$ and call $V' = \sum_{j\in J} V_j$.
	Similarly, let $K = [ 1,m ] \setminus J$ and call $V'' = \sum_{j\in K} V_j$.
	Because $V_1,\dots, V_m$ are totally $\ZZ$-independent, $V'$ and $V''$ are $\ZZ$-independent.

	We can prove (ii) as follows: for each $j\in K$, $V_j\cap A_h = \{0\}$.
	Proposition \ref{prop:indep-decomp}(ii) and an easy induction on $|K|$ then yields that $V'' \cap A_h = \{0\}$, completing the proof.
	
	For (iii): a similar induction on $|J|$ shows that, for each $i\neq h$, $V' \cap A_i = \{0\}$.
	As a result, Proposition \ref{prop:indep-decomp}(i) implies that $V' = \sum_i V'\cap A_i = V'\cap A_h$.
	To conclude, we use Proposition \ref{prop:indep-decomp}(ii) to get that 
	$V\cap A_h = (V'+V'')\cap A_h = V'\cap A_h = V'$.
\end{proof}

\begin{thm} \label{thm:ind-atoms}
	If $V_1,\dots,V_m\subseteq \NN^d$ are totally $\ZZ$-independent atoms then $V_1+\cdots+V_m$ factors uniquely (up to reordering of factors).
	That is, $\mathsf{Z}(V_1+\cdots+V_m) = \{ V_1*\cdots*V_m\}$.
\end{thm}

\begin{proof}
	Let $V = V_1+\cdots + V_m$.
	The result will essentially follow from Lemma \ref{lem:indep-atom-decomp}, taking $U = \{0\}$.
	
	Let $A_1,\dots, A_k$ be atoms with $V = \sum_i A_i$.
	As in Lemma \ref{lem:indep-atom-decomp}(i), there is $f:[ 1,m ] \to [ 1,k]$ with $V_j \subseteq A_{f(j)}$ for each $j\in [ 1,m]$.
	We wish to show that $f$ is a bijection. 
	
	To see that $f$ is surjective, suppose $h\in [1,k]\setminus f([1,m])$.
	Then $V_j \cap A_h = \{0\}$ for all $j\in [1,m]$, so Lemma \ref{lem:indep-atom-decomp}(ii) implies that $A_h = V\cap A_h  = \{0\}$.
	This is a contradiction since $A_h$ is an atom and hence nonzero.
	
	To witness the injectivity of $f$, let $h\in [1,m]$; Lemma \ref{lem:indep-atom-decomp}(iii) says that $A_h = V\cap A_h = \sum_{j\in f^{-1}(h)} V_j$.
	However, since $A_h$ is an atom it must be the case that $|f^{-1}(h)| =1$.
	
	Now $f$ is a bijection with $V_j = A_{f(j)}$ for each $j\in [1,m]$.
	This proves that $A_1*\cdots*A_k \simeq V_1*\cdots*V_m$, as we wished.
\end{proof}

\begin{eg} \label{eg:recover-flat-unique-fac}
	Theorem \ref{thm:ind-atoms} allows us to partially recover \cite[Proposition 4.9]{fan-tringali18}.
	We recall here the content of Fan and Tringali's result: Let $a_1,\dots, a_\ell \in \NN$ such that $a_1 + \cdots + a_i < \frac{1}{2} a_{i+1}$ for $i\in [ 1,\ell-2 ]$ and (if $\ell \ge 2$) $a_1+\cdots + a_{\ell-1} < a_\ell - a_{\ell-1}$.
	Then $\mathsf{Z}_{\PN}(\{0,a_1\}+\cdots+\{0,a_\ell\}) = \{ \{0,a_1\}*\cdots*\{0,a_\ell\}\}$.
	
	There are many sequences of integers $a_1,\dots,a_\ell$ satisfying the specified properties; for simplicity, let us use the sequence given by $a_i = b^{i-1}$, for some integer $b \ge 3$.
	
	For $i\in [ 1,\ell ]$, let $e_i \in \NN^\ell$ be the $i$th standard basis vector (whose entries are all zero, except for a $1$ in the $i$th coordinate).
	Let $V = \{0,e_1\} + \cdots + \{0,e_\ell\}$; by Theorem \ref{thm:ind-atoms}, $V$ factors uniquely.
	We will follow the procedure given in Theorem \ref{thm:passage-to-Nd} to ``flatten" $V$ into a subset of $\NN$ which still factors uniquely.
	According to this procedure, we need maps $\NN^\ell \to \NN^{\ell-1} \to \dots \to \NN$.
	
	For $i\in [ 1,\ell-1 ]$, define $\varphi_i: \NN^{i+1} \to \NN^{i}$ by $v \mapsto \hat{v} + be_{i}$ (where $\hat{v}$ is the vector consisting of the first $i$ components of $v$, and we have identified $e_i$ with the $i$th standard basis vector in $\NN^i$).
	Let $V_\ell = V$ and $V_i = \varphi_i(V_i+1)$ for $i <\ell$.
	By Proposition \ref{prop:flattening}, $\varphi_i$ is a homomorphism which essentially preserves the set of factorizations of $V_{i+1}$.
	Letting $\varphi := \varphi_1\circ \cdots \circ \varphi_{\ell-1}$, we have that $U := \varphi(V)$ factors uniquely.
	
	To see what elements actually comprise $U$, it is enough to check the value of $\varphi$ on $e_1,\dots, e_\ell$ (since $\varphi$ is a homomorpism).
	It is not too difficult to see that $\varphi(e_i) = b^{i-1}$, so that $U = \{0,1\}+\{0,b\}+\cdots+\{0,b^{\ell-1}\}$ which is indeed already known to factor uniquely by Fan and Tringali's result.
\end{eg}




\section{Recovering the Two-Lengths Realization Result} \label{sec:recovering length sets}
%In what follows, we will need to determine the possible factors of specific sets in $\P_\fon(\NN^d)$.
%Suppose $W,A \in \P_\fon(\NN^d)$ and we know that $A$ divides $W$; that is, there is $B$ such that $W = A+B$.
%Due to the non-cancellative nature of power monoids, there may be many such $B$.
%
%\begin{defn} \label{def:cofactor}
%	Let $W,A\in \P_{\fin,0}(H)$.
%	We define the \textbf{saturated cofactor of $A$ in $W$} by
%	\[ W\:A := \bigcap_{a\in A} (W-a) \]
%\end{defn}
%
%$W\:A$ is the largest possible set $B$ such that $W = A + B$, in the sense of the following proposition.
%
%\begin{prop} \label{prop:cofactors}
%	Let $W,A \in \P_\fon(\NN^d)$. 
%	\begin{enumerate}[label={\rm (\roman{*})}]
%		\item $A + W\:A \subseteq W$.
%		\item If $W = A + B$ then $B \subseteq W\:A$.
%		\item $A$ divides $W$ if and only if $A + W\:A = W$.
%	\end{enumerate}
%\end{prop}
%
%\begin{proof}
%	Point (i) is straightforward to see; suppose $a\in A$ and $w\in W\:A$.
%	Then, by construction, $w\in W-a$ so that $w+a \in (W-a) +a = W$.
%	
%	For (ii), suppose $b\in B$ and $a\in A$.
%	Then $a+b \in A + B = X$, so $b \in W-a$; this was true for any $a\in A$, so $b\in \bigcap_{a\in A} (W-a) = W\:A$.
%	
%	To see (iii), first suppose that $A$ divides $W$; then there is some $B$ so that $A + B = W$.
%	Then, using (ii) and then (i), we have that $W = A+B \subseteq A+ (W\:A) \subseteq W$, whence all the inclusions are equalities.
%\end{proof}

Now we are in a position to obtain a high-dimensional version of \cite[Proposition 4.10]{fan-tringali18} which says that, for any $n\ge 2$, there is an element $U\in \PN$ which has exactly two factorizations: one of length $2$, and one of length $n+1$.
Applying our viewpoint to Fan and Tringali's result gives us some new insights on their construction and how it may be pushed further.
For now, we begin by fixing some notation for our examination of Fan and Tringali's construction.

\begin{defn} \label{def:two-fac-construction} 
	Fix an integer $n\ge 2$ and let $d\ge n$.
	Let $\{e_1,\dots,e_n\}$ be a $\ZZ$-linearly independent subset of $\ZZ^d$.
	
	For any $I \subseteq [ 1,n ]$, we will let $e_I := \sum_{i\in I} e_i$.
	Further, let $f := e_{[ 1,n ]} = \sum_{i=1}^n e_i$ and let $g := f + e_n$.
	Finally, we set
	\[U_{n+1} := \sum_{i=1}^n \{0,e_i\} + \{0,g\}.\]
\end{defn}

We will show (in Theorem \ref{thm:2n-length-set}) that $U_{n+1}$ has exactly two factorizations. 
One of these factorizations is apparent from the construction given, since any two element set is an atom of $P_\fon(\NN^d)$ (this is an easy exercise, or one can look to \cite[Proposition 4.1(iv)]{fan-tringali18}).
Before proving the Theorem, we construct a class of atoms which will continue to appear through the remainder of the section.

\begin{lemma} \label{lem:large-atom-two-fac}
	Let $U_{n+1}$ be as in Definition \ref{def:two-fac-construction}, and let $V\subseteq \NN^d$ be $\ZZ$-independent from $U_{n+1}$.
	Then the set
	\[ B:= \left( \sum_{i=1}^{n-1} \{0,e_i\} + \{0,g\} + V \right) \cup \{f\} \]
	is an atom.
\end{lemma}

\begin{proof}
	Suppose that $B = X + Y$.
	It will suffice to prove that one of $X$ or $Y$ is equal to $\{0\}$.

	We first claim that $f\in X\cup Y$; in particular, that $f$ cannot be written as the sum of two nonzero elements of $B$.
	Suppose, for a contradiction, that one can write $f = (\delta g + e_I + v) + (\delta' g + e_J + v')$ for some $I,J\subseteq [1,n-1]$, $\delta,\delta'\in\{0,1\}$, and $v,v'\in V$.
	By Proposition \ref{prop:eltwise-indep}(iii) and the assumption that $V$ is $\ZZ$-independent from $U_{n+1}$, $v=v' = 0$.
	Since the $e_n$-coefficient of $f$ is $1$, $\delta = \delta' = 0$.
	Now $f = e_I + e_J$; however, since $n\notin I\cup J$, the $e_n$-coefficient must be $0$, a contradiction.
	
	We also similarly claim that $g \in X\cup Y$.  
	Suppose, for $I,J,\delta,\delta',v,v'$ as above, that $g = (\delta f + e_I + v) + (\delta' f + e_J + v')$.
	As before, $v=v'=0$.
	Now, since the $e_n$-coefficient of $g$ is $2$ but $n\notin I\cup J$, $\delta = \delta' = 1$, implying that $g = 2f + e_I + e_J$.
	This gives a contradiction, as $2f + e_I + e_J$ has an $e_1$-coefficient of at least $2$, but $g$ has an $e_1$-coefficient of $1$.
	
	We now have that $f,g\in X \cup Y$.
	Noting that $f+g \notin B$, we may say (without loss of generality) that $f,g\in X$.
	Now we aim to show that $Y = \{0\}$.
	Suppose $b := \varepsilon g + e_I +v \in Y$ for some $\varepsilon \in \{0,1\}$, $I\subseteq [ 1,n-1]$, and $v\in V$.
	Then we must have $f + b \in X+Y = B \subseteq U_{n+1} + V$, so choose some $u'\in U_{n+1}$ and $v'\in V$ with $f + b = u' + v'$.
	By the $\ZZ$-independence of $U_{n+1}$ and $V$, it must be that $v' = v$ and $f + \varepsilon g + e_I = u' \in U_{n+1} \cap B$.
	
	We can finish the proof by noting that the only element of $U_{n+1}\cap B$ with an odd $e_n$ coefficient is $f$, meaning that $\varepsilon=0$ and $I = \emptyset$.
	Then $f+b = f+v \in B$, at which point we see that $v = 0$.
	Thus $Y = \{0\}$ as we wished.
\end{proof}

\begin{thm} \label{thm:2n-length-set}
	Let $n\ge 2$ and let $e_1,\dots, e_n\in \NN^n$ be $\ZZ$-linearly independent.
	Set $f = \sum_{i=1}^n e_i$, $g=f+e_n$.
	Letting $U = \sum_{i=1}^n \{0,e_i\} + \{0,g\}$, we have 
	\[\mathsf{Z}_{\P_\fon(\NN^n)}(U) = \left\{ \{0,e_1\}*\cdots*\{0,e_n\}*\{0,g\}, \left[\sum_{i=1}^{n-1}\{0,e_i\}+\{0,g\}\right]\cup\{f\} * \{0,e_n\} \right\}. \]
\end{thm}

\begin{proof}
	Suppose $U = X + Y$ for some $X,Y\subseteq U$ with $X,Y\neq \{0\}$.
	First we set some notation by analogy with the proof of \cite[Theorem 4.10]{fan-tringali18}: $I_X := \{i\in [ 1,n ]: e_i\in X\}$, $I_Y := \{i\in [1,n ]: e_i\in Y \}$.
	For further convenience and compactness, we let $e_I := \sum_{i\in I}e_i$ for any $I\subseteq [ 1,n ]$.
	
	Begin by noting that $[ 1,n ] = I_X \sqcup I_Y$; indeed, for each $i\in[ 1,n ]$, $e_i\in X+Y$, and it must be that $e_i\in X\cup Y$ since all the $e_i$ are linearly independent.  
	Moreover, we cannot have $e_i\in X\cap Y$ since $2e_i \notin U$.
	
	To prove some of the claims which follow, we will use a basic understanding of which linear combinations of the $e_i$ appear as elements of $U$.
	Every element of $U$ has one of the following forms:
	\begin{enumerate}[label={\rm ({\small F\arabic{*}})}]
		\item $e_I$: the coefficient to each $e_i$ is either $0$ or $1$. \label{form 1}
		\item $g+e_I$: the $e_n$ coefficient is either $2$ or $3$, and all other $e_i$-coefficients are either $1$ or $2$. \label{form 2}
	\end{enumerate}
	
	We now wish to determine the structure of $X$ and $Y$.
	For the ease of understanding the argument, we state and prove several small claims about $X$ (which will also hold for $Y$ by symmetry).
	
	%%%%%%
	% CLAIM A
	\begin{claim} \label{cl:index implies sum}
	If $I\subseteq I_X$ then $e_I\in X$. 
	\end{claim}
	
	Suppose $I = J\sqcup K$ with $e_J\in X$ and $e_K\in Y$.
	If $K\neq \emptyset$ then let $k\in K\subseteq I_X$; we have $2e_k + e_{K\setminus\{k\}} = e_k + e_K\in X+Y$, which is impossible unless $K = [ 1,n]$, so that $e_K = f$.
	However, since $1\in K\subseteq I\subseteq I_X$, this implies that $2e_1 + e_{K\setminus\{k\}} = e_1 + e_K\in X+Y$, a contradiction to \ref{form 1}
	
	%%%%%%
	% CLAIM B
	\begin{claim} \label{cl:sum implies index}
	For $I\subsetneqq [ 1,n ]$, $e_I\in X$ only if $I\subseteq I_X$.
	\end{claim}
	
	Suppose $K := I \cap I_Y$ is nonempty (otherwise, we are done).
	Then $e_{I\setminus K} + 2e_K = e_I + e_K \in X +Y$ has at least one coefficient equal to $0$ and at least one coefficient $\ge 2$, which is a contradiction to \ref{form 1}
	
	%%%%%%
	% CLAIM C
	\begin{claim} \label{cl:offset sum implies sum}
	If $g + e_I\in X$ then $e_I\in X$. 
	\end{claim}
	
	Let $K := I\cap I_Y$; then $g + e_{I\setminus K} + 2e_K = (g+e_I) + e_K \in X+Y$, which is not possible unless $K=\emptyset$ (since no element of $U$ has more than one coefficient $>2$ by \ref{form 2}).
	This implies the desired conclusion.
	
	%%%%%%
	% CLAIM D
	\begin{claim} \label{cl:only one offset factor}
	Exactly one of $X$ or $Y$ has an element of the form $g + e_I$. 
	\end{claim}
	
	This is easy to see; if neither $X$ nor $Y$ has such an element then no element of $X+Y$ has a coefficient larger than two.
	On the other hand, if $g+e_J\in X$ and $g+e_K\in Y$ then $2g + e_J + e_K \in X+Y$, which is a contradiction to \ref{form 2} since this element has an $e_n$-coefficient $\ge 4$.
	
	%%%%%%
	% CLAIM E
	\begin{claim} \label{cl:one offset sum implies all}
	If $g+ e_H\in X$ for some $H\subseteq [ 1,n ]$ then $g + e_I \in X$ for every $I\subseteq I_X$ with $I\subsetneqq [ 1,n]$. 
	\end{claim}
	
	Let $I \subseteq I_X$ with $I\subsetneqq [1,n]$.
	Since $g+e_I\in U = X+Y$, we may write $g+e_I = x +y$ with $x = \delta g + e_J\in X$ (for $\delta\in \{0,1\}$) and $y=e_K\in Y$ by Claim \ref{cl:only one offset factor}.
	Now $g + e_I = \delta g + e_J + e_K$.
	
	\underline{Case 1}: If $\delta = 1$ then $e_I = e_J + e_K$, hence $I = J\sqcup K$. 
	Since $I\neq [1,n]$, $K\subsetneqq [ 1,n ]$ and so $K\subseteq I_Y$ by Claim \ref{cl:sum implies index}.
	However, we now have that $K = \emptyset$ since $K\subseteq I \subseteq I_X$.
	Thus $g + e_I = g + e_J \in X$, as we wished.
	
	\underline{Case 2}: 
	If $\delta=0$ then $g + e_I = e_J + e_K$.
	We must have $n\in J\cap K$ but, since $I_X\cap I_Y = \emptyset$, Claim \ref{cl:sum implies index} implies that $J+K=[1,n]$ and so $e_J = e_K = f$.
	Moreover, $I = [1,n-1]$.
	Now however, since $[ 1,n-1 ] \subseteq I_X$, we have $e_1 + f \in X+Y$, which is a contradiction (no element of $U$ has an $e_n$-coefficient of $1$ and an $e_1$-coefficient of $2$), finishing the proof of the claim.

	Assume without loss of generality that $g\in X$.
	If $I_X = \emptyset$ then $I_Y = [1,n]$ so $X = \{0,g\}$ by Claims \ref{cl:sum implies index} and \ref{cl:offset sum implies sum}, and $Y = \sum_{i=1}^n \{0,e_i\}$ by Claim \ref{cl:index implies sum}.
	By Theorem \ref{thm:ind-atoms}, $Y$ factors uniquely and we have $\{0,e_1\}*\cdots \{0,e_n\}*\{0,g\}\in \Z_{\P_\fon(\NN^n)}(U)$.
	
	Now suppose $I_X \neq \emptyset$.
	Then, by Claims \ref{cl:offset sum implies sum} and \ref{cl:one offset sum implies all}, 
	\[X \supseteq \{0,g\} + \sum_{i\in I_X} \{0,e_i\}. \tag{1} \label{factor-includes} \]
	We can completely determine the structure of $Y$.
	First observe that we cannot have $f=e_{[1,n]}\in Y$ since we would then have $(g+e_{I_X})+f \in X+Y$, but this is not an element of $U$.
	This allows us to use Claims \ref{cl:sum implies index}, \ref{cl:index implies sum}, and \ref{cl:only one offset factor} to say that $Y = \sum_{i\in I_Y} \{0,e_i\}$ (with $I_Y\neq\emptyset$, otherwise $Y=\{0\}$).
	Since the $e_i$ are linearly independent, the $\{0,e_i\}$ are $\ZZ$-independent, so $Y$ factors uniquely as the sum of the $\{0,e_i\}$ for $i\in I_Y$ by Theorem \ref{thm:ind-atoms}.
	
	With this, we can say more about the structure of $X$.
	By Proposition \ref{prop:cofactors}, we have 
	\[X \subseteq U\:Y = \bigcap_{y\in Y}(U-y) = \bigcap_{K\subseteq I_Y} \underbrace{\{e_I - e_K, g+e_I - e_K : I\subseteq [ 1,n ] \}}_{=:U_K} \tag{2} \label{Y cofactor}\]
	
	Recalling the forms \ref{form 1} and \ref{form 2} of all elements of $U$ that we outlined earlier, we can similarly express the forms of elements of $U\:Y$:
	\begin{enumerate}[label={\rm ({\small F\arabic{*}}$'$)}]
		\item $e_I$ for $I\subseteq I_X$. \label{form 1'}
		To see this, observe that $e_I = e_{I\cup K}-e_K\in U_K$ for any $K\subseteq I_Y$.
		On the other hand note that, for $H \subseteq [ 1,n ]$ with $H\cap I_Y\neq \emptyset$, $g+e_H\notin U_{H\cap I_Y}$, so these are the only elements of form \ref{form 1} which remain in $U\:Y$.

		\item $g+e_I$ for $I\subseteq I_X$. \label{form 2'}
		For this, we observe $g+e_{I\cup K} - e_K\in U_K$. 
		Similar to the argument just above, we see that $g+e_H\notin U_{H\cap I_Y}$ whenever $H\cap I_Y\neq\emptyset$.
		\item $f\in U\:Y$ only if $I_Y = \{n\}$. \label{form 3'}
		First, it is clear that $f = e_{[ 1,n ]} \in U_\emptyset$.
		For any $K\subseteq I_Y$ with $n\in K$, $f = g+ e_{K\setminus\{n\}} - e_K\in U_K$.
		However, if $n\notin K$ but $K$ is non-empty, then $f\notin U_K = \{e_I, g+e_I-e_K: I\subseteq [1,n]\}$.
		This is because $e_I - e_K \neq f$ (since $K$ is non-empty), and $g+e_I-e_K$ has an $e_n$ coefficient larger than $1$ (since $n\notin K$).
	\end{enumerate}
	We now have, combining (\ref{factor-includes}) and (\ref{Y cofactor}) with our work here, that
	\[ \{0,g\} + \sum_{i\in I_X}\{0,e_i\} \subseteq X \subseteq \left[\{0,g\}+\sum_{i\in I_X} \{0,e_i\} \right]\cup\{f\},\]
	so we have determined $X$ almost exactly, up to the choice of whether $f\in X$.
	
	First suppose $f\notin X$.
	Then $X = \{0,g\} +\sum_{i\in I_X} \{0,e_i\}$ and, since $I_Y\neq\emptyset$, $I_X\subsetneqq [1,n]$.
	Consequently, $\{e_i: i\in I_X\}\cup\{g\}$ is a $\ZZ$-linearly independent subset of $\ZZ^n$, so the summands of $X$ are $\ZZ$-independent by Proposition \ref{prop:eltwise-indep}(i).
	In turn, we have that $X$ factors uniquely (by Theorem \ref{thm:ind-atoms}) as the sum of $\{0,g\}$ and the $\{0,e_i\}$ for $i\in I_X$.
	This can only produce -- up to reordering, of course -- the factorization $\{0,g\}*\{0,e_1\}*\cdots*\{0,e_n\}\in \Z_{\P_\fon(\NN^n)}(U)$.
	
	If $f\in X$, then $X = \left[\{0,g\}+\sum_{i\in I_X} \{0,e_i\} \right]\cup\{f\}$ (and $Y = \{0,e_n\}$ per our considerations in \ref{form 3'}).
	By Lemma \ref{lem:large-atom-two-fac}, $X$ is an atom, producing the factorization $X*\{0,e_n\}\in \Z_{\P_\fon(\NN^n)}(U)$ and completing the proof.
\end{proof}


\begin{rk}
	In the same vein as Example \ref{eg:recover-flat-unique-fac}, one may use Theorem \ref{thm:2n-length-set} to recover some cases of \cite[Proposition 4.8]{fan-tringali18}.
\end{rk}


\section{A New Family of Length Sets} \label{sec:new length sets}
Our work thus far culminates in realizing a new family of sets, parameterized by two integers $m$ and $n$, as sets of lengths for elements of $\P_\fon(\NN^d)$ (and consequently for elements of $\PN$ by Theorem \ref{thm:passage-to-Nd}).
This builds toward Conjecture \ref{conj:lengths}; but before explicitly showing how to construct these elements, we extract a more general result that lies at the heart of what makes the construction work. 

\begin{lemma} \label{lem:unique longest factorization}
	Let $U\in \P_\fon(\NN^d)$ be an element whose two longest factorizations have lengths $M$ and $N$, with $M < N$.
	Further assume that $U$ has a \textit{unique} longest factorization (of length $N$).
	Suppose $m\ge1$ and that $V_1,\dots,V_m\subseteq \NN^d$ are atoms such that $U,V_1,\dots, V_m$ are totally $\ZZ$-independent.
	Then $\mathsf{L}(U+V_1+\cdots+V_m) \cap [ M+m+1,\infty ] = \{N+m\}$.
\end{lemma}

\setcounter{claim}{0}
\begin{proof}
	For convenience, let $V := V_1 + \cdots + V_m$.
	Suppose that $k > M + m$ and that there are atoms $A_1,\dots,A_k$ with $U+V = A_1 + \cdots + A_k$.
	By Proposition \ref{prop:indep-decomp}(iv), we know that $k \le N+m$.
	
	By Proposition \ref{prop:indep-decomp}(iii), we can say (renumbering if necessary)
	\[ [ 1,s ] =  \{ i: U\cap A_i \neq\{0\}\} \quad \textrm{and} \quad [ t,k ] = \{i: V\cap A_i \neq \{0\}\}. \]
	Since we know that $[ 1,k ] = [ 1,s ] \cup [ t,k ]$, we know that $t \le s+1$.
	The arguments to follow hinge on whether these two intervals overlap.  
	First suppose that the intervals overlap; i.e., that $t \le s$.
	We will show that this cannot happen by showing that, in this case, $A_s$ is not an atom.
	
	Let $J = \{ j\in[1,m]: V_j \subseteq A_s \}$ and set $V' = \sum_{j\in J} V_j$; we know by Lemma \ref{lem:indep-atom-decomp} that $V' = V \cap A_s$.
	Also let $K = [ 1,m ] \setminus J$ and $V'' = \sum_{j\in K} V_j$.
	
	%%%%%%
	% CLAIM A
	\begin{claim} \label{cl:relevant part of V wrt to As}
	$V' = V\cap A_s$ and $V'' \cap A_s = \{0\}$. \label{cla}
	\end{claim}

	This follows directly from Lemma \ref{lem:indep-atom-decomp}(ii), (iii).
	
	%%%%%%
	% CLAIM B
	\begin{claim} \label{cl:atoms inside factors}
	$A_i \subseteq U$ for $i<t$ and $A_i \subseteq V$ for $i > s$. \label{clb}
	\end{claim}
	
	Proposition \ref{prop:indep-decomp}(ii) implies both statements since $V \cap A_i = \{0\}$ for $i<t$ (and $U\cap A_i = \{0\}$ for $i>s$).
	
	%%%%%%
	% CLAIM C
	\begin{claim} \label{cl:translates of U}
	For all $v\in V'$, $U+v = \sum\limits_{i<s} U\cap A_i + (U+v)\cap A_s$. \label{clc}
	\end{claim}

	
	We will show both inclusions.
	First suppose $u\in U$. 
	Then $u+v \in \sum_{i=1}^k A_i$, and we can find $u_1,\dots, u_s\in U$ and $v_t,\dots, v_k\in V$ so that (by Claim \ref{cl:atoms inside factors})
	$u_i\in A_i$ if $i < t$, $u_i + v_i \in A_i$ if $t\le i \le s$, and $v_i \in A_i$ if $i > s$.
	Then we will have
	\[u+v = \sum_{i<t} u_i + \sum_{i=t}^{s} (u_i+v_i) + \sum_{i > s} v_i, \]
	whence the $\ZZ$-independence of $U,V_1,\dots,V_m$ implies that $u = \sum_{i\le s} u_i$, $v_s = v$, and $v_i = 0$ for all $i\neq s$.
	Now $u+v = \sum_{i<s} u_i + (u_s+v)\in \sum_{i<s} U\cap A_i + (U+v)\cap A_s$.
	
	For the other inclusion, let $u_1,\dots, u_s\in U$ with $u_i\in A_i$ for all $i<s$ and $u_s + v\in A_s$.
	Then $\sum_{i\le s} u_i +v \in \sum_{i\le s} A_i \subseteq U+V$, so we can find $u'\in U$ and $v'\in V$ with 
	\[\sum_{i\le s}u_i + v = u' + v',\]
	at which point we can use $\ZZ$-independence again to see that $v' = v$, so that $\sum_{i\le s} u_i + v\in U+v$.
	
	%%%%%%
	% CLAIM D
	\begin{claim} \label{cl:many factors}
	We have $s > M$. 
	\end{claim}
	
	
	Suppose instead that $s \le M$.
	Then $U = \sum_{i\le s} U\cap A_i$ has $s\le m$ summands and $V = \sum_{i\ge t} V\cap A_i$ has $|[t,k]| \le m$ summands (since $V$ factors uniquely as the product of $m$ atoms).
	Consequently, $k = |[1,s]\cup[t,k]| \le |[1,s]| + |[t,k]| \le M +m$, contradicting the assumption that $ k > M +m$.
	
	%%%%%%
	%CLAIM E
	\begin{claim} \label{cl:translated intersection}
	For all $v\in V'$, $(U+v)\cap A_s = U\cap A_s + v$. \label{cld}
	\end{claim}
	
	We can write $(U+v)\cap A_s = A + v$ for some $A \subseteq U$.
	Now $U+v = \sum_{i<s} U\cap A_i + (U+v)\cap A_s = \sum_{i<s} U\cap A_i + A + v$.
	We can cancel $v$ from both sides of this set equality (since $v$ is a unit in $\P_\fon(\ZZ^n)$), yielding
	\[ U = \sum_{i<s} U\cap A_i + A. \tag*{({\small DEC1})} \label{dec1}\]
	On the other hand, Claim \ref{cl:translates of U} (with $v = 0$) gives us the decomposition
	\[ U = \sum_{i<s} U\cap A_i + U\cap A_s. \tag*{({\small DEC2})} \label{dec2}\]
	We will now show that we can cancel the common factors that appear in these two decompositions.
	By Claim \ref{cl:many factors}, $s>M$, so both decompositions \ref{dec1} and \ref{dec2} involve more than $M$ atoms.
	However, $U$ has only one factorization with more than $M$ atoms; call it $\bb = B_1*\cdots*B_N\in \Z(U)$.
	
	Then the atoms which appear in both decompositions \ref{dec1} and \ref{dec2} of $U$ must be some reorderings of the $B_i$.
	Renumbering if needed, there is some $h$ for which $\sum_{i<s} U\cap A_i = B_1 + \cdots + B_h$.
	By the uniqueness of the atoms $B_i$, it must be that $B_1 +\cdots + B_h$ can be cancelled in the decompositions \ref{dec1} and \ref{dec2}, leaving
	\[ A = B_{h+1} +\cdots+ B_{N} = U\cap A_s, \]
	and we have proved the claim.
	
	%%%%%%
	% CLAIM F
	\begin{claim} \label{cl:orth-decomp of As}
	$A_s$ is not an atom. \label{clf}
	\end{claim}
	
	To see this, we compute
	\begin{align*}
	A_s = (U+V)\cap A_s 
	&= (U+V'+V'') \cap A_s \\
	&= (U+V') \cap A_s \tag{by Claim \ref{cl:relevant part of V wrt to As} and Proposition \ref{prop:indep-decomp}} \\
	&= \bigcup_{v\in V'} (U+v)\cap A_s \\
	&= \bigcup_{v\in V'} (U\cap A_s + v) \tag{by Claim \ref{cl:translated intersection}} \\
	&= U\cap A_s + V'.
	\end{align*}
	Since $U\cap A_s$ and $V' = V\cap A_s$ are both nonzero, $A_s$ is not an atom.
	This is a contradiction which followed from our assumption that some of the $A_i$ may intersect nontrivially with \textit{both} $U$ and $V$.
	
	Now suppose this does not occur; necessarily, $s < t$ and we in fact have that $t = s+1$ by Proposition \ref{prop:indep-decomp}(iii).
	For $i \le s$, since $V\cap A_i  = \{0\}$, Proposition \ref{prop:indep-decomp}(ii) implies that $A_i = (U+V)\cap A_i = U\cap A_i \subseteq U$.
	Then we have, by Proposition \ref{prop:indep-decomp}(i), that $U = \sum_{i\le s} U\cap A_i = \sum_{i\le s} A_i$.
	This means that $s\in \mathsf{L}(U)$ and, by identical reasoning for $V$, that $| [ t,k ]| = m$.
	We conclude that $k \in \mathsf{L}(U) + m$ and, due to the assumption that $k>M+m$, it must be the case that $k = N + m$.
\end{proof}


\begin{thm} \label{thm:int-point-construction}
	Fix $n\ge 2$, $m\ge 1$, and $d\ge m+n$.
	Let $U_{n+1}$ be as in Definition \ref{def:two-fac-construction} so that, in particular, $U_{n+1}$ has exactly two factorizations, of lengths $2$ and $n+1$, respectively.  
	Suppose $V_1,\dots, V_m \subseteq \NN^d$ are atoms such that $U_{n+1},V_1,\dots, V_m$ are totally $\ZZ$-independent.
	Then $\mathsf{L}(U_{n+1}+V_1+\cdots+V_m) = [ 2,m+2 ] \cup \{m+n+1\}$.
\end{thm}

\begin{proof}
	For convenience, let $U := U_{n+1}$ and $V := V_1 + \cdots + V_m$.
	We will start by verifying the values that most clearly belong to $\mathsf{L}(U+V)$.
	It is easiest to see that $m+n+1 =\max\mathsf{L}(V)+\max\mathsf{L}(U) \in \mathsf{L}(U+V)$.
	For the rest, suppose $0\le h \le m$.
	Then, by Lemma \ref{lem:large-atom-two-fac}, 
	\[B_h := \left( \sum_{i=1}^{n-1} \{0,e_i\} + \{0,g\} + \sum_{j\in [ h+1,m ]} V_j \right) \cup \{f\} \]
	is an atom.
	From here, it is straightforward to check that
	\[ U+ V = \{0,e_n\} + B_h + V_1 + \cdots + V_h \]
	so $h+2 \in \mathsf{L}(U+V)$.
	As we allow $h$ to range over $[ 0,m ]$, we get that $[ 2,m+2 ] \in \mathsf{L}(U+V)$.
	
	For the other inclusion, we need to show that no other values are included in $\mathsf{L}(U+V)$.
	To do this, we note that $U$ has a unique longest factorization by Theorem \ref{thm:2n-length-set} and hence, using Lemma \ref{lem:unique longest factorization}, $\mathsf{L}(U+V) \cap [ m+3, m+n+1 ] = \{m+n+1\}$.
\end{proof}

\begin{cor}
	For every $m\ge 1$ and $n\ge 2$, there is an element $W\in \PN$ with $\mathsf{L}_\PN(W) = [2,m+2]\cup\{m+n+1\}$.
\end{cor}

\begin{proof}
	One simply needs to apply Theorems \ref{thm:int-point-construction} and \ref{thm:passage-to-Nd} to see that $[2,m+2]\cup\{m+n+1\}\in \mathcal{L}(\P_\fon(\NN^d)) = \mathcal{L}(\PN)$.
\end{proof}

There is certainly room to progress further toward Conjecture \ref{conj:lengths}.
For instance, using Lemma \ref{lem:unique longest factorization}, which was the workhorse of proving Theorem \ref{thm:int-point-construction}, relied largely on constructing a set which had factorizations of different lengths \textit{and} a unique longest factorization.
The only such construction is that of Fan and Tringali's from \cite[Proposition 4.10]{fan-tringali18}, or its $\NN^d$ counterpart from Definitions \ref{def:two-fac-construction}.
It would therefore be of some interest to characterize the subsets of $\NN$ which have a unique longest factorization into irreducibles.  
Predicting a best path toward Conjecture \ref{conj:lengths} is difficult, but it is likely that most diretions of further research into power monoids have potential to be revelatory. 
